import{r as T,a as bi,R as Xe}from"./vendor-react-DghaKJPf.js";import{s as to,r as Ni}from"./vendor-capacitor-Zyh0OhOh.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var no={exports:{}},vt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wi=T,Si=Symbol.for("react.element"),Ci=Symbol.for("react.fragment"),Ei=Object.prototype.hasOwnProperty,Ti=wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_i={key:!0,ref:!0,__self:!0,__source:!0};function so(t,e,n){var s,i={},a=null,c=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(c=e.ref);for(s in e)Ei.call(e,s)&&!_i.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:Si,type:t,key:a,ref:c,props:i,_owner:Ti.current}}vt.Fragment=Ci;vt.jsx=so;vt.jsxs=so;no.exports=vt;var o=no.exports,oo,hn=bi;oo=hn.createRoot,hn.hydrateRoot;var K=(t=>(t.GOOD="Good",t.BAD="Bad",t.ATTENTION="Needs Attention",t.NIL="Nil",t))(K||{});const gn={truckNo:"",trailerNo:"",inspectedBy:"",driverName:"",location:"",odometer:"",jobCard:"",timestamp:"",rate:0,remarks:"",inspectorSignature:"",driverSignature:"",photoFront:"",photoLS:"",photoRS:"",photoBack:"",photoDamage:""},tt=[{id:"details",title:"Details",label:"Details"},{id:"photos",title:"Photos",label:"Photos"},{id:"checklist_1",title:"Checklist 1",label:"Part 1"},{id:"checklist_2",title:"Checklist 2",label:"Part 2"},{id:"checklist_3",title:"Checklist 3",label:"Part 3"},{id:"signatures",title:"Signatures",label:"Signatures"},{id:"summary",title:"Summary",label:"Summary"}],O={PPE:"PPE & Safety Gear",DOCUMENTATION:"Documentation & Legal",VEHICLE_EXTERIOR:"Vehicle Exterior & Cab",LIGHTS_ELECTRICAL:"Lights & Electrical",MECHANICAL:"Mechanical & Safety Equipment",TRAILER:"Trailer Specifics"},Be=[{id:"reflectiveWorkSuit",label:"Reflective Work Suit",category:O.PPE},{id:"safetyGear",label:"Safety Goggles, Boots, Gloves, Hard Hat",category:O.PPE},{id:"dustMask",label:"Dust Mask (Task Application)",category:O.PPE},{id:"roadFitness",label:"Valid Road Fitness / Road Tax / Insurance",category:O.DOCUMENTATION},{id:"validDriverDocs",label:"Valid Driver’s License, DDT Certificate, Driver ID",category:O.DOCUMENTATION},{id:"driverManual",label:"Driver Manual",category:O.DOCUMENTATION},{id:"routeRisk",label:"Route Risk Assessment",category:O.DOCUMENTATION},{id:"windscreen",label:"Windscreen Condition",category:O.VEHICLE_EXTERIOR},{id:"mirrors",label:"Mirrors Condition",category:O.VEHICLE_EXTERIOR},{id:"chevrons",label:"Chevrons, Plate/Reflective Tape",category:O.VEHICLE_EXTERIOR},{id:"generalCondition",label:"General Condition (Interior Cab, Body: Signs of Tear & Wear, Dents)",category:O.VEHICLE_EXTERIOR},{id:"seatBelt",label:"Three-Point Retractable Seat Belt",category:O.VEHICLE_EXTERIOR},{id:"headLamps",label:"Head Lamps Condition",category:O.LIGHTS_ELECTRICAL},{id:"indicators",label:"Indicators Condition",category:O.LIGHTS_ELECTRICAL},{id:"parkingLights",label:"Parking Lights Condition",category:O.LIGHTS_ELECTRICAL},{id:"reverseAlarm",label:"Reverse Alarm, Reverse Lights Condition",category:O.LIGHTS_ELECTRICAL},{id:"hornIgnition",label:"Horn, Ignition & Electrical (Doors/Windows)",category:O.LIGHTS_ELECTRICAL},{id:"brakes",label:"Brakes, Brake Lights, Trailer Lights, Brake Air Pipes",category:O.MECHANICAL},{id:"tyres",label:"Tyres Condition (Not Worn Out, Pressure, Spare)",category:O.MECHANICAL},{id:"wheelNuts",label:"Wheel Nuts, Wheel Pointers",category:O.MECHANICAL},{id:"fluidLeaks",label:"No Leaks of Lubricants/Fluids (Oil, Coolant, etc.)",category:O.MECHANICAL},{id:"fireExtinguisher",label:"Recommended Fire Extinguisher (9Kg & 2.5Kg)",category:O.MECHANICAL},{id:"warningTriangles",label:"Warning Triangles, Two Approved Wheel Chocks",category:O.MECHANICAL},{id:"firstAid",label:"First Aid Kit",category:O.MECHANICAL},{id:"trailerCondition",label:"Trailer Condition",category:O.TRAILER},{id:"fifthWheel",label:"Fifth Wheel Condition",category:O.TRAILER},{id:"landingLegs",label:"Position and Condition of Landing Legs",category:O.TRAILER},{id:"tarpaulins",label:"Tarpaulins, Ropes, Belts or Straps",category:O.TRAILER}],L={TRUCK_EQUIPMENT:"Truck/Tractor and Equipment",TYRES:"Tyres and Horses",PPE_ID:"Drivers Protective Gear & ID",DOCUMENTS:"Documents",ONBOARD:"On Board Equipment"},yt=[{id:"petro_1",label:"1. OBC functionality: live",category:L.TRUCK_EQUIPMENT},{id:"petro_2",label:"2. Large exterior mirror for all around vision (incl. parabolic on passenger side)",category:L.TRUCK_EQUIPMENT},{id:"petro_3",label:"3. Single pane laminated windshields (no cracks)",category:L.TRUCK_EQUIPMENT},{id:"petro_4",label:"4. Ergonomically designed seats and head restraints",category:L.TRUCK_EQUIPMENT},{id:"petro_5",label:"5. 3 point seat belts on both seats",category:L.TRUCK_EQUIPMENT},{id:"petro_6",label:"6. Brake Testing required",category:L.TRUCK_EQUIPMENT},{id:"petro_7",label:"7. Functioning, master battery switch & engine cut – off switch on side of cab",category:L.TRUCK_EQUIPMENT},{id:"petro_8",label:"8. Stop Tail, Backing and Turn lights",category:L.TRUCK_EQUIPMENT},{id:"petro_9",label:"9. Cab mounted grab handle for ease of entry exit",category:L.TRUCK_EQUIPMENT},{id:"petro_10",label:"10. Jack, Mats, Wheel Spanner",category:L.TRUCK_EQUIPMENT},{id:"petro_11",label:"11. Cabin Jack",category:L.TRUCK_EQUIPMENT},{id:"petro_12",label:"12. P. window switches",category:L.TRUCK_EQUIPMENT},{id:"petro_13",label:"13. Condition of the fifth wheel (Lock/Lubricants)",category:L.TRUCK_EQUIPMENT},{id:"petro_14",label:"14. Each component outlets (faucet) numbered and marked with fill capacity",category:L.TRUCK_EQUIPMENT},{id:"petro_15",label:"15. 2 bronze grounding bolts compatible with loading rack (permissive) system",category:L.TRUCK_EQUIPMENT},{id:"petro_16",label:"16. Anti – slip walkway along the whole length of the tank",category:L.TRUCK_EQUIPMENT},{id:"petro_17",label:"17. Tank hatch and roll – over protection (coatings)",category:L.TRUCK_EQUIPMENT},{id:"petro_18",label:"18. Double latching lockable man lids, installed with hinges facing forward",category:L.TRUCK_EQUIPMENT},{id:"petro_19",label:"19. Trailer fitted with fall protection harness of handrails",category:L.TRUCK_EQUIPMENT},{id:"petro_20",label:"20. Ullage marks in correct places & sealed, also Doom Cover",category:L.TRUCK_EQUIPMENT},{id:"petro_21",label:"21. Presence of emergency/foot valves",category:L.TRUCK_EQUIPMENT},{id:"petro_22",label:"22. Emergence valves for all components",category:L.TRUCK_EQUIPMENT},{id:"petro_23",label:"23. Condition of landing legs",category:L.TRUCK_EQUIPMENT},{id:"petro_24",label:"24. Minimum tread depth set at the center for all wheel (incl. Spare tyre)",category:L.TYRES},{id:"petro_25",label:"25. Wheel nut indicators",category:L.TYRES},{id:"petro_26",label:"26. Mudguards for all wheels",category:L.TYRES},{id:"petro_27",label:"27. Choke blocks",category:L.TYRES},{id:"petro_28",label:"28. Hoses damaged/fittings? Continuity Test done?",category:L.TYRES},{id:"petro_29",label:"29. Delivery hose(s) for gravity drops",category:L.TYRES},{id:"petro_30",label:"30. Truck/trailer loaded within legal limits (axle weight)?",category:L.TYRES},{id:"petro_31",label:"31. Signs of lubrication loss on wheel",category:L.TYRES},{id:"petro_32",label:"32. Anti-static clothes/Work suite?",category:L.PPE_ID},{id:"petro_33",label:"33. Gloves for hydrocarbon handing Present?",category:L.PPE_ID},{id:"petro_34",label:"34. Safety shoes - hydrocarbon proof Present?",category:L.PPE_ID},{id:"petro_35",label:"35. Hard hat Present?",category:L.PPE_ID},{id:"petro_36",label:"36. Driver’s ID Present?",category:L.PPE_ID},{id:"petro_37",label:"37. Road worthiness approval by authorities",category:L.DOCUMENTS},{id:"petro_38",label:"38. Valid driver’s DDT certificate",category:L.DOCUMENTS},{id:"petro_39",label:"39. Valid driver’s License",category:L.DOCUMENTS},{id:"petro_40",label:"40. Electric certificate",category:L.DOCUMENTS},{id:"petro_41",label:"41. Drivers Manual",category:L.DOCUMENTS},{id:"petro_42",label:"42. Route Risk Assessment",category:L.DOCUMENTS},{id:"petro_43",label:"43. ZCSA certificate",category:L.DOCUMENTS},{id:"petro_44",label:"44. Assize Certificate",category:L.DOCUMENTS},{id:"petro_45",label:"45. TREM Card",category:L.DOCUMENTS},{id:"petro_46",label:"46. Fire extinguisher (2kg dry chemical) fixed & valid X 1",category:L.ONBOARD},{id:"petro_47",label:"47. Fire extinguisher (9kg dry chemical) within inspection X 2",category:L.ONBOARD},{id:"petro_48",label:"48. Barricading tape",category:L.ONBOARD},{id:"petro_49",label:"49. Charge Line",category:L.ONBOARD},{id:"petro_50",label:"50. Torch",category:L.ONBOARD},{id:"petro_51",label:"51. Spill Kit",category:L.ONBOARD},{id:"petro_52",label:"52. First aid kit 4 warning triangles and 3 cones",category:L.ONBOARD},{id:"petro_53",label:"53. On Board camera",category:L.ONBOARD},{id:"petro_54",label:"54. Safe Loading Pass/ Safe to operate/ Tech inspection",category:L.ONBOARD}],q={PPE:"A. Personal Protective Equipment",VEHICLE:"B. Vehicle (Horse & Trailer)",SPILL_KIT:"C. Spill Kit",DOCUMENTATION:"D. Documentation"},Ae=[{id:"acid_1",label:"1. Reflective Work Suit (Acid Proof), Gumboots Safety Goggles",category:q.PPE},{id:"acid_2",label:"2. Hard Hat, PVC Gloves, Respirator (Double side), Face shield",category:q.PPE},{id:"acid_3",label:"3. Valid road fitness/road tax/Insurance/permit",category:q.VEHICLE},{id:"acid_4",label:"4. Wind screen condition",category:q.VEHICLE},{id:"acid_5",label:"5. Mirrors in good condition",category:q.VEHICLE},{id:"acid_6",label:"6. Three-point retractable seat belt",category:q.VEHICLE},{id:"acid_7",label:"7. Horn working, ignition switch, electrical (doors/windows)",category:q.VEHICLE},{id:"acid_8",label:"8. Valid Fire extinguisher (9kg=2, 2kg=1)",category:q.VEHICLE},{id:"acid_9",label:"9. Warning triangles, Cones, two approved wheel chokes",category:q.VEHICLE},{id:"acid_10",label:"10. Headlamps working",category:q.VEHICLE},{id:"acid_11",label:"11. Amber beacon",category:q.VEHICLE},{id:"acid_12",label:"12. Brake lights, trailer lights, indicators working",category:q.VEHICLE},{id:"acid_13",label:"13. Brakes, air pipes, air bags OK",category:q.VEHICLE},{id:"acid_14",label:"14. Tyres not worn – out, visual Tyre Pressure, Spare wheel",category:q.VEHICLE},{id:"acid_15",label:"15. Wheel nuts, wheel pointers, bolts, Flanges OK",category:q.VEHICLE},{id:"acid_16",label:"16. Revers alarm, reverse lights working",category:q.VEHICLE},{id:"acid_17",label:"17. Chevrons plate/reflective tape",category:q.VEHICLE},{id:"acid_18",label:"18. Hazchem diamond symbols correct & display on both 2 sides",category:q.VEHICLE},{id:"acid_19",label:"19. Anti-slip protection, Ladder, Hand rails",category:q.VEHICLE},{id:"acid_20",label:"20. Over spill hose connected to containment container",category:q.VEHICLE},{id:"acid_21",label:"21. Hatch, Valves, Vents",category:q.VEHICLE},{id:"acid_22",label:"22. No leaks of chemicals/lubricants (oil, coolants, acid etc.)",category:q.VEHICLE},{id:"acid_23",label:"23. General condition (interior cab, body: signs of Corrosion, Cracks, leaks)",category:q.VEHICLE},{id:"acid_25",label:"25. Lime box filled with lime",category:q.SPILL_KIT},{id:"acid_26",label:"26. First Aid Kit, Diphotrine",category:q.SPILL_KIT},{id:"acid_27",label:"27. Pick and Shovel",category:q.SPILL_KIT},{id:"acid_28",label:"28. Barricading tape",category:q.SPILL_KIT},{id:"acid_29",label:"29. Water (20 liters container)",category:q.SPILL_KIT},{id:"acid_30",label:"30. Pressure/Thickness Test Certificate",category:q.DOCUMENTATION},{id:"acid_31",label:"31. Electric System Certificate",category:q.DOCUMENTATION},{id:"acid_32",label:"32. Tank Cleanliness Certificate",category:q.DOCUMENTATION},{id:"acid_33",label:"33. Driver Manual, Route Risk Assessment/Journey plan",category:q.DOCUMENTATION},{id:"acid_34",label:"34. Valid Driver licence, DDT certificate, ID",category:q.DOCUMENTATION}],D={PRIME_MOVER:"Prime Mover",TRAILER_TANKS:"Trailer/Tanks",DRIVER:"Driver",SAFETY_SIGNS:"Safety & Warning Signs",DOCUMENTS:"Licence & Mandatory Documents"},bt=[{id:"petro2_1",label:"1. General: Appearance, Paint, Leaks, Charge line",category:D.PRIME_MOVER},{id:"petro2_2",label:"2. Visibility: Windscreen, Windows, Wipers, Mirrors",category:D.PRIME_MOVER},{id:"petro2_3",label:"3. Lighting: Headlights, Beacon, Turning, Stop, Reverse Lights",category:D.PRIME_MOVER},{id:"petro2_4",label:"4. Provision for Orange Diamond",category:D.PRIME_MOVER},{id:"petro2_5",label:"5. Seat Belt: 3-point Contact, Retractable",category:D.PRIME_MOVER},{id:"petro2_6",label:"6. IVMS /Speed limiting device: installed, working",category:D.PRIME_MOVER},{id:"petro2_7",label:"7. Document Holder/Box : Position, Colour, Labeled",category:D.PRIME_MOVER},{id:"petro2_8",label:"8. Tools: Jack, Wheel Spanner, Cabin, Triangles (4), Cones (3)",category:D.PRIME_MOVER},{id:"petro2_9",label:"9. Equipment: Spill Kit, First Aid Kit, Barricading Tape, Fire Extinguisher (Cabin, Trailer x2)",category:D.PRIME_MOVER},{id:"petro2_10",label:"10. Electrical: Battery Master Switch, Battery Box, Terminals, Wiring",category:D.PRIME_MOVER},{id:"petro2_11",label:"11. Tyres: No Retread, Combination, Spray Suppression, Wheels",category:D.PRIME_MOVER},{id:"petro2_12",label:"12. Brake System: ABS, Wheel Pointers, Brake Testing Required?",category:D.PRIME_MOVER},{id:"petro2_13",label:"13. Shielding of Engine, Rear Window Non-opening",category:D.PRIME_MOVER},{id:"petro2_14",label:"14. Exhaust: Discharge on Right Side, Tank outlet 100mm Clearance",category:D.PRIME_MOVER},{id:"petro2_15",label:"15. Condition of the Fifth Wheel (Lock/Lubrication)",category:D.PRIME_MOVER},{id:"petro2_16",label:"16. Compartment Capacities: labeled, < 7000L per compartment",category:D.TRAILER_TANKS},{id:"petro2_17",label:"17. Under Run Protection: Sides, Rear End",category:D.TRAILER_TANKS},{id:"petro2_18",label:"18. Overturn Damage Protection",category:D.TRAILER_TANKS},{id:"petro2_19",label:"19. Valves: Discharge, Actuator, Dust Cups, Colour Coding",category:D.TRAILER_TANKS},{id:"petro2_20",label:"20. Emergency Shut Off: Main, Side(s)/ Brake Interlock System",category:D.TRAILER_TANKS},{id:"petro2_21",label:"21. Electrical Bonding: Cable, Bronze Earthing Studs",category:D.TRAILER_TANKS},{id:"petro2_22",label:"22. Spill Tray, Hose Storage Rack, Fire Extinguisher Holders",category:D.TRAILER_TANKS},{id:"petro2_23",label:"23. Tyres: Tread Depth, Spare Tyre, Non-retread, Combination",category:D.TRAILER_TANKS},{id:"petro2_24",label:"24. Mudguards for all Wheels, Spray Suppressors",category:D.TRAILER_TANKS},{id:"petro2_25",label:"25. Landing Legs",category:D.TRAILER_TANKS},{id:"petro2_26",label:"26. Reversing Alarm",category:D.TRAILER_TANKS},{id:"petro2_27",label:"27. Delivery Hose(s): State, Continuity, Colour Coded, Dust Cups",category:D.TRAILER_TANKS},{id:"petro2_28",label:"28. Lighting: Brakes, Reverse, Warning, Emergency Lighting",category:D.TRAILER_TANKS},{id:"petro2_29",label:"29. Rear Bumper: > 300mm Beyond Tank",category:D.TRAILER_TANKS},{id:"petro2_30",label:"30. Fall Protection: Access Ladder, Anti-slip Walkway, Handrail",category:D.TRAILER_TANKS},{id:"petro2_31",label:"31. Manholes: Dia, Center, Secured, Standard (EN 13317)",category:D.TRAILER_TANKS},{id:"petro2_32",label:"32. Fittings: Ullage Marks, Overfill Protection, Pressure Release",category:D.TRAILER_TANKS},{id:"petro2_33",label:"33. Work Suit: Anti-static, Reflective",category:D.DRIVER},{id:"petro2_34",label:"34. Safety Gloves: For Hydrocarbon Handing",category:D.DRIVER},{id:"petro2_35",label:"35. Safety Boot: With Toe Cap, Oil Resistant",category:D.DRIVER},{id:"petro2_36",label:"36. Safety Helmet: 2- 4-Point Chin Strap",category:D.DRIVER},{id:"petro2_37",label:"37. Driver’s ID: Identity Card, Driver Blue Tag",category:D.DRIVER},{id:"petro2_38",label:"38. Hazchem: Both Sides, Rear",category:D.SAFETY_SIGNS},{id:"petro2_39",label:"39. No Smocking, Naked Flame, Cell Phone",category:D.SAFETY_SIGNS},{id:"petro2_40",label:"40. Orange Reflectors: Continuous",category:D.SAFETY_SIGNS},{id:"petro2_41",label:"41. Chevron, Red Reflectors at Rear",category:D.SAFETY_SIGNS},{id:"petro2_42",label:"42. Number Plate: ZABS Approved, Lighting",category:D.SAFETY_SIGNS},{id:"petro2_43",label:"43. Speed Limit Sign: 80 km/h",category:D.SAFETY_SIGNS},{id:"petro2_44",label:"44. Data Plate: Pressure Test",category:D.SAFETY_SIGNS},{id:"petro2_45",label:"45. Road Tax, Certificate of Fitness, Insurance, Identity",category:D.DOCUMENTS},{id:"petro2_46",label:"46. Defensive Driver Training (DDT): Dangerous Goods Certificate",category:D.DOCUMENTS},{id:"petro2_47",label:"47. Driver’s License: Validity of Dangerous Goods, CE",category:D.DOCUMENTS},{id:"petro2_48",label:"48. Electric Certificate",category:D.DOCUMENTS},{id:"petro2_49",label:"49. Drivers Manual",category:D.DOCUMENTS},{id:"petro2_50",label:"50. Route Risk Assessment Guide",category:D.DOCUMENTS},{id:"petro2_51",label:"51. ZCSA Certificate",category:D.DOCUMENTS},{id:"petro2_52",label:"52. Assize Certificate",category:D.DOCUMENTS},{id:"petro2_53",label:"53. TREM Card",category:D.DOCUMENTS}],Nt=["id","timestamp","truckNo","trailerNo","inspectedBy","driverName","location","odometer","rate","remarks","inspectorSignature","driverSignature","photoFront","photoLS","photoRS","photoBack","photoDamage","jobCard"],io=[...Nt,...Be.map(t=>t.id)],ro=[...Nt,...yt.map(t=>t.id)],ao=[...Nt,...bt.map(t=>t.id)],lo=[...Nt,...Ae.map(t=>t.id)],Ii=`
function doPost(e) {
  const lock = LockService.getScriptLock();
  lock.tryLock(30000); 
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const body = e.postData ? JSON.parse(e.postData.contents) : {};
    return routeRequest(ss, body);
  } catch (err) {
    return ResponseBuilder.error(err.toString());
  } finally {
    lock.releaseLock();
  }
}

function doGet(e) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  return DataHandlers.handleGetRequest(ss);
}

function routeRequest(ss, body) {
  const action = body.action;
  const routes = {
    'login': () => AuthHandlers.handleLogin(ss, body),
    'register_user': () => AuthHandlers.handleRegisterUser(ss, body),
    'get_users': () => AuthHandlers.handleGetUsers(ss),
    'delete_user': () => AuthHandlers.handleDeleteUser(ss, body),
    'update_user': () => AuthHandlers.handleUpdateUser(ss, body),
    'manage_fleet': () => SystemHandlers.handleManageFleet(ss, body),
    'bulk_manage_fleet': () => SystemHandlers.handleBulkManageFleet(ss, body),
    'update_settings': () => SystemHandlers.handleUpdateSettings(ss, body)
  };
  if (!action || action === 'create' || !routes[action]) return DataHandlers.handleDataSubmission(ss, body);
  return routes[action]();
}`,Ai=`
const AuthHandlers = {
  handleLogin: function(ss, body) {
    let userSheet = ss.getSheetByName('Users');
    if (!userSheet) return ResponseBuilder.error("No users found.");
    const data = userSheet.getDataRange().getValues();
    const username = body.username.toLowerCase();
    for (let i = 1; i < data.length; i++) {
        if (data[i][0].toLowerCase() === username && data[i][1] === body.password) {
            return ResponseBuilder.success({ user: { username: data[i][0], name: data[i][2], role: data[i][3] } });
        }
    }
    return ResponseBuilder.error("Invalid credentials.");
  },
  handleRegisterUser: function(ss, body) {
    let sheet = ss.getSheetByName('Users') || ss.insertSheet('Users');
    sheet.appendRow([body.username.toLowerCase(), body.password, body.name, body.role, body.position, new Date().toISOString(), "{}", "TRUE"]);
    return ResponseBuilder.success();
  },
  handleGetUsers: function(ss) {
    let sheet = ss.getSheetByName('Users');
    if (!sheet) return ResponseBuilder.success({ users: [] });
    const data = sheet.getDataRange().getValues();
    const users = data.slice(1).map(r => ({ username: r[0], name: r[2], role: r[3], position: r[4], isActive: r[7] === "TRUE" }));
    return ResponseBuilder.success({ users });
  },
  handleDeleteUser: function(ss, body) {
    let sheet = ss.getSheetByName('Users');
    const data = sheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
      if (data[i][0].toLowerCase() === body.username.toLowerCase()) {
        sheet.deleteRow(i + 1);
        return ResponseBuilder.success();
      }
    }
    return ResponseBuilder.error("User not found");
  },
  handleUpdateUser: function(ss, body) {
    let sheet = ss.getSheetByName('Users');
    const data = sheet.getDataRange().getValues();
    for (let i = 1; i < data.length; i++) {
      if (data[i][0].toLowerCase() === (body.originalUsername || body.username).toLowerCase()) {
        if (body.username) sheet.getRange(i + 1, 1).setValue(body.username);
        if (body.password) sheet.getRange(i + 1, 2).setValue(body.password);
        if (body.name) sheet.getRange(i + 1, 3).setValue(body.name);
        if (body.role) sheet.getRange(i + 1, 4).setValue(body.role);
        if (body.position) sheet.getRange(i + 1, 5).setValue(body.position);
        if (body.isActive !== undefined) sheet.getRange(i + 1, 8).setValue(body.isActive ? "TRUE" : "FALSE");
        if (body.preferences) sheet.getRange(i + 1, 7).setValue(JSON.stringify(body.preferences));
        return ResponseBuilder.success();
      }
    }
    return ResponseBuilder.error("User not found");
  }
};`,ki=`
const DataHandlers = {
  handleDataSubmission: function(ss, body) {
    let sheet = ss.getSheetByName(body.sheet) || ss.insertSheet(body.sheet);
    if (sheet.getLastRow() === 0 && body.headers) sheet.appendRow(body.headers);
    sheet.appendRow(body.row);
    return ResponseBuilder.success();
  },
  handleGetRequest: function(ss) {
    const data = {};
    ss.getSheets().forEach(sheet => {
      const name = sheet.getName();
      const lastRow = sheet.getLastRow();
      if (lastRow === 0) { data[name] = []; return; }
      if (name === 'Validation_Data') {
         const values = sheet.getDataRange().getValues();
         const columns = {};
         if (values.length > 0) {
             const headers = values[0];
             headers.forEach((h, idx) => {
                 columns[h] = values.slice(1).map(r => r[idx]).filter(v => v !== "");
             });
         }
         data[name] = columns;
      } else {
         data[name] = sheet.getDataRange().getValues();
      }
    });
    return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
  }
};

const SystemHandlers = {
  handleManageFleet: function(ss, body) {
    let sheet = ss.getSheetByName('Validation_Data') || ss.insertSheet('Validation_Data');
    const lastRow = sheet.getLastRow();
    if (lastRow === 0) {
      sheet.appendRow(["Driver_Name","Inspector_Name","Location","Position","Misc1","Misc2","Misc3","Truck_Reg_No","Trailer_Reg_No"]);
      sheet.setFrozenRows(1);
    }
    
    const colIdx = body.type === 'truck' ? 8 : 9; 
    const range = sheet.getRange(1, colIdx, Math.max(1, sheet.getLastRow()), 1);
    const colValues = range.getValues().flat();
    const firstEmpty = colValues.indexOf("");
    const targetRow = firstEmpty === -1 ? sheet.getLastRow() + 1 : firstEmpty + 1;
    
    sheet.getRange(targetRow, colIdx).setValue(body.value);
    return ResponseBuilder.success({ message: "Asset added" });
  },

  handleBulkManageFleet: function(ss, body) {
    let sheet = ss.getSheetByName('Validation_Data') || ss.insertSheet('Validation_Data');
    const lastRow = sheet.getLastRow();
    if (lastRow === 0) {
      sheet.appendRow(["Driver_Name","Inspector_Name","Location","Position","Misc1","Misc2","Misc3","Truck_Reg_No","Trailer_Reg_No"]);
      sheet.setFrozenRows(1);
    }
    
    const trucks = body.trucks || [];
    const trailers = body.trailers || [];

    const getFirstEmptyInCol = (col) => {
        const vals = sheet.getRange(1, col, Math.max(1, sheet.getLastRow()), 1).getValues().flat();
        const idx = vals.indexOf("");
        return idx === -1 ? sheet.getLastRow() + 1 : idx + 1;
    };

    if (trucks.length > 0) {
        const startRow = getFirstEmptyInCol(8);
        sheet.getRange(startRow, 8, trucks.length, 1).setValues(trucks.map(t => [t]));
    }
    
    if (trailers.length > 0) {
        const startRow = getFirstEmptyInCol(9);
        sheet.getRange(startRow, 9, trailers.length, 1).setValues(trailers.map(t => [t]));
    }

    return ResponseBuilder.success({ message: "Bulk import complete" });
  },

  handleUpdateSettings: function(ss, body) {
    let sheet = ss.getSheetByName('System_Settings') || ss.insertSheet('System_Settings');
    const row = [
      body.companyName, 
      body.managerEmail, 
      new Date(), 
      "Admin", 
      body.companyLogo || "", 
      body.mobileApkLink || "", 
      body.webAppUrl || "", 
      body.maintenanceMode ? "TRUE" : "FALSE", 
      body.maintenanceMessage || ""
    ];
    if (sheet.getLastRow() < 2) sheet.appendRow(["A","B","C","D","E","F","G","H","I"]);
    sheet.getRange(2, 1, 1, row.length).setValues([row]);
    return ResponseBuilder.success();
  }
};`,Ri=`const ResponseBuilder = {
  success: function(data = {}) { return this.build({ status: "success", ...data }); },
  error: function(message) { return this.build({ status: "error", message: message }); },
  build: function(data) { return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON); }
};`,Mi={"1_Controller.gs":Ii,"2_Auth.gs":Ai,"3_Core.gs":ki,"5_Utils.gs":Ri};Object.values(Mi).join(`

`);const Pi="https://script.google.com/macros/s/AKfycbwZRcAVA4eauiexlSe81T-iHhq8tzrvbP7k11D7FT7Z-_Pg3eVCVBK3DXyTBAfGCe9-NQ/exec",Li=3e5,ji=30*60*1e3,xn=12*60*60*1e3,Di=()=>{const[t,e]=T.useState(null),[n,s]=T.useState(null),i=T.useRef(Date.now()),a=T.useRef(Date.now()),c=T.useRef(null);T.useEffect(()=>{const g=localStorage.getItem("safetyCheck_user"),x=localStorage.getItem("safetyCheck_session_start");if(g)try{if(x){if(Date.now()-parseInt(x)>xn){h("max_duration");return}a.current=parseInt(x)}else localStorage.setItem("safetyCheck_session_start",Date.now().toString());const y=JSON.parse(g),v=y.role?String(y.role).trim().toLowerCase():"";v==="admin"?y.role="Admin":v==="operations"?y.role="Operations":v==="maintenance"?y.role="Maintenance":v==="secretary"?y.role="Secretary":v==="other"?y.role="Other":v==="superadmin"?y.role="SuperAdmin":y.role="Inspector",y.needsSetup=!y.name||y.needsSetup===!0,e(y),p()}catch{h()}},[]);const d=T.useCallback(()=>{if(!t)return;const g=Date.now();g-i.current>1e3&&(i.current=g,localStorage.setItem("safetyCheck_last_activity",g.toString()))},[t]),p=()=>{window.addEventListener("mousemove",d),window.addEventListener("keydown",d),window.addEventListener("touchstart",d),window.addEventListener("click",d),c.current&&window.clearInterval(c.current),c.current=window.setInterval(f,6e4)},u=()=>{window.removeEventListener("mousemove",d),window.removeEventListener("keydown",d),window.removeEventListener("touchstart",d),window.removeEventListener("click",d),c.current&&(window.clearInterval(c.current),c.current=null)},f=()=>{const g=Date.now();if(g-i.current>ji){h("idle");return}if(g-a.current>xn){h("max_duration");return}},m=g=>{const x=Date.now(),y={...g,needsSetup:!g.name||g.needsSetup===!0};e(y),localStorage.setItem("safetyCheck_user",JSON.stringify(y)),localStorage.setItem("safetyCheck_session_start",x.toString()),localStorage.setItem("safetyCheck_last_activity",x.toString()),a.current=x,i.current=x,s(null),p()},h=g=>{u(),e(null),g&&s(g),["safetyCheck_user","safetyCheck_session_start","safetyCheck_last_activity","sc_validation_lists"].forEach(y=>localStorage.removeItem(y))};return{currentUser:t,setCurrentUser:e,handleLogin:m,handleLogout:h,sessionExpired:n,setSessionExpired:s}},Ui=()=>{const[t,e]=T.useState(()=>{const f=Pi;return f.length>0?f:typeof window<"u"&&localStorage.getItem("safetyCheck_scriptUrl")||""}),[n,s]=T.useState(()=>{if(typeof window<"u"){const f=localStorage.getItem("safetyCheck_settings");if(f)try{return JSON.parse(f)}catch(m){console.error("Failed to parse local settings",m)}}return{companyName:"SafetyCheck Pro",managerEmail:""}}),[i,a]=T.useState(!1),c=T.useRef(!1),d=T.useRef(!1);T.useEffect(()=>{if(t&&t.startsWith("https://script.google.com")){p(t);const f=setInterval(()=>{d.current||p(t)},3e4);return()=>clearInterval(f)}},[t]);const p=async(f,m=!1)=>{if(!(!f||!f.startsWith("https://script.google.com"))&&!(!navigator.onLine||c.current&&!m)){c.current=!0;try{const h=`t=${new Date().getTime()}`,g=`${f}${f.includes("?")?"&":"?"}${h}`,x=await fetch(g,{method:"GET",mode:"cors",cache:"no-store"});if(!x.ok)return;const v=(await x.json()).System_Settings;if(v&&Array.isArray(v)&&v.length>1){const b=v[1];if(b&&b.length>=8){const N=String(b[7]).toUpperCase().trim()==="TRUE",A={companyName:b[0]||"SafetyCheck Pro",managerEmail:b[1]||"",companyLogo:b[4]&&String(b[4]).length>100?b[4]:void 0,mobileApkLink:b[5]||"",webAppUrl:b[6]||"",maintenanceMode:N,maintenanceMessage:b[8]||"System under scheduled maintenance."};s(_=>JSON.stringify(_)!==JSON.stringify(A)?(localStorage.setItem("safetyCheck_settings",JSON.stringify(A)),A):_)}}}catch{}finally{c.current=!1}}};return{settings:n,setSettings:s,appScriptUrl:t,setAppScriptUrl:e,isSavingSettings:i,handleSaveSettings:async()=>{a(!0),d.current=!0;try{localStorage.setItem("safetyCheck_settings",JSON.stringify(n)),localStorage.setItem("safetyCheck_scriptUrl",t),t&&t.startsWith("https")&&navigator.onLine&&await fetch(t,{method:"POST",body:JSON.stringify({action:"update_settings",...n}),mode:"no-cors"})}catch(f){console.error("Save Settings Failed",f)}finally{setTimeout(()=>{a(!1),d.current=!1},800)}},fetchSystemSettings:p}},Fi=50,Vi=6e4,Gi=24*60*60*1e3,Hi=(t,e,n)=>{const[s,i]=T.useState([]),[a,c]=T.useState([]),[d,p]=T.useState([]),[u,f]=T.useState([]),m=T.useRef([]),h=T.useRef([]),g=T.useRef([]),x=T.useRef(null);T.useEffect(()=>{m.current=d},[d]),T.useEffect(()=>{h.current=a},[a]),T.useEffect(()=>{g.current=u},[u]),T.useEffect(()=>{if(!e){x.current&&window.clearInterval(x.current);return}const _=e.username.replace(/[^a-z0-9]/gi,"_")+"_",w=localStorage.getItem(`sc_read_notifications_${_}`),C=localStorage.getItem(`sc_dismissed_notifications_${_}`),k=localStorage.getItem(`sc_pop_history_${_}`),E=w?JSON.parse(w):[],S=C?JSON.parse(C):[],R=k?JSON.parse(k):[];return c(E),p(S),f(R),v(),x.current=window.setInterval(v,Vi),()=>{x.current&&window.clearInterval(x.current)}},[e,t]);const y=(_,w)=>{if(!e)return;const C=e.username.replace(/[^a-z0-9]/gi,"_")+"_",k=_==="read"?`sc_read_notifications_${C}`:_==="dismissed"?`sc_dismissed_notifications_${C}`:`sc_pop_history_${C}`;localStorage.setItem(k,JSON.stringify(w)),_==="read"?c(w):_==="dismissed"?p(w):_==="notified"&&f(w)},v=async()=>{if(!(!t||!navigator.onLine||!e))try{const _=await fetch(`${t}?t=${Date.now()}`);if(!_.ok)return;const w=await _.text();if(!w||w.trim().startsWith("<"))return;const C=JSON.parse(w),k=(C.Acknowledgements||[]).map(V=>String(V)),E=Date.now();let S=[];const R=V=>m.current.includes(V)||k.includes(V),U=V=>h.current.includes(V),M=(V,W)=>{if(!Array.isArray(V)||V.length<=1)return[];const B=W==="General"?8:9,se=2;return V.slice(Math.max(1,V.length-50)).map(Q=>{const fe=String(Q[1]),ve=Date.parse(fe),ae=String(Q[se]||"UNIT").trim().toUpperCase(),Re=Number(Q[B]),Je=`V_${W}_${ve}_${ae}`.replace(/\s+/g,"");return R(Je)||isNaN(ve)||E-ve>Gi?null:Re<=3?{id:Je,title:Re<=2?`CRITICAL: ${ae}`:`WARNING: ${ae}`,message:`${W} Audit: Rated ${Re}/5`,type:Re<=2?"critical":"warning",timestamp:fe,read:U(Je),module:W}:null}).filter(Q=>Q!==null)};["General","Petroleum","Petroleum_V2","Acid"].forEach(V=>{C[V]&&(S=[...S,...M(C[V],V)])});const G=C.SystemNotification||[];if(Array.isArray(G)&&G.length>1){const V=e.username.toLowerCase().trim(),W=e.role.toLowerCase().trim();G.forEach(B=>{const se=String(B[0]),Q=String(B[1]).trim().toLowerCase(),fe=String(B[5]).toUpperCase()==="TRUE";R(se)||fe||(Q===V||Q===W||Q==="all")&&S.push({id:se,title:"SYSTEM ALERT",message:String(B[3]),type:String(B[2]).toLowerCase()||"info",timestamp:B[4],read:U(se),actionLink:B[6],isServerEvent:!0})})}S.sort((V,W)=>new Date(W.timestamp).getTime()-new Date(V.timestamp).getTime());const z=S.slice(0,Fi),F=z.filter(V=>!g.current.includes(V.id)&&!V.read&&!m.current.includes(V.id));if(F.length>0){const V=F[0];n(V.message,V.type==="critical"?"error":"info");const W=[...new Set([...g.current,...F.map(B=>B.id)])];y("notified",W)}i(z)}catch{console.warn("Notification sync delayed.")}},b=async(_,w)=>{i(k=>k.map(E=>E.id===_?{...E,read:!0}:E)),y("read",[...new Set([...h.current,_])]);const C=s.find(k=>k.id===_);C?.actionLink&&w&&w(C.actionLink)},I=_=>{i(w=>w.filter(C=>C.id!==_)),y("dismissed",[...new Set([...m.current,_])]),y("notified",[...new Set([...g.current,_])])};return{notifications:s,handleMarkNotificationRead:b,handleDismissNotification:I,handleClearAllNotifications:()=>{const _=s.map(w=>w.id);y("dismissed",[...new Set([...m.current,..._])]),y("notified",[...new Set([...g.current,..._])]),i([])},handleGlobalAcknowledge:async _=>{if(!(!t||!e)){I(_);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"acknowledge_notification",notificationId:_,user:e.username}),mode:"no-cors"}),n("Global acknowledgement synced.","success")}catch{console.warn("Server acknowledgement failed, kept in local dismissal list.")}}},fetchNotifications:v}},Bi=15e3,qi=(t,e,n)=>{const[s,i]=T.useState([]),[a,c]=T.useState(!1),[d,p]=T.useState(!1),u=T.useRef(0),[f,m]=T.useState({trucks:[],trailers:[],drivers:[],inspectors:[],locations:[],positions:[]});T.useEffect(()=>{t&&n&&h(!1)},[e,t,n?.username]);const h=async(x=!1)=>{if(!t||typeof t!="string"||!t.startsWith("http"))return;const y=x===!0,v=Date.now(),I=`sc_history_${n?`${n.username}_`:"anon_"}${e}`,N=localStorage.getItem(I);let A=!1;if(N&&!y)try{const _=JSON.parse(N);if(_.data&&Array.isArray(_.data)){i(_.data),A=!0;const w=localStorage.getItem("sc_validation_lists");if(w&&m(JSON.parse(w)),v-_.timestamp<Li){c(!1);return}}}catch(_){console.error("Cache parsing error",_)}if(y&&v-u.current<Bi){console.debug("Fetch throttled to protect server.");return}if(A?p(!0):c(!0),!navigator.onLine){c(!1),p(!1);return}try{u.current=v;const _=await fetch(`${t}?t=${v}`);if(!_.ok)throw new Error("Network response was not ok");const w=await _.text();if(!w||w.trim().startsWith("<"))throw new Error("Invalid response format");const C=JSON.parse(w),k=C.Validation_Data;if(k){const M={trucks:k.Truck_Reg_No||[],trailers:k.Trailer_Reg_No||[],drivers:k.Driver_Name||[],inspectors:k.Inspector_Name||[],locations:k.Location||[],positions:k.Position||[]};m(M),localStorage.setItem("sc_validation_lists",JSON.stringify(M))}let E="General",S=io;e==="petroleum"?(E="Petroleum",S=ro):e==="petroleum_v2"?(E="Petroleum_V2",S=ao):e==="acid"&&(E="Acid",S=lo);const R=C[E];let U=[];R!==void 0&&Array.isArray(R)&&R.length>1&&(U=R.slice(1).map(M=>{const G={};return S.forEach((z,F)=>{G[z]=M[F]!==void 0?M[F]:null}),G}).reverse()),i(U),localStorage.setItem(I,JSON.stringify({timestamp:Date.now(),data:U}))}catch{}finally{c(!1),p(!1)}},g=T.useMemo(()=>{if(!s.length)return{total:0,avgRate:0,passRate:0};const x=s.length,v=(s.filter(b=>Number(b.rate)>=4).length/x*100).toFixed(0);return{total:x,avgRate:0,passRate:v}},[s]);return{historyList:s,isLoadingHistory:a,isBackgroundFetching:d,validationLists:f,stats:g,fetchHistory:h}},Oi=(t,e,n)=>{const[s,i]=T.useState("idle"),[a,c]=T.useState([]),[d,p]=T.useState(!1),[u,f]=T.useState(!1);T.useEffect(()=>{const g=localStorage.getItem("safetycheck_offline_queue");if(g)try{c(JSON.parse(g))}catch{}const x=()=>{f(!1),e("Connection restored. Attempting background sync...","info"),m()},y=()=>{f(!1)};return window.addEventListener("online",x),window.addEventListener("offline",y),()=>{window.removeEventListener("online",x),window.removeEventListener("offline",y)}},[]);const m=async()=>{if(d)return;const g=JSON.parse(localStorage.getItem("safetycheck_offline_queue")||"[]");if(g.length===0)return;p(!0),f(!1);let x=0,y=[...g];y.length;try{for(;y.length>0;){const v=y[0];try{const b=new AbortController,I=setTimeout(()=>b.abort(),15e3),N=await fetch(t,{method:"POST",body:JSON.stringify(v),mode:"no-cors",headers:{"Content-Type":"text/plain"},signal:b.signal});clearTimeout(I),y.shift(),x++,c([...y]),localStorage.setItem("safetycheck_offline_queue",JSON.stringify(y)),await new Promise(A=>setTimeout(A,1e3))}catch(b){if(console.error("Sync failed for item",b),b.name==="AbortError"||b.message.includes("NetworkError")||b.message.includes("Failed to fetch")){f(!0);break}break}}}finally{p(!1),x>0?y.length===0?(e(`All ${x} offline records synced successfully!`,"success"),n()):e(`Synced ${x} items. ${y.length} remaining.`,"info"):u&&g.length>0}};return{submissionStatus:s,setSubmissionStatus:i,offlineQueue:a,isSyncing:d,isPoorConnection:u,syncOfflineQueue:m,addToQueue:g=>{const x=[...a,g];c(x),localStorage.setItem("safetycheck_offline_queue",JSON.stringify(x))}}},$i=(t,e)=>{const[n,s]=T.useState(null),[i,a]=T.useState([]),[c,d]=T.useState(!1),p=async()=>{if(!(!t||typeof t!="string"||!t.startsWith("http"))&&e){d(!0);try{const u=await fetch(`${t}?t=${new Date().getTime()}`);if(!u.ok)return;const f=await u.json();if(f.Subscription_Data){const m=f.Subscription_Data,h=m.current||m,g=m.history||[],x=String(h.expiryDate||"").trim();if(!x||x==="undefined"||x==="null"||x===""){s({status:"Expired",plan:"None",expiryDate:"",daysRemaining:0}),a(g);return}const y=x.split("T")[0],v=y.split("-");let b;if(v.length===3?b=new Date(parseInt(v[0]),parseInt(v[1])-1,parseInt(v[2]),23,59,59):(b=new Date(x),b.setHours(23,59,59,999)),isNaN(b.getTime())){s({status:"Expired",plan:"None",expiryDate:"",daysRemaining:0});return}const I=new Date,N=b.getTime()-I.getTime(),A=Math.ceil(N/(1e3*60*60*24)),_=A<=0;s({status:_?"Expired":h.status||"Active",plan:h.plan||"Standard",expiryDate:y,daysRemaining:Math.max(0,A)}),a(g)}else s({status:"Expired",plan:"None",expiryDate:"",daysRemaining:0})}catch(u){console.error("Subscription fetch error:",u)}finally{d(!1)}}};return T.useEffect(()=>{p()},[t,e]),{subscription:n,history:i,isLoading:c,refreshSubscription:p}};var Ji={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Wi,zi;function Ki(){return{geminiUrl:Wi,vertexUrl:zi}}function Yi(t,e,n,s){var i,a;if(!t?.baseUrl){const c=Ki();return e?(i=c.vertexUrl)!==null&&i!==void 0?i:n:(a=c.geminiUrl)!==null&&a!==void 0?a:s}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ge{}function P(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(s,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const a=e[i];return a!=null?String(a):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function l(t,e,n){for(let a=0;a<e.length-1;a++){const c=e[a];if(c.endsWith("[]")){const d=c.slice(0,-2);if(!(d in t))if(Array.isArray(n))t[d]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(t[d])){const p=t[d];if(Array.isArray(n))for(let u=0;u<p.length;u++){const f=p[u];l(f,e.slice(a+1),n[u])}else for(const u of p)l(u,e.slice(a+1),n)}return}else if(c.endsWith("[0]")){const d=c.slice(0,-3);d in t||(t[d]=[{}]);const p=t[d];l(p[0],e.slice(a+1),n);return}(!t[c]||typeof t[c]!="object")&&(t[c]={}),t=t[c]}const s=e[e.length-1],i=t[s];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[s]=n}function r(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let s=0;s<e.length;s++){if(typeof t!="object"||t===null)return n;const i=e[s];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in t){const c=t[a];return Array.isArray(c)?c.map(d=>r(d,e.slice(s+1),n)):n}else return n}else t=t[i]}return t}catch(s){if(s instanceof TypeError)return n;throw s}}function Xi(t,e){for(const[n,s]of Object.entries(e)){const i=n.split("."),a=s.split("."),c=new Set;let d=-1;for(let p=0;p<i.length;p++)if(i[p]==="*"){d=p;break}if(d!==-1&&a.length>d)for(let p=d;p<a.length;p++){const u=a[p];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&c.add(u)}Vt(t,i,a,0,c)}}function Vt(t,e,n,s,i){if(s>=e.length||typeof t!="object"||t===null)return;const a=e[s];if(a.endsWith("[]")){const c=a.slice(0,-2),d=t;if(c in d&&Array.isArray(d[c]))for(const p of d[c])Vt(p,e,n,s+1,i)}else if(a==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const c=t,d=Object.keys(c).filter(u=>!u.startsWith("_")&&!i.has(u)),p={};for(const u of d)p[u]=c[u];for(const[u,f]of Object.entries(p)){const m=[];for(const h of n.slice(s))h==="*"?m.push(u):m.push(h);l(c,m,f)}for(const u of d)delete c[u]}}else{const c=t;a in c&&Vt(c[a],e,n,s+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zt(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qi(t){const e={},n=r(t,["operationName"]);n!=null&&l(e,["operationName"],n);const s=r(t,["resourceName"]);return s!=null&&l(e,["_url","resourceName"],s),e}function Zi(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response","generateVideoResponse"]);return c!=null&&l(e,["response"],tr(c)),e}function er(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response"]);return c!=null&&l(e,["response"],nr(c)),e}function tr(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>sr(c))),l(e,["generatedVideos"],a)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&l(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function nr(t){const e={},n=r(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>or(c))),l(e,["generatedVideos"],a)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&l(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function sr(t){const e={},n=r(t,["video"]);return n!=null&&l(e,["video"],dr(n)),e}function or(t){const e={},n=r(t,["_self"]);return n!=null&&l(e,["video"],ur(n)),e}function ir(t){const e={},n=r(t,["operationName"]);return n!=null&&l(e,["_url","operationName"],n),e}function rr(t){const e={},n=r(t,["operationName"]);return n!=null&&l(e,["_url","operationName"],n),e}function ar(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response"]);return c!=null&&l(e,["response"],lr(c)),e}function lr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["parent"]);s!=null&&l(e,["parent"],s);const i=r(t,["documentName"]);return i!=null&&l(e,["documentName"],i),e}function co(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response"]);return c!=null&&l(e,["response"],cr(c)),e}function cr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["parent"]);s!=null&&l(e,["parent"],s);const i=r(t,["documentName"]);return i!=null&&l(e,["documentName"],i),e}function dr(t){const e={},n=r(t,["uri"]);n!=null&&l(e,["uri"],n);const s=r(t,["encodedVideo"]);s!=null&&l(e,["videoBytes"],Zt(s));const i=r(t,["encoding"]);return i!=null&&l(e,["mimeType"],i),e}function ur(t){const e={},n=r(t,["gcsUri"]);n!=null&&l(e,["uri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&l(e,["videoBytes"],Zt(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vn;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vn||(vn={}));var yn;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(yn||(yn={}));var bn;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(bn||(bn={}));var ye;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(ye||(ye={}));var Nn;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Nn||(Nn={}));var wn;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(wn||(wn={}));var Sn;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Sn||(Sn={}));var Cn;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Cn||(Cn={}));var En;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(En||(En={}));var Tn;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Tn||(Tn={}));var _n;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(_n||(_n={}));var In;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(In||(In={}));var An;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(An||(An={}));var kn;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(kn||(kn={}));var Rn;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Rn||(Rn={}));var Mn;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(Mn||(Mn={}));var Pn;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Pn||(Pn={}));var Ln;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ln||(Ln={}));var jn;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(jn||(jn={}));var Dn;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Dn||(Dn={}));var Un;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Un||(Un={}));var pt;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(pt||(pt={}));var Fn;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Fn||(Fn={}));var Vn;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Vn||(Vn={}));var Gn;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Gn||(Gn={}));var Gt;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Gt||(Gt={}));var Hn;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Hn||(Hn={}));var Bn;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Bn||(Bn={}));var qn;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(qn||(qn={}));var On;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(On||(On={}));var $n;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})($n||($n={}));var Jn;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Jn||(Jn={}));var Wn;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Wn||(Wn={}));var zn;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(zn||(zn={}));var Kn;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Kn||(Kn={}));var Yn;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Yn||(Yn={}));var Xn;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Xn||(Xn={}));var Qn;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Qn||(Qn={}));var Zn;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Zn||(Zn={}));var es;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(es||(es={}));var ts;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(ts||(ts={}));var ns;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(ns||(ns={}));var ss;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(ss||(ss={}));var os;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(os||(os={}));var is;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(is||(is={}));var rs;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(rs||(rs={}));var as;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(as||(as={}));var ls;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(ls||(ls={}));var cs;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(cs||(cs={}));var ds;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(ds||(ds={}));var us;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(us||(us={}));var ps;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ps||(ps={}));var fs;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(fs||(fs={}));var ms;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(ms||(ms={}));var Fe;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Fe||(Fe={}));class Ht{constructor(e){const n={};for(const s of e.headers.entries())n[s[0]]=s[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ze{get text(){var e,n,s,i,a,c,d,p;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const m=[];for(const h of(p=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[g,x]of Object.entries(h))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(x!==null||x!==void 0)&&m.push(g);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;f=!0,u+=h.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,s,i,a,c,d,p;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const m of(p=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[h,g]of Object.entries(m))h!=="inlineData"&&(g!==null||g!==void 0)&&f.push(h);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,s,i,a,c,d,p;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(p=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if(u?.length!==0)return u}get executableCode(){var e,n,s,i,a,c,d,p,u;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(p=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if(f?.length!==0)return(u=f?.[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,s,i,a,c,d,p,u;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(p=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if(f?.length!==0)return(u=f?.[0])===null||u===void 0?void 0:u.output}}class hs{}class gs{}class pr{}class fr{}class mr{}class hr{}class xs{}class vs{}class ys{}class gr{}class ft{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const s=new ft;let i;const a=e;return n?i=er(a):i=Zi(a),Object.assign(s,i),s}}class bs{}class Ns{}class ws{}class Ss{}class xr{}class vr{}class yr{}class en{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const s=new en,a=ar(e);return Object.assign(s,a),s}}class br{}class Nr{}class wr{}class Cs{}class Sr{get text(){var e,n,s;let i="",a=!1;const c=[];for(const d of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[p,u]of Object.entries(d))p!=="text"&&p!=="thought"&&u!==null&&c.push(p);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;a=!0,i+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?i:void 0}get data(){var e,n,s;let i="";const a=[];for(const c of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[d,p]of Object.entries(c))d!=="inlineData"&&p!==null&&a.push(d);c.inlineData&&typeof c.inlineData.data=="string"&&(i+=atob(c.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Cr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tn{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const s=new tn,a=co(e);return Object.assign(s,a),s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function uo(t,e){const n=J(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function po(t){return Array.isArray(t)?t.map(e=>mt(e)):[mt(t)]}function mt(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function fo(t){const e=mt(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function mo(t){const e=mt(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Es(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function ho(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Es(e)):[Es(t)]}function Bt(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Ts(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function _s(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Z(t){if(t==null)throw new Error("ContentUnion is required");return Bt(t)?t:{role:"user",parts:ho(t)}}function nn(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const s=Z(n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(t.isVertexAI()){const n=Z(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Z(n)):[Z(e)]}function ie(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Ts(t)||_s(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Z(t)]}const e=[],n=[],s=Bt(t[0]);for(const i of t){const a=Bt(i);if(a!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(i);else{if(Ts(i)||_s(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return s||e.push({role:"user",parts:ho(n)}),e}function Er(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(s=>s!=="null");if(n.length===1)e.type=Object.values(ye).includes(n[0].toUpperCase())?n[0].toUpperCase():ye.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of n)e.anyOf.push({type:Object.values(ye).includes(s.toUpperCase())?s.toUpperCase():ye.TYPE_UNSPECIFIED})}}function Ge(t){const e={},n=["items"],s=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=t.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,t=a[1]):a[1].type==="null"&&(e.nullable=!0,t=a[0])),t.type instanceof Array&&Er(t.type,e);for(const[c,d]of Object.entries(t))if(d!=null)if(c=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(ye).includes(d.toUpperCase())?d.toUpperCase():ye.TYPE_UNSPECIFIED}else if(n.includes(c))e[c]=Ge(d);else if(s.includes(c)){const p=[];for(const u of d){if(u.type=="null"){e.nullable=!0;continue}p.push(Ge(u))}e[c]=p}else if(i.includes(c)){const p={};for(const[u,f]of Object.entries(d))p[u]=Ge(f);e[c]=p}else{if(c==="additionalProperties")continue;e[c]=d}return e}function sn(t){return Ge(t)}function on(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function rn(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function qe(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ge(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ge(e.response));return t}function Oe(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Tr(t,e,n,s=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===s;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function xe(t,e){if(typeof e!="string")throw new Error("name must be a string");return Tr(t,e,"cachedContents")}function go(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function be(t){return Zt(t)}function _r(t){return t!=null&&typeof t=="object"&&"name"in t}function Ir(t){return t!=null&&typeof t=="object"&&"video"in t}function Ar(t){return t!=null&&typeof t=="object"&&"uri"in t}function xo(t){var e;let n;if(_r(t)&&(n=t.name),!(Ar(t)&&(n=t.uri,n===void 0))&&!(Ir(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function vo(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function yo(t){for(const e of["models","tunedModels","publisherModels"])if(kr(t,e))return t[e];return[]}function kr(t,e){return t!==null&&typeof t=="object"&&e in t}function Rr(t,e={}){const n=t,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(s.responseJsonSchema=n.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function Mr(t,e={}){const n=[],s=new Set;for(const i of t){const a=i.name;if(s.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);s.add(a);const c=Rr(i,e);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function bo(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Pr(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function No(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let a=!1;for(const c of i){if(typeof c!="object"||c===null)continue;const p=c.response;if(typeof p!="object"||p===null)continue;if(p.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function $e(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function wo(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lr(t){const e={},n=r(t,["responsesFile"]);n!=null&&l(e,["fileName"],n);const s=r(t,["inlinedResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>ma(c))),l(e,["inlinedResponses"],a)}const i=r(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["inlinedEmbedContentResponses"],a)}return e}function jr(t){const e={},n=r(t,["predictionsFormat"]);n!=null&&l(e,["format"],n);const s=r(t,["gcsDestination","outputUriPrefix"]);s!=null&&l(e,["gcsUri"],s);const i=r(t,["bigqueryDestination","outputUri"]);return i!=null&&l(e,["bigqueryUri"],i),e}function Dr(t){const e={},n=r(t,["format"]);n!=null&&l(e,["predictionsFormat"],n);const s=r(t,["gcsUri"]);s!=null&&l(e,["gcsDestination","outputUriPrefix"],s);const i=r(t,["bigqueryUri"]);if(i!=null&&l(e,["bigqueryDestination","outputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(r(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function dt(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata","displayName"]);s!=null&&l(e,["displayName"],s);const i=r(t,["metadata","state"]);i!=null&&l(e,["state"],wo(i));const a=r(t,["metadata","createTime"]);a!=null&&l(e,["createTime"],a);const c=r(t,["metadata","endTime"]);c!=null&&l(e,["endTime"],c);const d=r(t,["metadata","updateTime"]);d!=null&&l(e,["updateTime"],d);const p=r(t,["metadata","model"]);p!=null&&l(e,["model"],p);const u=r(t,["metadata","output"]);return u!=null&&l(e,["dest"],Lr(No(u))),e}function qt(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["displayName"]);s!=null&&l(e,["displayName"],s);const i=r(t,["state"]);i!=null&&l(e,["state"],wo(i));const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["createTime"]);c!=null&&l(e,["createTime"],c);const d=r(t,["startTime"]);d!=null&&l(e,["startTime"],d);const p=r(t,["endTime"]);p!=null&&l(e,["endTime"],p);const u=r(t,["updateTime"]);u!=null&&l(e,["updateTime"],u);const f=r(t,["model"]);f!=null&&l(e,["model"],f);const m=r(t,["inputConfig"]);m!=null&&l(e,["src"],Ur(m));const h=r(t,["outputConfig"]);h!=null&&l(e,["dest"],jr(No(h)));const g=r(t,["completionStats"]);return g!=null&&l(e,["completionStats"],g),e}function Ur(t){const e={},n=r(t,["instancesFormat"]);n!=null&&l(e,["format"],n);const s=r(t,["gcsSource","uris"]);s!=null&&l(e,["gcsUri"],s);const i=r(t,["bigquerySource","inputUri"]);return i!=null&&l(e,["bigqueryUri"],i),e}function Fr(t,e){const n={};if(r(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=r(e,["fileName"]);s!=null&&l(n,["fileName"],s);const i=r(e,["inlinedRequests"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>fa(t,c))),l(n,["requests","requests"],a)}return n}function Vr(t){const e={},n=r(t,["format"]);n!=null&&l(e,["instancesFormat"],n);const s=r(t,["gcsUri"]);s!=null&&l(e,["gcsSource","uris"],s);const i=r(t,["bigqueryUri"]);if(i!=null&&l(e,["bigquerySource","inputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Gr(t){const e={},n=r(t,["data"]);if(n!=null&&l(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Hr(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function Br(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function qr(t){const e={},n=r(t,["content"]);n!=null&&l(e,["content"],n);const s=r(t,["citationMetadata"]);s!=null&&l(e,["citationMetadata"],Or(s));const i=r(t,["tokenCount"]);i!=null&&l(e,["tokenCount"],i);const a=r(t,["finishReason"]);a!=null&&l(e,["finishReason"],a);const c=r(t,["avgLogprobs"]);c!=null&&l(e,["avgLogprobs"],c);const d=r(t,["groundingMetadata"]);d!=null&&l(e,["groundingMetadata"],d);const p=r(t,["index"]);p!=null&&l(e,["index"],p);const u=r(t,["logprobsResult"]);u!=null&&l(e,["logprobsResult"],u);const f=r(t,["safetyRatings"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>g)),l(e,["safetyRatings"],h)}const m=r(t,["urlContextMetadata"]);return m!=null&&l(e,["urlContextMetadata"],m),e}function Or(t){const e={},n=r(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),l(e,["citations"],s)}return e}function So(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Na(a))),l(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&l(e,["role"],s),e}function $r(t,e){const n={},s=r(t,["displayName"]);if(e!==void 0&&s!=null&&l(e,["batch","displayName"],s),r(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Jr(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&l(e,["displayName"],s);const i=r(t,["dest"]);return e!==void 0&&i!=null&&l(e,["outputConfig"],Dr(Pr(i))),n}function Is(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["src"]);i!=null&&l(n,["batch","inputConfig"],Fr(t,bo(t,i)));const a=r(e,["config"]);return a!=null&&$r(a,n),n}function Wr(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["model"],J(t,s));const i=r(e,["src"]);i!=null&&l(n,["inputConfig"],Vr(bo(t,i)));const a=r(e,["config"]);return a!=null&&Jr(a,n),n}function zr(t,e){const n={},s=r(t,["displayName"]);return e!==void 0&&s!=null&&l(e,["batch","displayName"],s),n}function Kr(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["src"]);i!=null&&l(n,["batch","inputConfig"],na(t,i));const a=r(e,["config"]);return a!=null&&zr(a,n),n}function Yr(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function Xr(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function Qr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&l(e,["name"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);return a!=null&&l(e,["error"],a),e}function Zr(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&l(e,["name"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);return a!=null&&l(e,["error"],a),e}function ea(t,e){const n={},s=r(e,["contents"]);if(s!=null){let a=nn(t,s);Array.isArray(a)&&(a=a.map(c=>c)),l(n,["requests[]","request","content"],a)}const i=r(e,["config"]);return i!=null&&(l(n,["_self"],ta(i,n)),Xi(n,{"requests[].*":"requests[].request.*"})),n}function ta(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&l(e,["requests[]","taskType"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&l(e,["requests[]","title"],i);const a=r(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&l(e,["requests[]","outputDimensionality"],a),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function na(t,e){const n={},s=r(e,["fileName"]);s!=null&&l(n,["file_name"],s);const i=r(e,["inlinedRequests"]);return i!=null&&l(n,["requests"],ea(t,i)),n}function sa(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function oa(t){const e={},n=r(t,["id"]);n!=null&&l(e,["id"],n);const s=r(t,["args"]);s!=null&&l(e,["args"],s);const i=r(t,["name"]);if(i!=null&&l(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ia(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&l(e,["allowedFunctionNames"],n);const s=r(t,["mode"]);if(s!=null&&l(e,["mode"],s),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ra(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],So(Z(i)));const a=r(e,["temperature"]);a!=null&&l(s,["temperature"],a);const c=r(e,["topP"]);c!=null&&l(s,["topP"],c);const d=r(e,["topK"]);d!=null&&l(s,["topK"],d);const p=r(e,["candidateCount"]);p!=null&&l(s,["candidateCount"],p);const u=r(e,["maxOutputTokens"]);u!=null&&l(s,["maxOutputTokens"],u);const f=r(e,["stopSequences"]);f!=null&&l(s,["stopSequences"],f);const m=r(e,["responseLogprobs"]);m!=null&&l(s,["responseLogprobs"],m);const h=r(e,["logprobs"]);h!=null&&l(s,["logprobs"],h);const g=r(e,["presencePenalty"]);g!=null&&l(s,["presencePenalty"],g);const x=r(e,["frequencyPenalty"]);x!=null&&l(s,["frequencyPenalty"],x);const y=r(e,["seed"]);y!=null&&l(s,["seed"],y);const v=r(e,["responseMimeType"]);v!=null&&l(s,["responseMimeType"],v);const b=r(e,["responseSchema"]);b!=null&&l(s,["responseSchema"],sn(b));const I=r(e,["responseJsonSchema"]);if(I!=null&&l(s,["responseJsonSchema"],I),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const N=r(e,["safetySettings"]);if(n!==void 0&&N!=null){let M=N;Array.isArray(M)&&(M=M.map(G=>wa(G))),l(n,["safetySettings"],M)}const A=r(e,["tools"]);if(n!==void 0&&A!=null){let M=Oe(A);Array.isArray(M)&&(M=M.map(G=>Ca(qe(G)))),l(n,["tools"],M)}const _=r(e,["toolConfig"]);if(n!==void 0&&_!=null&&l(n,["toolConfig"],Sa(_)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=r(e,["cachedContent"]);n!==void 0&&w!=null&&l(n,["cachedContent"],xe(t,w));const C=r(e,["responseModalities"]);C!=null&&l(s,["responseModalities"],C);const k=r(e,["mediaResolution"]);k!=null&&l(s,["mediaResolution"],k);const E=r(e,["speechConfig"]);if(E!=null&&l(s,["speechConfig"],on(E)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const S=r(e,["thinkingConfig"]);S!=null&&l(s,["thinkingConfig"],S);const R=r(e,["imageConfig"]);R!=null&&l(s,["imageConfig"],pa(R));const U=r(e,["enableEnhancedCivicAnswers"]);return U!=null&&l(s,["enableEnhancedCivicAnswers"],U),s}function aa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(u=>qr(u))),l(e,["candidates"],p)}const i=r(t,["modelVersion"]);i!=null&&l(e,["modelVersion"],i);const a=r(t,["promptFeedback"]);a!=null&&l(e,["promptFeedback"],a);const c=r(t,["responseId"]);c!=null&&l(e,["responseId"],c);const d=r(t,["usageMetadata"]);return d!=null&&l(e,["usageMetadata"],d),e}function la(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function ca(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],$e(t,s)),n}function da(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function ua(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function pa(t){const e={},n=r(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const s=r(t,["imageSize"]);if(s!=null&&l(e,["imageSize"],s),r(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function fa(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["request","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let d=ie(i);Array.isArray(d)&&(d=d.map(p=>So(p))),l(n,["request","contents"],d)}const a=r(e,["metadata"]);a!=null&&l(n,["metadata"],a);const c=r(e,["config"]);return c!=null&&l(n,["request","generationConfig"],ra(t,c,r(n,["request"],{}))),n}function ma(t){const e={},n=r(t,["response"]);n!=null&&l(e,["response"],aa(n));const s=r(t,["error"]);return s!=null&&l(e,["error"],s),e}function ha(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);if(e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),r(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ga(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&l(e,["_query","pageToken"],i);const a=r(t,["filter"]);return e!==void 0&&a!=null&&l(e,["_query","filter"],a),n}function xa(t){const e={},n=r(t,["config"]);return n!=null&&ha(n,e),e}function va(t){const e={},n=r(t,["config"]);return n!=null&&ga(n,e),e}function ya(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["operations"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>dt(c))),l(e,["batchJobs"],a)}return e}function ba(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["batchPredictionJobs"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>qt(c))),l(e,["batchJobs"],a)}return e}function Na(t){const e={},n=r(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const s=r(t,["codeExecutionResult"]);s!=null&&l(e,["codeExecutionResult"],s);const i=r(t,["executableCode"]);i!=null&&l(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&l(e,["fileData"],sa(a));const c=r(t,["functionCall"]);c!=null&&l(e,["functionCall"],oa(c));const d=r(t,["functionResponse"]);d!=null&&l(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&l(e,["inlineData"],Gr(p));const u=r(t,["text"]);u!=null&&l(e,["text"],u);const f=r(t,["thought"]);f!=null&&l(e,["thought"],f);const m=r(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const h=r(t,["videoMetadata"]);return h!=null&&l(e,["videoMetadata"],h),e}function wa(t){const e={},n=r(t,["category"]);if(n!=null&&l(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=r(t,["threshold"]);return s!=null&&l(e,["threshold"],s),e}function Sa(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&l(e,["retrievalConfig"],n);const s=r(t,["functionCallingConfig"]);return s!=null&&l(e,["functionCallingConfig"],ia(s)),e}function Ca(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&l(e,["computerUse"],n);const s=r(t,["fileSearch"]);s!=null&&l(e,["fileSearch"],s);const i=r(t,["codeExecution"]);if(i!=null&&l(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=r(t,["functionDeclarations"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}const c=r(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],da(c));const d=r(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],ua(d));const p=r(t,["googleSearchRetrieval"]);p!=null&&l(e,["googleSearchRetrieval"],p);const u=r(t,["urlContext"]);return u!=null&&l(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var he;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(he||(he={}));class ke{constructor(e,n,s,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,s,i)}init(e,n,s){var i,a;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n?.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!s||Object.keys(s).length===0?c={config:{}}:typeof s=="object"?c=Object.assign({},s):c=s,c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(a=(i=c.config)===null||i===void 0?void 0:i.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ea extends ge{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ke(he.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=Is(this.apiClient,e),s=n._url,i=P("{model}:batchGenerateContent",s),d=n.batch.inputConfig.requests,p=d.requests,u=[];for(const f of p){const m=Object.assign({},f);if(m.systemInstruction){const h=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=h,m.request=g}u.push(m)}return d.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const s=n?Object.assign({},n):{},i=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${i}`),s.dest===void 0){const a=this.getGcsUri(e),c=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?s.dest=`${a.slice(0,-6)}/dest`:s.dest=`${a}_dest_${i}`;else if(c)s.dest=`${c}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Wr(this.apiClient,e);return d=P("batchPredictionJobs",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>qt(f))}else{const u=Is(this.apiClient,e);return d=P("{model}:batchGenerateContent",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>dt(f))}}async createEmbeddingsInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Kr(this.apiClient,e);return a=P("{model}:asyncBatchEmbedContent",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>dt(p))}}async get(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=ca(this.apiClient,e);return d=P("batchPredictionJobs/{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>qt(f))}else{const u=la(this.apiClient,e);return d=P("batches/{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>dt(f))}}async cancel(e){var n,s,i,a;let c="",d={};if(this.apiClient.isVertexAI()){const p=Br(this.apiClient,e);c=P("batchPredictionJobs/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const p=Hr(this.apiClient,e);c=P("batches/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=va(e);return d=P("batchPredictionJobs",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=ba(f),h=new Cs;return Object.assign(h,m),h})}else{const u=xa(e);return d=P("batches",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=ya(f),h=new Cs;return Object.assign(h,m),h})}}async delete(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Xr(this.apiClient,e);return d=P("batchPredictionJobs/{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>Zr(f))}else{const u=Yr(this.apiClient,e);return d=P("batches/{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>Qr(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ta(t){const e={},n=r(t,["data"]);if(n!=null&&l(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function As(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Ka(a))),l(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&l(e,["role"],s),e}function _a(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&l(e,["ttl"],s);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&l(e,["expireTime"],i);const a=r(t,["displayName"]);e!==void 0&&a!=null&&l(e,["displayName"],a);const c=r(t,["contents"]);if(e!==void 0&&c!=null){let f=ie(c);Array.isArray(f)&&(f=f.map(m=>As(m))),l(e,["contents"],f)}const d=r(t,["systemInstruction"]);e!==void 0&&d!=null&&l(e,["systemInstruction"],As(Z(d)));const p=r(t,["tools"]);if(e!==void 0&&p!=null){let f=p;Array.isArray(f)&&(f=f.map(m=>Xa(m))),l(e,["tools"],f)}const u=r(t,["toolConfig"]);if(e!==void 0&&u!=null&&l(e,["toolConfig"],Ya(u)),r(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Ia(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&l(e,["ttl"],s);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&l(e,["expireTime"],i);const a=r(t,["displayName"]);e!==void 0&&a!=null&&l(e,["displayName"],a);const c=r(t,["contents"]);if(e!==void 0&&c!=null){let m=ie(c);Array.isArray(m)&&(m=m.map(h=>h)),l(e,["contents"],m)}const d=r(t,["systemInstruction"]);e!==void 0&&d!=null&&l(e,["systemInstruction"],Z(d));const p=r(t,["tools"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Qa(h))),l(e,["tools"],m)}const u=r(t,["toolConfig"]);e!==void 0&&u!=null&&l(e,["toolConfig"],u);const f=r(t,["kmsKeyName"]);return e!==void 0&&f!=null&&l(e,["encryption_spec","kmsKeyName"],f),n}function Aa(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["model"],uo(t,s));const i=r(e,["config"]);return i!=null&&_a(i,n),n}function ka(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["model"],uo(t,s));const i=r(e,["config"]);return i!=null&&Ia(i,n),n}function Ra(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],xe(t,s)),n}function Ma(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],xe(t,s)),n}function Pa(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function La(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function ja(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Da(t){const e={},n=r(t,["id"]);n!=null&&l(e,["id"],n);const s=r(t,["args"]);s!=null&&l(e,["args"],s);const i=r(t,["name"]);if(i!=null&&l(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Ua(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&l(e,["allowedFunctionNames"],n);const s=r(t,["mode"]);if(s!=null&&l(e,["mode"],s),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Fa(t){const e={},n=r(t,["description"]);n!=null&&l(e,["description"],n);const s=r(t,["name"]);s!=null&&l(e,["name"],s);const i=r(t,["parameters"]);i!=null&&l(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&l(e,["parametersJsonSchema"],a);const c=r(t,["response"]);c!=null&&l(e,["response"],c);const d=r(t,["responseJsonSchema"]);if(d!=null&&l(e,["responseJsonSchema"],d),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function Va(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],xe(t,s)),n}function Ga(t,e){const n={},s=r(e,["name"]);return s!=null&&l(n,["_url","name"],xe(t,s)),n}function Ha(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Ba(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function qa(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function Oa(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function $a(t){const e={},n=r(t,["config"]);return n!=null&&qa(n,e),e}function Ja(t){const e={},n=r(t,["config"]);return n!=null&&Oa(n,e),e}function Wa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["cachedContents"],a)}return e}function za(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["cachedContents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["cachedContents"],a)}return e}function Ka(t){const e={},n=r(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const s=r(t,["codeExecutionResult"]);s!=null&&l(e,["codeExecutionResult"],s);const i=r(t,["executableCode"]);i!=null&&l(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&l(e,["fileData"],ja(a));const c=r(t,["functionCall"]);c!=null&&l(e,["functionCall"],Da(c));const d=r(t,["functionResponse"]);d!=null&&l(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&l(e,["inlineData"],Ta(p));const u=r(t,["text"]);u!=null&&l(e,["text"],u);const f=r(t,["thought"]);f!=null&&l(e,["thought"],f);const m=r(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const h=r(t,["videoMetadata"]);return h!=null&&l(e,["videoMetadata"],h),e}function Ya(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&l(e,["retrievalConfig"],n);const s=r(t,["functionCallingConfig"]);return s!=null&&l(e,["functionCallingConfig"],Ua(s)),e}function Xa(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&l(e,["computerUse"],n);const s=r(t,["fileSearch"]);s!=null&&l(e,["fileSearch"],s);const i=r(t,["codeExecution"]);if(i!=null&&l(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=r(t,["functionDeclarations"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}const c=r(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],Ha(c));const d=r(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],Ba(d));const p=r(t,["googleSearchRetrieval"]);p!=null&&l(e,["googleSearchRetrieval"],p);const u=r(t,["urlContext"]);return u!=null&&l(e,["urlContext"],u),e}function Qa(t){const e={},n=r(t,["retrieval"]);n!=null&&l(e,["retrieval"],n);const s=r(t,["computerUse"]);if(s!=null&&l(e,["computerUse"],s),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&l(e,["codeExecution"],i);const a=r(t,["enterpriseWebSearch"]);a!=null&&l(e,["enterpriseWebSearch"],a);const c=r(t,["functionDeclarations"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>Fa(h))),l(e,["functionDeclarations"],m)}const d=r(t,["googleMaps"]);d!=null&&l(e,["googleMaps"],d);const p=r(t,["googleSearch"]);p!=null&&l(e,["googleSearch"],p);const u=r(t,["googleSearchRetrieval"]);u!=null&&l(e,["googleSearchRetrieval"],u);const f=r(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function Za(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&l(e,["ttl"],s);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&l(e,["expireTime"],i),n}function el(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&l(e,["ttl"],s);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&l(e,["expireTime"],i),n}function tl(t,e){const n={},s=r(e,["name"]);s!=null&&l(n,["_url","name"],xe(t,s));const i=r(e,["config"]);return i!=null&&Za(i,n),n}function nl(t,e){const n={},s=r(e,["name"]);s!=null&&l(n,["_url","name"],xe(t,s));const i=r(e,["config"]);return i!=null&&el(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sl extends ge{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ke(he.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(n),n)}async create(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=ka(this.apiClient,e);return d=P("cachedContents",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>f)}else{const u=Aa(this.apiClient,e);return d=P("cachedContents",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>f)}}async get(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ga(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>f)}else{const u=Va(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>f)}}async delete(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ma(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=La(f),h=new ws;return Object.assign(h,m),h})}else{const u=Ra(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Pa(f),h=new ws;return Object.assign(h,m),h})}}async update(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=nl(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>f)}else{const u=tl(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>f)}}async listInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ja(e);return d=P("cachedContents",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=za(f),h=new Ss;return Object.assign(h,m),h})}else{const u=$a(e);return d=P("cachedContents",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Wa(f),h=new Ss;return Object.assign(h,m),h})}}}function ht(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function ks(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function H(t){return this instanceof H?(this.v=t,this):new H(t)}function de(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(g){return function(x){return Promise.resolve(x).then(g,m)}}function d(g,x){s[g]&&(i[g]=function(y){return new Promise(function(v,b){a.push([g,y,v,b])>1||p(g,y)})},x&&(i[g]=x(i[g])))}function p(g,x){try{u(s[g](x))}catch(y){h(a[0][3],y)}}function u(g){g.value instanceof H?Promise.resolve(g.value.v).then(f,m):h(a[0][2],g)}function f(g){p("next",g)}function m(g){p("throw",g)}function h(g,x){g(x),a.shift(),a.length&&p(a[0][0],a[0][1])}}function ue(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ks=="function"?ks(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(a){n[a]=t[a]&&function(c){return new Promise(function(d,p){c=t[a](c),i(d,p,c.done,c.value)})}}function i(a,c,d,p){Promise.resolve(p).then(function(u){a({value:u,done:d})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ol(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Co(n)}function Co(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function il(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Rs(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let s=0;for(;s<n;)if(t[s].role==="user")e.push(t[s]),s++;else{const i=[];let a=!0;for(;s<n&&t[s].role==="model";)i.push(t[s]),a&&!Co(t[s])&&(a=!1),s++;a?e.push(...i):e.pop()}return e}class rl{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new al(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class al{constructor(e,n,s,i={},a=[]){this.apiClient=e,this.modelsModule=n,this.model=s,this.config=i,this.history=a,this.sendPromise=Promise.resolve(),il(a)}async sendMessage(e){var n;await this.sendPromise;const s=Z(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var a,c,d;const p=await i,u=(c=(a=p.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content,f=p.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let h=[];f!=null&&(h=(d=f.slice(m))!==null&&d!==void 0?d:[]);const g=u?[u]:[];this.recordHistory(s,g,h)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const s=Z(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const a=await i;return this.processStreamResponse(a,s)}getHistory(e=!1){const n=e?Rs(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return de(this,arguments,function*(){var i,a,c,d,p,u;const f=[];try{for(var m=!0,h=ue(e),g;g=yield H(h.next()),i=g.done,!i;m=!0){d=g.value,m=!1;const x=d;if(ol(x)){const y=(u=(p=x.candidates)===null||p===void 0?void 0:p[0])===null||u===void 0?void 0:u.content;y!==void 0&&f.push(y)}yield yield H(x)}}catch(x){a={error:x}}finally{try{!m&&!i&&(c=h.return)&&(yield H(c.call(h)))}finally{if(a)throw a.error}}this.recordHistory(n,f)})}recordHistory(e,n,s){let i=[];n.length>0&&n.every(a=>a.role!==void 0)?i=n:i.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...Rs(s)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wt extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,wt.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ll(t){const e={},n=r(t,["file"]);return n!=null&&l(e,["file"],n),e}function cl(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function dl(t){const e={},n=r(t,["name"]);return n!=null&&l(e,["_url","file"],xo(n)),e}function ul(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function pl(t){const e={},n=r(t,["name"]);return n!=null&&l(e,["_url","file"],xo(n)),e}function fl(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function ml(t){const e={},n=r(t,["config"]);return n!=null&&fl(n,e),e}function hl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["files"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gl extends ge{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ke(he.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=ml(e);return a=P("files",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>{const u=hl(p),f=new br;return Object.assign(f,u),f})}}async createInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=ll(e);return a=P("upload/v1beta/files",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=cl(p),f=new Nr;return Object.assign(f,u),f})}}async get(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=pl(e);return a=P("files/{file}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>p)}}async delete(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=dl(e);return a=P("files/{file}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>{const u=ul(p),f=new wr;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ut(t){const e={},n=r(t,["data"]);if(n!=null&&l(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function xl(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Pl(a))),l(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&l(e,["role"],s),e}function vl(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function yl(t){const e={},n=r(t,["id"]);n!=null&&l(e,["id"],n);const s=r(t,["args"]);s!=null&&l(e,["args"],s);const i=r(t,["name"]);if(i!=null&&l(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function bl(t){const e={},n=r(t,["description"]);n!=null&&l(e,["description"],n);const s=r(t,["name"]);s!=null&&l(e,["name"],s);const i=r(t,["parameters"]);i!=null&&l(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&l(e,["parametersJsonSchema"],a);const c=r(t,["response"]);c!=null&&l(e,["response"],c);const d=r(t,["responseJsonSchema"]);if(d!=null&&l(e,["responseJsonSchema"],d),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function Nl(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&l(e,["modelConfig"],n);const s=r(t,["responseJsonSchema"]);s!=null&&l(e,["responseJsonSchema"],s);const i=r(t,["audioTimestamp"]);i!=null&&l(e,["audioTimestamp"],i);const a=r(t,["candidateCount"]);a!=null&&l(e,["candidateCount"],a);const c=r(t,["enableAffectiveDialog"]);c!=null&&l(e,["enableAffectiveDialog"],c);const d=r(t,["frequencyPenalty"]);d!=null&&l(e,["frequencyPenalty"],d);const p=r(t,["logprobs"]);p!=null&&l(e,["logprobs"],p);const u=r(t,["maxOutputTokens"]);u!=null&&l(e,["maxOutputTokens"],u);const f=r(t,["mediaResolution"]);f!=null&&l(e,["mediaResolution"],f);const m=r(t,["presencePenalty"]);m!=null&&l(e,["presencePenalty"],m);const h=r(t,["responseLogprobs"]);h!=null&&l(e,["responseLogprobs"],h);const g=r(t,["responseMimeType"]);g!=null&&l(e,["responseMimeType"],g);const x=r(t,["responseModalities"]);x!=null&&l(e,["responseModalities"],x);const y=r(t,["responseSchema"]);y!=null&&l(e,["responseSchema"],y);const v=r(t,["routingConfig"]);v!=null&&l(e,["routingConfig"],v);const b=r(t,["seed"]);b!=null&&l(e,["seed"],b);const I=r(t,["speechConfig"]);I!=null&&l(e,["speechConfig"],I);const N=r(t,["stopSequences"]);N!=null&&l(e,["stopSequences"],N);const A=r(t,["temperature"]);A!=null&&l(e,["temperature"],A);const _=r(t,["thinkingConfig"]);_!=null&&l(e,["thinkingConfig"],_);const w=r(t,["topK"]);w!=null&&l(e,["topK"],w);const C=r(t,["topP"]);if(C!=null&&l(e,["topP"],C),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function wl(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Sl(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function Cl(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig"],s);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","temperature"],a);const c=r(t,["topP"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","topK"],d);const p=r(t,["maxOutputTokens"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","maxOutputTokens"],p);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","mediaResolution"],u);const f=r(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=r(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],rn(m));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","thinkingConfig"],h);const g=r(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=r(t,["systemInstruction"]);e!==void 0&&x!=null&&l(e,["setup","systemInstruction"],xl(Z(x)));const y=r(t,["tools"]);if(e!==void 0&&y!=null){let w=Oe(y);Array.isArray(w)&&(w=w.map(C=>jl(qe(C)))),l(e,["setup","tools"],w)}const v=r(t,["sessionResumption"]);e!==void 0&&v!=null&&l(e,["setup","sessionResumption"],Ll(v));const b=r(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&l(e,["setup","outputAudioTranscription"],I);const N=r(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&l(e,["setup","realtimeInputConfig"],N);const A=r(t,["contextWindowCompression"]);e!==void 0&&A!=null&&l(e,["setup","contextWindowCompression"],A);const _=r(t,["proactivity"]);if(e!==void 0&&_!=null&&l(e,["setup","proactivity"],_),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function El(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig"],Nl(s));const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","temperature"],a);const c=r(t,["topP"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","topK"],d);const p=r(t,["maxOutputTokens"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","maxOutputTokens"],p);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","mediaResolution"],u);const f=r(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=r(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],rn(m));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","thinkingConfig"],h);const g=r(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=r(t,["systemInstruction"]);e!==void 0&&x!=null&&l(e,["setup","systemInstruction"],Z(x));const y=r(t,["tools"]);if(e!==void 0&&y!=null){let C=Oe(y);Array.isArray(C)&&(C=C.map(k=>Dl(qe(k)))),l(e,["setup","tools"],C)}const v=r(t,["sessionResumption"]);e!==void 0&&v!=null&&l(e,["setup","sessionResumption"],v);const b=r(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&l(e,["setup","outputAudioTranscription"],I);const N=r(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&l(e,["setup","realtimeInputConfig"],N);const A=r(t,["contextWindowCompression"]);e!==void 0&&A!=null&&l(e,["setup","contextWindowCompression"],A);const _=r(t,["proactivity"]);e!==void 0&&_!=null&&l(e,["setup","proactivity"],_);const w=r(t,["explicitVadSignal"]);return e!==void 0&&w!=null&&l(e,["setup","explicitVadSignal"],w),n}function Tl(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["setup","model"],J(t,s));const i=r(e,["config"]);return i!=null&&l(n,["config"],Cl(i,n)),n}function _l(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["setup","model"],J(t,s));const i=r(e,["config"]);return i!=null&&l(n,["config"],El(i,n)),n}function Il(t){const e={},n=r(t,["musicGenerationConfig"]);return n!=null&&l(e,["musicGenerationConfig"],n),e}function Al(t){const e={},n=r(t,["weightedPrompts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),l(e,["weightedPrompts"],s)}return e}function kl(t){const e={},n=r(t,["media"]);if(n!=null){let u=po(n);Array.isArray(u)&&(u=u.map(f=>ut(f))),l(e,["mediaChunks"],u)}const s=r(t,["audio"]);s!=null&&l(e,["audio"],ut(mo(s)));const i=r(t,["audioStreamEnd"]);i!=null&&l(e,["audioStreamEnd"],i);const a=r(t,["video"]);a!=null&&l(e,["video"],ut(fo(a)));const c=r(t,["text"]);c!=null&&l(e,["text"],c);const d=r(t,["activityStart"]);d!=null&&l(e,["activityStart"],d);const p=r(t,["activityEnd"]);return p!=null&&l(e,["activityEnd"],p),e}function Rl(t){const e={},n=r(t,["media"]);if(n!=null){let u=po(n);Array.isArray(u)&&(u=u.map(f=>f)),l(e,["mediaChunks"],u)}const s=r(t,["audio"]);s!=null&&l(e,["audio"],mo(s));const i=r(t,["audioStreamEnd"]);i!=null&&l(e,["audioStreamEnd"],i);const a=r(t,["video"]);a!=null&&l(e,["video"],fo(a));const c=r(t,["text"]);c!=null&&l(e,["text"],c);const d=r(t,["activityStart"]);d!=null&&l(e,["activityStart"],d);const p=r(t,["activityEnd"]);return p!=null&&l(e,["activityEnd"],p),e}function Ml(t){const e={},n=r(t,["setupComplete"]);n!=null&&l(e,["setupComplete"],n);const s=r(t,["serverContent"]);s!=null&&l(e,["serverContent"],s);const i=r(t,["toolCall"]);i!=null&&l(e,["toolCall"],i);const a=r(t,["toolCallCancellation"]);a!=null&&l(e,["toolCallCancellation"],a);const c=r(t,["usageMetadata"]);c!=null&&l(e,["usageMetadata"],Ul(c));const d=r(t,["goAway"]);d!=null&&l(e,["goAway"],d);const p=r(t,["sessionResumptionUpdate"]);p!=null&&l(e,["sessionResumptionUpdate"],p);const u=r(t,["voiceActivityDetectionSignal"]);return u!=null&&l(e,["voiceActivityDetectionSignal"],u),e}function Pl(t){const e={},n=r(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const s=r(t,["codeExecutionResult"]);s!=null&&l(e,["codeExecutionResult"],s);const i=r(t,["executableCode"]);i!=null&&l(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&l(e,["fileData"],vl(a));const c=r(t,["functionCall"]);c!=null&&l(e,["functionCall"],yl(c));const d=r(t,["functionResponse"]);d!=null&&l(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&l(e,["inlineData"],ut(p));const u=r(t,["text"]);u!=null&&l(e,["text"],u);const f=r(t,["thought"]);f!=null&&l(e,["thought"],f);const m=r(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const h=r(t,["videoMetadata"]);return h!=null&&l(e,["videoMetadata"],h),e}function Ll(t){const e={},n=r(t,["handle"]);if(n!=null&&l(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function jl(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&l(e,["computerUse"],n);const s=r(t,["fileSearch"]);s!=null&&l(e,["fileSearch"],s);const i=r(t,["codeExecution"]);if(i!=null&&l(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=r(t,["functionDeclarations"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}const c=r(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],wl(c));const d=r(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],Sl(d));const p=r(t,["googleSearchRetrieval"]);p!=null&&l(e,["googleSearchRetrieval"],p);const u=r(t,["urlContext"]);return u!=null&&l(e,["urlContext"],u),e}function Dl(t){const e={},n=r(t,["retrieval"]);n!=null&&l(e,["retrieval"],n);const s=r(t,["computerUse"]);if(s!=null&&l(e,["computerUse"],s),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&l(e,["codeExecution"],i);const a=r(t,["enterpriseWebSearch"]);a!=null&&l(e,["enterpriseWebSearch"],a);const c=r(t,["functionDeclarations"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>bl(h))),l(e,["functionDeclarations"],m)}const d=r(t,["googleMaps"]);d!=null&&l(e,["googleMaps"],d);const p=r(t,["googleSearch"]);p!=null&&l(e,["googleSearch"],p);const u=r(t,["googleSearchRetrieval"]);u!=null&&l(e,["googleSearchRetrieval"],u);const f=r(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function Ul(t){const e={},n=r(t,["promptTokenCount"]);n!=null&&l(e,["promptTokenCount"],n);const s=r(t,["cachedContentTokenCount"]);s!=null&&l(e,["cachedContentTokenCount"],s);const i=r(t,["candidatesTokenCount"]);i!=null&&l(e,["responseTokenCount"],i);const a=r(t,["toolUsePromptTokenCount"]);a!=null&&l(e,["toolUsePromptTokenCount"],a);const c=r(t,["thoughtsTokenCount"]);c!=null&&l(e,["thoughtsTokenCount"],c);const d=r(t,["totalTokenCount"]);d!=null&&l(e,["totalTokenCount"],d);const p=r(t,["promptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(x=>x)),l(e,["promptTokensDetails"],g)}const u=r(t,["cacheTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>x)),l(e,["cacheTokensDetails"],g)}const f=r(t,["candidatesTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>x)),l(e,["responseTokensDetails"],g)}const m=r(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(x=>x)),l(e,["toolUsePromptTokensDetails"],g)}const h=r(t,["trafficType"]);return h!=null&&l(e,["trafficType"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fl(t){const e={},n=r(t,["data"]);if(n!=null&&l(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Vl(t){const e={},n=r(t,["content"]);n!=null&&l(e,["content"],n);const s=r(t,["citationMetadata"]);s!=null&&l(e,["citationMetadata"],Gl(s));const i=r(t,["tokenCount"]);i!=null&&l(e,["tokenCount"],i);const a=r(t,["finishReason"]);a!=null&&l(e,["finishReason"],a);const c=r(t,["avgLogprobs"]);c!=null&&l(e,["avgLogprobs"],c);const d=r(t,["groundingMetadata"]);d!=null&&l(e,["groundingMetadata"],d);const p=r(t,["index"]);p!=null&&l(e,["index"],p);const u=r(t,["logprobsResult"]);u!=null&&l(e,["logprobsResult"],u);const f=r(t,["safetyRatings"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>g)),l(e,["safetyRatings"],h)}const m=r(t,["urlContextMetadata"]);return m!=null&&l(e,["urlContextMetadata"],m),e}function Gl(t){const e={},n=r(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),l(e,["citations"],s)}return e}function Hl(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let a=ie(i);Array.isArray(a)&&(a=a.map(c=>c)),l(n,["contents"],a)}return n}function Bl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["tokensInfo"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),l(e,["tokensInfo"],i)}return e}function ql(t){const e={},n=r(t,["values"]);n!=null&&l(e,["values"],n);const s=r(t,["statistics"]);return s!=null&&l(e,["statistics"],Ol(s)),e}function Ol(t){const e={},n=r(t,["truncated"]);n!=null&&l(e,["truncated"],n);const s=r(t,["token_count"]);return s!=null&&l(e,["tokenCount"],s),e}function St(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Zc(a))),l(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&l(e,["role"],s),e}function $l(t){const e={},n=r(t,["controlType"]);n!=null&&l(e,["controlType"],n);const s=r(t,["enableControlImageComputation"]);return s!=null&&l(e,["computeControl"],s),e}function Jl(t){const e={};if(r(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Wl(t,e){const n={},s=r(t,["systemInstruction"]);e!==void 0&&s!=null&&l(e,["systemInstruction"],Z(s));const i=r(t,["tools"]);if(e!==void 0&&i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>Io(d))),l(e,["tools"],c)}const a=r(t,["generationConfig"]);return e!==void 0&&a!=null&&l(e,["generationConfig"],Fc(a)),n}function zl(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let c=ie(i);Array.isArray(c)&&(c=c.map(d=>St(d))),l(n,["contents"],c)}const a=r(e,["config"]);return a!=null&&Jl(a),n}function Kl(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let c=ie(i);Array.isArray(c)&&(c=c.map(d=>d)),l(n,["contents"],c)}const a=r(e,["config"]);return a!=null&&Wl(a,n),n}function Yl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["totalTokens"]);s!=null&&l(e,["totalTokens"],s);const i=r(t,["cachedContentTokenCount"]);return i!=null&&l(e,["cachedContentTokenCount"],i),e}function Xl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["totalTokens"]);return s!=null&&l(e,["totalTokens"],s),e}function Ql(t,e){const n={},s=r(e,["model"]);return s!=null&&l(n,["_url","name"],J(t,s)),n}function Zl(t,e){const n={},s=r(e,["model"]);return s!=null&&l(n,["_url","name"],J(t,s)),n}function ec(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function tc(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function nc(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&l(e,["parameters","storageUri"],s);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&l(e,["parameters","negativePrompt"],i);const a=r(t,["numberOfImages"]);e!==void 0&&a!=null&&l(e,["parameters","sampleCount"],a);const c=r(t,["aspectRatio"]);e!==void 0&&c!=null&&l(e,["parameters","aspectRatio"],c);const d=r(t,["guidanceScale"]);e!==void 0&&d!=null&&l(e,["parameters","guidanceScale"],d);const p=r(t,["seed"]);e!==void 0&&p!=null&&l(e,["parameters","seed"],p);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&l(e,["parameters","safetySetting"],u);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=r(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&l(e,["parameters","includeSafetyAttributes"],m);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&l(e,["parameters","includeRaiReason"],h);const g=r(t,["language"]);e!==void 0&&g!=null&&l(e,["parameters","language"],g);const x=r(t,["outputMimeType"]);e!==void 0&&x!=null&&l(e,["parameters","outputOptions","mimeType"],x);const y=r(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&l(e,["parameters","outputOptions","compressionQuality"],y);const v=r(t,["addWatermark"]);e!==void 0&&v!=null&&l(e,["parameters","addWatermark"],v);const b=r(t,["labels"]);e!==void 0&&b!=null&&l(e,["labels"],b);const I=r(t,["editMode"]);e!==void 0&&I!=null&&l(e,["parameters","editMode"],I);const N=r(t,["baseSteps"]);return e!==void 0&&N!=null&&l(e,["parameters","editConfig","baseSteps"],N),n}function sc(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const a=r(e,["referenceImages"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>id(p))),l(n,["instances[0]","referenceImages"],d)}const c=r(e,["config"]);return c!=null&&nc(c,n),n}function oc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>Ct(a))),l(e,["generatedImages"],i)}return e}function ic(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&l(e,["requests[]","taskType"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&l(e,["requests[]","title"],i);const a=r(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&l(e,["requests[]","outputDimensionality"],a),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function rc(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&l(e,["instances[]","task_type"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&l(e,["instances[]","title"],i);const a=r(t,["outputDimensionality"]);e!==void 0&&a!=null&&l(e,["parameters","outputDimensionality"],a);const c=r(t,["mimeType"]);e!==void 0&&c!=null&&l(e,["instances[]","mimeType"],c);const d=r(t,["autoTruncate"]);return e!==void 0&&d!=null&&l(e,["parameters","autoTruncate"],d),n}function ac(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let d=nn(t,i);Array.isArray(d)&&(d=d.map(p=>p)),l(n,["requests[]","content"],d)}const a=r(e,["config"]);a!=null&&ic(a,n);const c=r(e,["model"]);return c!==void 0&&l(n,["requests[]","model"],J(t,c)),n}function lc(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let c=nn(t,i);Array.isArray(c)&&(c=c.map(d=>d)),l(n,["instances[]","content"],c)}const a=r(e,["config"]);return a!=null&&rc(a,n),n}function cc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["embeddings"],a)}const i=r(t,["metadata"]);return i!=null&&l(e,["metadata"],i),e}function dc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["predictions[]","embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>ql(c))),l(e,["embeddings"],a)}const i=r(t,["metadata"]);return i!=null&&l(e,["metadata"],i),e}function uc(t){const e={},n=r(t,["endpoint"]);n!=null&&l(e,["name"],n);const s=r(t,["deployedModelId"]);return s!=null&&l(e,["deployedModelId"],s),e}function pc(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function fc(t){const e={},n=r(t,["id"]);n!=null&&l(e,["id"],n);const s=r(t,["args"]);s!=null&&l(e,["args"],s);const i=r(t,["name"]);if(i!=null&&l(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function mc(t){const e={},n=r(t,["allowedFunctionNames"]);n!=null&&l(e,["allowedFunctionNames"],n);const s=r(t,["mode"]);if(s!=null&&l(e,["mode"],s),r(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function hc(t){const e={},n=r(t,["description"]);n!=null&&l(e,["description"],n);const s=r(t,["name"]);s!=null&&l(e,["name"],s);const i=r(t,["parameters"]);i!=null&&l(e,["parameters"],i);const a=r(t,["parametersJsonSchema"]);a!=null&&l(e,["parametersJsonSchema"],a);const c=r(t,["response"]);c!=null&&l(e,["response"],c);const d=r(t,["responseJsonSchema"]);if(d!=null&&l(e,["responseJsonSchema"],d),r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function gc(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],St(Z(i)));const a=r(e,["temperature"]);a!=null&&l(s,["temperature"],a);const c=r(e,["topP"]);c!=null&&l(s,["topP"],c);const d=r(e,["topK"]);d!=null&&l(s,["topK"],d);const p=r(e,["candidateCount"]);p!=null&&l(s,["candidateCount"],p);const u=r(e,["maxOutputTokens"]);u!=null&&l(s,["maxOutputTokens"],u);const f=r(e,["stopSequences"]);f!=null&&l(s,["stopSequences"],f);const m=r(e,["responseLogprobs"]);m!=null&&l(s,["responseLogprobs"],m);const h=r(e,["logprobs"]);h!=null&&l(s,["logprobs"],h);const g=r(e,["presencePenalty"]);g!=null&&l(s,["presencePenalty"],g);const x=r(e,["frequencyPenalty"]);x!=null&&l(s,["frequencyPenalty"],x);const y=r(e,["seed"]);y!=null&&l(s,["seed"],y);const v=r(e,["responseMimeType"]);v!=null&&l(s,["responseMimeType"],v);const b=r(e,["responseSchema"]);b!=null&&l(s,["responseSchema"],sn(b));const I=r(e,["responseJsonSchema"]);if(I!=null&&l(s,["responseJsonSchema"],I),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const N=r(e,["safetySettings"]);if(n!==void 0&&N!=null){let M=N;Array.isArray(M)&&(M=M.map(G=>rd(G))),l(n,["safetySettings"],M)}const A=r(e,["tools"]);if(n!==void 0&&A!=null){let M=Oe(A);Array.isArray(M)&&(M=M.map(G=>fd(qe(G)))),l(n,["tools"],M)}const _=r(e,["toolConfig"]);if(n!==void 0&&_!=null&&l(n,["toolConfig"],pd(_)),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=r(e,["cachedContent"]);n!==void 0&&w!=null&&l(n,["cachedContent"],xe(t,w));const C=r(e,["responseModalities"]);C!=null&&l(s,["responseModalities"],C);const k=r(e,["mediaResolution"]);k!=null&&l(s,["mediaResolution"],k);const E=r(e,["speechConfig"]);if(E!=null&&l(s,["speechConfig"],on(E)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const S=r(e,["thinkingConfig"]);S!=null&&l(s,["thinkingConfig"],S);const R=r(e,["imageConfig"]);R!=null&&l(s,["imageConfig"],qc(R));const U=r(e,["enableEnhancedCivicAnswers"]);return U!=null&&l(s,["enableEnhancedCivicAnswers"],U),s}function xc(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],Z(i));const a=r(e,["temperature"]);a!=null&&l(s,["temperature"],a);const c=r(e,["topP"]);c!=null&&l(s,["topP"],c);const d=r(e,["topK"]);d!=null&&l(s,["topK"],d);const p=r(e,["candidateCount"]);p!=null&&l(s,["candidateCount"],p);const u=r(e,["maxOutputTokens"]);u!=null&&l(s,["maxOutputTokens"],u);const f=r(e,["stopSequences"]);f!=null&&l(s,["stopSequences"],f);const m=r(e,["responseLogprobs"]);m!=null&&l(s,["responseLogprobs"],m);const h=r(e,["logprobs"]);h!=null&&l(s,["logprobs"],h);const g=r(e,["presencePenalty"]);g!=null&&l(s,["presencePenalty"],g);const x=r(e,["frequencyPenalty"]);x!=null&&l(s,["frequencyPenalty"],x);const y=r(e,["seed"]);y!=null&&l(s,["seed"],y);const v=r(e,["responseMimeType"]);v!=null&&l(s,["responseMimeType"],v);const b=r(e,["responseSchema"]);b!=null&&l(s,["responseSchema"],sn(b));const I=r(e,["responseJsonSchema"]);I!=null&&l(s,["responseJsonSchema"],I);const N=r(e,["routingConfig"]);N!=null&&l(s,["routingConfig"],N);const A=r(e,["modelSelectionConfig"]);A!=null&&l(s,["modelConfig"],A);const _=r(e,["safetySettings"]);if(n!==void 0&&_!=null){let F=_;Array.isArray(F)&&(F=F.map(V=>V)),l(n,["safetySettings"],F)}const w=r(e,["tools"]);if(n!==void 0&&w!=null){let F=Oe(w);Array.isArray(F)&&(F=F.map(V=>Io(qe(V)))),l(n,["tools"],F)}const C=r(e,["toolConfig"]);n!==void 0&&C!=null&&l(n,["toolConfig"],C);const k=r(e,["labels"]);n!==void 0&&k!=null&&l(n,["labels"],k);const E=r(e,["cachedContent"]);n!==void 0&&E!=null&&l(n,["cachedContent"],xe(t,E));const S=r(e,["responseModalities"]);S!=null&&l(s,["responseModalities"],S);const R=r(e,["mediaResolution"]);R!=null&&l(s,["mediaResolution"],R);const U=r(e,["speechConfig"]);U!=null&&l(s,["speechConfig"],on(U));const M=r(e,["audioTimestamp"]);M!=null&&l(s,["audioTimestamp"],M);const G=r(e,["thinkingConfig"]);G!=null&&l(s,["thinkingConfig"],G);const z=r(e,["imageConfig"]);if(z!=null&&l(s,["imageConfig"],Oc(z)),r(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}function Ms(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let c=ie(i);Array.isArray(c)&&(c=c.map(d=>St(d))),l(n,["contents"],c)}const a=r(e,["config"]);return a!=null&&l(n,["generationConfig"],gc(t,a,n)),n}function Ps(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["contents"]);if(i!=null){let c=ie(i);Array.isArray(c)&&(c=c.map(d=>d)),l(n,["contents"],c)}const a=r(e,["config"]);return a!=null&&l(n,["generationConfig"],xc(t,a,n)),n}function Ls(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(u=>Vl(u))),l(e,["candidates"],p)}const i=r(t,["modelVersion"]);i!=null&&l(e,["modelVersion"],i);const a=r(t,["promptFeedback"]);a!=null&&l(e,["promptFeedback"],a);const c=r(t,["responseId"]);c!=null&&l(e,["responseId"],c);const d=r(t,["usageMetadata"]);return d!=null&&l(e,["usageMetadata"],d),e}function js(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(f=>f)),l(e,["candidates"],u)}const i=r(t,["createTime"]);i!=null&&l(e,["createTime"],i);const a=r(t,["modelVersion"]);a!=null&&l(e,["modelVersion"],a);const c=r(t,["promptFeedback"]);c!=null&&l(e,["promptFeedback"],c);const d=r(t,["responseId"]);d!=null&&l(e,["responseId"],d);const p=r(t,["usageMetadata"]);return p!=null&&l(e,["usageMetadata"],p),e}function vc(t,e){const n={};if(r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&l(e,["parameters","sampleCount"],s);const i=r(t,["aspectRatio"]);e!==void 0&&i!=null&&l(e,["parameters","aspectRatio"],i);const a=r(t,["guidanceScale"]);if(e!==void 0&&a!=null&&l(e,["parameters","guidanceScale"],a),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&l(e,["parameters","safetySetting"],c);const d=r(t,["personGeneration"]);e!==void 0&&d!=null&&l(e,["parameters","personGeneration"],d);const p=r(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&l(e,["parameters","includeSafetyAttributes"],p);const u=r(t,["includeRaiReason"]);e!==void 0&&u!=null&&l(e,["parameters","includeRaiReason"],u);const f=r(t,["language"]);e!==void 0&&f!=null&&l(e,["parameters","language"],f);const m=r(t,["outputMimeType"]);e!==void 0&&m!=null&&l(e,["parameters","outputOptions","mimeType"],m);const h=r(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&l(e,["parameters","outputOptions","compressionQuality"],h),r(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=r(t,["imageSize"]);if(e!==void 0&&g!=null&&l(e,["parameters","sampleImageSize"],g),r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function yc(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&l(e,["parameters","storageUri"],s);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&l(e,["parameters","negativePrompt"],i);const a=r(t,["numberOfImages"]);e!==void 0&&a!=null&&l(e,["parameters","sampleCount"],a);const c=r(t,["aspectRatio"]);e!==void 0&&c!=null&&l(e,["parameters","aspectRatio"],c);const d=r(t,["guidanceScale"]);e!==void 0&&d!=null&&l(e,["parameters","guidanceScale"],d);const p=r(t,["seed"]);e!==void 0&&p!=null&&l(e,["parameters","seed"],p);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&l(e,["parameters","safetySetting"],u);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=r(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&l(e,["parameters","includeSafetyAttributes"],m);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&l(e,["parameters","includeRaiReason"],h);const g=r(t,["language"]);e!==void 0&&g!=null&&l(e,["parameters","language"],g);const x=r(t,["outputMimeType"]);e!==void 0&&x!=null&&l(e,["parameters","outputOptions","mimeType"],x);const y=r(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&l(e,["parameters","outputOptions","compressionQuality"],y);const v=r(t,["addWatermark"]);e!==void 0&&v!=null&&l(e,["parameters","addWatermark"],v);const b=r(t,["labels"]);e!==void 0&&b!=null&&l(e,["labels"],b);const I=r(t,["imageSize"]);e!==void 0&&I!=null&&l(e,["parameters","sampleImageSize"],I);const N=r(t,["enhancePrompt"]);return e!==void 0&&N!=null&&l(e,["parameters","enhancePrompt"],N),n}function bc(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const a=r(e,["config"]);return a!=null&&vc(a,n),n}function Nc(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const a=r(e,["config"]);return a!=null&&yc(a,n),n}function wc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>Lc(c))),l(e,["generatedImages"],a)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&l(e,["positivePromptSafetyAttributes"],To(i)),e}function Sc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>Ct(c))),l(e,["generatedImages"],a)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&l(e,["positivePromptSafetyAttributes"],_o(i)),e}function Cc(t,e){const n={},s=r(t,["numberOfVideos"]);if(e!==void 0&&s!=null&&l(e,["parameters","sampleCount"],s),r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=r(t,["durationSeconds"]);if(e!==void 0&&i!=null&&l(e,["parameters","durationSeconds"],i),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=r(t,["aspectRatio"]);e!==void 0&&a!=null&&l(e,["parameters","aspectRatio"],a);const c=r(t,["resolution"]);e!==void 0&&c!=null&&l(e,["parameters","resolution"],c);const d=r(t,["personGeneration"]);if(e!==void 0&&d!=null&&l(e,["parameters","personGeneration"],d),r(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const p=r(t,["negativePrompt"]);e!==void 0&&p!=null&&l(e,["parameters","negativePrompt"],p);const u=r(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&l(e,["parameters","enhancePrompt"],u),r(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=r(t,["lastFrame"]);e!==void 0&&f!=null&&l(e,["instances[0]","lastFrame"],Et(f));const m=r(t,["referenceImages"]);if(e!==void 0&&m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>Td(g))),l(e,["instances[0]","referenceImages"],h)}if(r(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(r(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Ec(t,e){const n={},s=r(t,["numberOfVideos"]);e!==void 0&&s!=null&&l(e,["parameters","sampleCount"],s);const i=r(t,["outputGcsUri"]);e!==void 0&&i!=null&&l(e,["parameters","storageUri"],i);const a=r(t,["fps"]);e!==void 0&&a!=null&&l(e,["parameters","fps"],a);const c=r(t,["durationSeconds"]);e!==void 0&&c!=null&&l(e,["parameters","durationSeconds"],c);const d=r(t,["seed"]);e!==void 0&&d!=null&&l(e,["parameters","seed"],d);const p=r(t,["aspectRatio"]);e!==void 0&&p!=null&&l(e,["parameters","aspectRatio"],p);const u=r(t,["resolution"]);e!==void 0&&u!=null&&l(e,["parameters","resolution"],u);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=r(t,["pubsubTopic"]);e!==void 0&&m!=null&&l(e,["parameters","pubsubTopic"],m);const h=r(t,["negativePrompt"]);e!==void 0&&h!=null&&l(e,["parameters","negativePrompt"],h);const g=r(t,["enhancePrompt"]);e!==void 0&&g!=null&&l(e,["parameters","enhancePrompt"],g);const x=r(t,["generateAudio"]);e!==void 0&&x!=null&&l(e,["parameters","generateAudio"],x);const y=r(t,["lastFrame"]);e!==void 0&&y!=null&&l(e,["instances[0]","lastFrame"],pe(y));const v=r(t,["referenceImages"]);if(e!==void 0&&v!=null){let N=v;Array.isArray(N)&&(N=N.map(A=>_d(A))),l(e,["instances[0]","referenceImages"],N)}const b=r(t,["mask"]);e!==void 0&&b!=null&&l(e,["instances[0]","mask"],Ed(b));const I=r(t,["compressionQuality"]);return e!==void 0&&I!=null&&l(e,["parameters","compressionQuality"],I),n}function Tc(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response","generateVideoResponse"]);return c!=null&&l(e,["response"],kc(c)),e}function _c(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response"]);return c!=null&&l(e,["response"],Rc(c)),e}function Ic(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const a=r(e,["image"]);a!=null&&l(n,["instances[0]","image"],Et(a));const c=r(e,["video"]);c!=null&&l(n,["instances[0]","video"],Ao(c));const d=r(e,["source"]);d!=null&&Mc(d,n);const p=r(e,["config"]);return p!=null&&Cc(p,n),n}function Ac(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const a=r(e,["image"]);a!=null&&l(n,["instances[0]","image"],pe(a));const c=r(e,["video"]);c!=null&&l(n,["instances[0]","video"],ko(c));const d=r(e,["source"]);d!=null&&Pc(d,n);const p=r(e,["config"]);return p!=null&&Ec(p,n),n}function kc(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Dc(c))),l(e,["generatedVideos"],a)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&l(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function Rc(t){const e={},n=r(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Uc(c))),l(e,["generatedVideos"],a)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&l(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function Mc(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&l(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&l(e,["instances[0]","image"],Et(i));const a=r(t,["video"]);return e!==void 0&&a!=null&&l(e,["instances[0]","video"],Ao(a)),n}function Pc(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&l(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&l(e,["instances[0]","image"],pe(i));const a=r(t,["video"]);return e!==void 0&&a!=null&&l(e,["instances[0]","video"],ko(a)),n}function Lc(t){const e={},n=r(t,["_self"]);n!=null&&l(e,["image"],$c(n));const s=r(t,["raiFilteredReason"]);s!=null&&l(e,["raiFilteredReason"],s);const i=r(t,["_self"]);return i!=null&&l(e,["safetyAttributes"],To(i)),e}function Ct(t){const e={},n=r(t,["_self"]);n!=null&&l(e,["image"],Eo(n));const s=r(t,["raiFilteredReason"]);s!=null&&l(e,["raiFilteredReason"],s);const i=r(t,["_self"]);i!=null&&l(e,["safetyAttributes"],_o(i));const a=r(t,["prompt"]);return a!=null&&l(e,["enhancedPrompt"],a),e}function jc(t){const e={},n=r(t,["_self"]);n!=null&&l(e,["mask"],Eo(n));const s=r(t,["labels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),l(e,["labels"],i)}return e}function Dc(t){const e={},n=r(t,["video"]);return n!=null&&l(e,["video"],Sd(n)),e}function Uc(t){const e={},n=r(t,["_self"]);return n!=null&&l(e,["video"],Cd(n)),e}function Fc(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&l(e,["modelConfig"],n);const s=r(t,["responseJsonSchema"]);s!=null&&l(e,["responseJsonSchema"],s);const i=r(t,["audioTimestamp"]);i!=null&&l(e,["audioTimestamp"],i);const a=r(t,["candidateCount"]);a!=null&&l(e,["candidateCount"],a);const c=r(t,["enableAffectiveDialog"]);c!=null&&l(e,["enableAffectiveDialog"],c);const d=r(t,["frequencyPenalty"]);d!=null&&l(e,["frequencyPenalty"],d);const p=r(t,["logprobs"]);p!=null&&l(e,["logprobs"],p);const u=r(t,["maxOutputTokens"]);u!=null&&l(e,["maxOutputTokens"],u);const f=r(t,["mediaResolution"]);f!=null&&l(e,["mediaResolution"],f);const m=r(t,["presencePenalty"]);m!=null&&l(e,["presencePenalty"],m);const h=r(t,["responseLogprobs"]);h!=null&&l(e,["responseLogprobs"],h);const g=r(t,["responseMimeType"]);g!=null&&l(e,["responseMimeType"],g);const x=r(t,["responseModalities"]);x!=null&&l(e,["responseModalities"],x);const y=r(t,["responseSchema"]);y!=null&&l(e,["responseSchema"],y);const v=r(t,["routingConfig"]);v!=null&&l(e,["routingConfig"],v);const b=r(t,["seed"]);b!=null&&l(e,["seed"],b);const I=r(t,["speechConfig"]);I!=null&&l(e,["speechConfig"],I);const N=r(t,["stopSequences"]);N!=null&&l(e,["stopSequences"],N);const A=r(t,["temperature"]);A!=null&&l(e,["temperature"],A);const _=r(t,["thinkingConfig"]);_!=null&&l(e,["thinkingConfig"],_);const w=r(t,["topK"]);w!=null&&l(e,["topK"],w);const C=r(t,["topP"]);if(C!=null&&l(e,["topP"],C),r(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Vc(t,e){const n={},s=r(e,["model"]);return s!=null&&l(n,["_url","name"],J(t,s)),n}function Gc(t,e){const n={},s=r(e,["model"]);return s!=null&&l(n,["_url","name"],J(t,s)),n}function Hc(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Bc(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function qc(t){const e={},n=r(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const s=r(t,["imageSize"]);if(s!=null&&l(e,["imageSize"],s),r(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(r(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(r(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Oc(t){const e={},n=r(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const s=r(t,["imageSize"]);s!=null&&l(e,["imageSize"],s);const i=r(t,["personGeneration"]);i!=null&&l(e,["personGeneration"],i);const a=r(t,["outputMimeType"]);a!=null&&l(e,["imageOutputOptions","mimeType"],a);const c=r(t,["outputCompressionQuality"]);return c!=null&&l(e,["imageOutputOptions","compressionQuality"],c),e}function $c(t){const e={},n=r(t,["bytesBase64Encoded"]);n!=null&&l(e,["imageBytes"],be(n));const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Eo(t){const e={},n=r(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&l(e,["imageBytes"],be(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function Et(t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(t,["imageBytes"]);n!=null&&l(e,["bytesBase64Encoded"],be(n));const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function pe(t){const e={},n=r(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const s=r(t,["imageBytes"]);s!=null&&l(e,["bytesBase64Encoded"],be(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function Jc(t,e,n){const s={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&l(n,["_query","pageSize"],i);const a=r(e,["pageToken"]);n!==void 0&&a!=null&&l(n,["_query","pageToken"],a);const c=r(e,["filter"]);n!==void 0&&c!=null&&l(n,["_query","filter"],c);const d=r(e,["queryBase"]);return n!==void 0&&d!=null&&l(n,["_url","models_url"],vo(t,d)),s}function Wc(t,e,n){const s={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&l(n,["_query","pageSize"],i);const a=r(e,["pageToken"]);n!==void 0&&a!=null&&l(n,["_query","pageToken"],a);const c=r(e,["filter"]);n!==void 0&&c!=null&&l(n,["_query","filter"],c);const d=r(e,["queryBase"]);return n!==void 0&&d!=null&&l(n,["_url","models_url"],vo(t,d)),s}function zc(t,e){const n={},s=r(e,["config"]);return s!=null&&Jc(t,s,n),n}function Kc(t,e){const n={},s=r(e,["config"]);return s!=null&&Wc(t,s,n),n}function Yc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["_self"]);if(i!=null){let a=yo(i);Array.isArray(a)&&(a=a.map(c=>Ot(c))),l(e,["models"],a)}return e}function Xc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["_self"]);if(i!=null){let a=yo(i);Array.isArray(a)&&(a=a.map(c=>$t(c))),l(e,["models"],a)}return e}function Qc(t){const e={},n=r(t,["maskMode"]);n!=null&&l(e,["maskMode"],n);const s=r(t,["segmentationClasses"]);s!=null&&l(e,["maskClasses"],s);const i=r(t,["maskDilation"]);return i!=null&&l(e,["dilation"],i),e}function Ot(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["displayName"]);s!=null&&l(e,["displayName"],s);const i=r(t,["description"]);i!=null&&l(e,["description"],i);const a=r(t,["version"]);a!=null&&l(e,["version"],a);const c=r(t,["_self"]);c!=null&&l(e,["tunedModelInfo"],md(c));const d=r(t,["inputTokenLimit"]);d!=null&&l(e,["inputTokenLimit"],d);const p=r(t,["outputTokenLimit"]);p!=null&&l(e,["outputTokenLimit"],p);const u=r(t,["supportedGenerationMethods"]);u!=null&&l(e,["supportedActions"],u);const f=r(t,["temperature"]);f!=null&&l(e,["temperature"],f);const m=r(t,["maxTemperature"]);m!=null&&l(e,["maxTemperature"],m);const h=r(t,["topP"]);h!=null&&l(e,["topP"],h);const g=r(t,["topK"]);g!=null&&l(e,["topK"],g);const x=r(t,["thinking"]);return x!=null&&l(e,["thinking"],x),e}function $t(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["displayName"]);s!=null&&l(e,["displayName"],s);const i=r(t,["description"]);i!=null&&l(e,["description"],i);const a=r(t,["versionId"]);a!=null&&l(e,["version"],a);const c=r(t,["deployedModels"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>uc(h))),l(e,["endpoints"],m)}const d=r(t,["labels"]);d!=null&&l(e,["labels"],d);const p=r(t,["_self"]);p!=null&&l(e,["tunedModelInfo"],hd(p));const u=r(t,["defaultCheckpointId"]);u!=null&&l(e,["defaultCheckpointId"],u);const f=r(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(h=>h)),l(e,["checkpoints"],m)}return e}function Zc(t){const e={},n=r(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const s=r(t,["codeExecutionResult"]);s!=null&&l(e,["codeExecutionResult"],s);const i=r(t,["executableCode"]);i!=null&&l(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&l(e,["fileData"],pc(a));const c=r(t,["functionCall"]);c!=null&&l(e,["functionCall"],fc(c));const d=r(t,["functionResponse"]);d!=null&&l(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&l(e,["inlineData"],Fl(p));const u=r(t,["text"]);u!=null&&l(e,["text"],u);const f=r(t,["thought"]);f!=null&&l(e,["thought"],f);const m=r(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const h=r(t,["videoMetadata"]);return h!=null&&l(e,["videoMetadata"],h),e}function ed(t){const e={},n=r(t,["productImage"]);return n!=null&&l(e,["image"],pe(n)),e}function td(t,e){const n={},s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&l(e,["parameters","sampleCount"],s);const i=r(t,["baseSteps"]);e!==void 0&&i!=null&&l(e,["parameters","baseSteps"],i);const a=r(t,["outputGcsUri"]);e!==void 0&&a!=null&&l(e,["parameters","storageUri"],a);const c=r(t,["seed"]);e!==void 0&&c!=null&&l(e,["parameters","seed"],c);const d=r(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&l(e,["parameters","safetySetting"],d);const p=r(t,["personGeneration"]);e!==void 0&&p!=null&&l(e,["parameters","personGeneration"],p);const u=r(t,["addWatermark"]);e!==void 0&&u!=null&&l(e,["parameters","addWatermark"],u);const f=r(t,["outputMimeType"]);e!==void 0&&f!=null&&l(e,["parameters","outputOptions","mimeType"],f);const m=r(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&l(e,["parameters","outputOptions","compressionQuality"],m);const h=r(t,["enhancePrompt"]);e!==void 0&&h!=null&&l(e,["parameters","enhancePrompt"],h);const g=r(t,["labels"]);return e!==void 0&&g!=null&&l(e,["labels"],g),n}function nd(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["source"]);i!=null&&od(i,n);const a=r(e,["config"]);return a!=null&&td(a,n),n}function sd(t){const e={},n=r(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>Ct(i))),l(e,["generatedImages"],s)}return e}function od(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&l(e,["instances[0]","prompt"],s);const i=r(t,["personImage"]);e!==void 0&&i!=null&&l(e,["instances[0]","personImage","image"],pe(i));const a=r(t,["productImages"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>ed(d))),l(e,["instances[0]","productImages"],c)}return n}function id(t){const e={},n=r(t,["referenceImage"]);n!=null&&l(e,["referenceImage"],pe(n));const s=r(t,["referenceId"]);s!=null&&l(e,["referenceId"],s);const i=r(t,["referenceType"]);i!=null&&l(e,["referenceType"],i);const a=r(t,["maskImageConfig"]);a!=null&&l(e,["maskImageConfig"],Qc(a));const c=r(t,["controlImageConfig"]);c!=null&&l(e,["controlImageConfig"],$l(c));const d=r(t,["styleImageConfig"]);d!=null&&l(e,["styleImageConfig"],d);const p=r(t,["subjectImageConfig"]);return p!=null&&l(e,["subjectImageConfig"],p),e}function To(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const s=r(t,["safetyAttributes","scores"]);s!=null&&l(e,["scores"],s);const i=r(t,["contentType"]);return i!=null&&l(e,["contentType"],i),e}function _o(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const s=r(t,["safetyAttributes","scores"]);s!=null&&l(e,["scores"],s);const i=r(t,["contentType"]);return i!=null&&l(e,["contentType"],i),e}function rd(t){const e={},n=r(t,["category"]);if(n!=null&&l(e,["category"],n),r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=r(t,["threshold"]);return s!=null&&l(e,["threshold"],s),e}function ad(t){const e={},n=r(t,["image"]);return n!=null&&l(e,["image"],pe(n)),e}function ld(t,e){const n={},s=r(t,["mode"]);e!==void 0&&s!=null&&l(e,["parameters","mode"],s);const i=r(t,["maxPredictions"]);e!==void 0&&i!=null&&l(e,["parameters","maxPredictions"],i);const a=r(t,["confidenceThreshold"]);e!==void 0&&a!=null&&l(e,["parameters","confidenceThreshold"],a);const c=r(t,["maskDilation"]);e!==void 0&&c!=null&&l(e,["parameters","maskDilation"],c);const d=r(t,["binaryColorThreshold"]);e!==void 0&&d!=null&&l(e,["parameters","binaryColorThreshold"],d);const p=r(t,["labels"]);return e!==void 0&&p!=null&&l(e,["labels"],p),n}function cd(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["source"]);i!=null&&ud(i,n);const a=r(e,["config"]);return a!=null&&ld(a,n),n}function dd(t){const e={},n=r(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>jc(i))),l(e,["generatedMasks"],s)}return e}function ud(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&l(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&l(e,["instances[0]","image"],pe(i));const a=r(t,["scribbleImage"]);return e!==void 0&&a!=null&&l(e,["instances[0]","scribble"],ad(a)),n}function pd(t){const e={},n=r(t,["retrievalConfig"]);n!=null&&l(e,["retrievalConfig"],n);const s=r(t,["functionCallingConfig"]);return s!=null&&l(e,["functionCallingConfig"],mc(s)),e}function fd(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&l(e,["computerUse"],n);const s=r(t,["fileSearch"]);s!=null&&l(e,["fileSearch"],s);const i=r(t,["codeExecution"]);if(i!=null&&l(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=r(t,["functionDeclarations"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}const c=r(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],Hc(c));const d=r(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],Bc(d));const p=r(t,["googleSearchRetrieval"]);p!=null&&l(e,["googleSearchRetrieval"],p);const u=r(t,["urlContext"]);return u!=null&&l(e,["urlContext"],u),e}function Io(t){const e={},n=r(t,["retrieval"]);n!=null&&l(e,["retrieval"],n);const s=r(t,["computerUse"]);if(s!=null&&l(e,["computerUse"],s),r(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(t,["codeExecution"]);i!=null&&l(e,["codeExecution"],i);const a=r(t,["enterpriseWebSearch"]);a!=null&&l(e,["enterpriseWebSearch"],a);const c=r(t,["functionDeclarations"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>hc(h))),l(e,["functionDeclarations"],m)}const d=r(t,["googleMaps"]);d!=null&&l(e,["googleMaps"],d);const p=r(t,["googleSearch"]);p!=null&&l(e,["googleSearch"],p);const u=r(t,["googleSearchRetrieval"]);u!=null&&l(e,["googleSearchRetrieval"],u);const f=r(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function md(t){const e={},n=r(t,["baseModel"]);n!=null&&l(e,["baseModel"],n);const s=r(t,["createTime"]);s!=null&&l(e,["createTime"],s);const i=r(t,["updateTime"]);return i!=null&&l(e,["updateTime"],i),e}function hd(t){const e={},n=r(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&l(e,["baseModel"],n);const s=r(t,["createTime"]);s!=null&&l(e,["createTime"],s);const i=r(t,["updateTime"]);return i!=null&&l(e,["updateTime"],i),e}function gd(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&l(e,["displayName"],s);const i=r(t,["description"]);e!==void 0&&i!=null&&l(e,["description"],i);const a=r(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&l(e,["defaultCheckpointId"],a),n}function xd(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&l(e,["displayName"],s);const i=r(t,["description"]);e!==void 0&&i!=null&&l(e,["description"],i);const a=r(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&l(e,["defaultCheckpointId"],a),n}function vd(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","name"],J(t,s));const i=r(e,["config"]);return i!=null&&gd(i,n),n}function yd(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["config"]);return i!=null&&xd(i,n),n}function bd(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&l(e,["parameters","storageUri"],s);const i=r(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&l(e,["parameters","safetySetting"],i);const a=r(t,["personGeneration"]);e!==void 0&&a!=null&&l(e,["parameters","personGeneration"],a);const c=r(t,["includeRaiReason"]);e!==void 0&&c!=null&&l(e,["parameters","includeRaiReason"],c);const d=r(t,["outputMimeType"]);e!==void 0&&d!=null&&l(e,["parameters","outputOptions","mimeType"],d);const p=r(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&l(e,["parameters","outputOptions","compressionQuality"],p);const u=r(t,["enhanceInputImage"]);e!==void 0&&u!=null&&l(e,["parameters","upscaleConfig","enhanceInputImage"],u);const f=r(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&l(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=r(t,["labels"]);e!==void 0&&m!=null&&l(e,["labels"],m);const h=r(t,["numberOfImages"]);e!==void 0&&h!=null&&l(e,["parameters","sampleCount"],h);const g=r(t,["mode"]);return e!==void 0&&g!=null&&l(e,["parameters","mode"],g),n}function Nd(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["_url","model"],J(t,s));const i=r(e,["image"]);i!=null&&l(n,["instances[0]","image"],pe(i));const a=r(e,["upscaleFactor"]);a!=null&&l(n,["parameters","upscaleConfig","upscaleFactor"],a);const c=r(e,["config"]);return c!=null&&bd(c,n),n}function wd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>Ct(a))),l(e,["generatedImages"],i)}return e}function Sd(t){const e={},n=r(t,["uri"]);n!=null&&l(e,["uri"],n);const s=r(t,["encodedVideo"]);s!=null&&l(e,["videoBytes"],be(s));const i=r(t,["encoding"]);return i!=null&&l(e,["mimeType"],i),e}function Cd(t){const e={},n=r(t,["gcsUri"]);n!=null&&l(e,["uri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&l(e,["videoBytes"],be(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function Ed(t){const e={},n=r(t,["image"]);n!=null&&l(e,["_self"],pe(n));const s=r(t,["maskMode"]);return s!=null&&l(e,["maskMode"],s),e}function Td(t){const e={},n=r(t,["image"]);n!=null&&l(e,["image"],Et(n));const s=r(t,["referenceType"]);return s!=null&&l(e,["referenceType"],s),e}function _d(t){const e={},n=r(t,["image"]);n!=null&&l(e,["image"],pe(n));const s=r(t,["referenceType"]);return s!=null&&l(e,["referenceType"],s),e}function Ao(t){const e={},n=r(t,["uri"]);n!=null&&l(e,["uri"],n);const s=r(t,["videoBytes"]);s!=null&&l(e,["encodedVideo"],be(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["encoding"],i),e}function ko(t){const e={},n=r(t,["uri"]);n!=null&&l(e,["gcsUri"],n);const s=r(t,["videoBytes"]);s!=null&&l(e,["bytesBase64Encoded"],be(s));const i=r(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Id(t,e){const n={},s=r(t,["displayName"]);return e!==void 0&&s!=null&&l(e,["displayName"],s),n}function Ad(t){const e={},n=r(t,["config"]);return n!=null&&Id(n,e),e}function kd(t,e){const n={},s=r(t,["force"]);return e!==void 0&&s!=null&&l(e,["_query","force"],s),n}function Rd(t){const e={},n=r(t,["name"]);n!=null&&l(e,["_url","name"],n);const s=r(t,["config"]);return s!=null&&kd(s,e),e}function Md(t){const e={},n=r(t,["name"]);return n!=null&&l(e,["_url","name"],n),e}function Pd(t,e){const n={},s=r(t,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["customMetadata"],a)}const i=r(t,["chunkingConfig"]);return e!==void 0&&i!=null&&l(e,["chunkingConfig"],i),n}function Ld(t){const e={},n=r(t,["name"]);n!=null&&l(e,["name"],n);const s=r(t,["metadata"]);s!=null&&l(e,["metadata"],s);const i=r(t,["done"]);i!=null&&l(e,["done"],i);const a=r(t,["error"]);a!=null&&l(e,["error"],a);const c=r(t,["response"]);return c!=null&&l(e,["response"],Dd(c)),e}function jd(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&l(e,["_url","file_search_store_name"],n);const s=r(t,["fileName"]);s!=null&&l(e,["fileName"],s);const i=r(t,["config"]);return i!=null&&Pd(i,e),e}function Dd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["parent"]);s!=null&&l(e,["parent"],s);const i=r(t,["documentName"]);return i!=null&&l(e,["documentName"],i),e}function Ud(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function Fd(t){const e={},n=r(t,["config"]);return n!=null&&Ud(n,e),e}function Vd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["fileSearchStores"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["fileSearchStores"],a)}return e}function Ro(t,e){const n={},s=r(t,["mimeType"]);e!==void 0&&s!=null&&l(e,["mimeType"],s);const i=r(t,["displayName"]);e!==void 0&&i!=null&&l(e,["displayName"],i);const a=r(t,["customMetadata"]);if(e!==void 0&&a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>p)),l(e,["customMetadata"],d)}const c=r(t,["chunkingConfig"]);return e!==void 0&&c!=null&&l(e,["chunkingConfig"],c),n}function Gd(t){const e={},n=r(t,["fileSearchStoreName"]);n!=null&&l(e,["_url","file_search_store_name"],n);const s=r(t,["config"]);return s!=null&&Ro(s,e),e}function Hd(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bd="Content-Type",qd="X-Server-Timeout",Od="User-Agent",Jt="x-goog-api-client",$d="1.35.0",Jd=`google-genai-sdk/${$d}`,Wd="v1beta1",zd="v1beta";class Kd{constructor(e){var n,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Wd,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:zd,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,s){const i=[this.getRequestUrlInternal(n)];return s&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);if(e.queryParams)for(const[c,d]of Object.entries(e.queryParams))i.searchParams.append(c,String(d));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,n,i.toString(),e.abortSignal),this.unaryApiCall(i,a,e.httpMethod)}patchHttpOptions(e,n){const s=JSON.parse(JSON.stringify(e));for(const[i,a]of Object.entries(n))typeof a=="object"?s[i]=Object.assign(Object.assign({},s[i]),a):a!==void 0&&(s[i]=a);return s}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,n,i.toString(),e.abortSignal),this.streamApiCall(i,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,s,i){if(n&&n.timeout||i){const a=new AbortController,c=a.signal;if(n.timeout&&n?.timeout>0){const d=setTimeout(()=>a.abort(),n.timeout);d&&typeof d.unref=="function"&&d.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=c}return n&&n.extraBody!==null&&Yd(e,n.extraBody),e.headers=await this.getHeadersInternal(n,s),e}async unaryApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await Ds(i),new Ht(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await Ds(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return de(this,arguments,function*(){var s;const i=(s=e?.body)===null||s===void 0?void 0:s.getReader(),a=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let c="";const d="data:",p=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:u,value:f}=yield H(i.read());if(u){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=a.decode(f,{stream:!0});try{const x=JSON.parse(m);if("error"in x){const y=JSON.parse(JSON.stringify(x.error)),v=y.status,b=y.code,I=`got status: ${v}. ${JSON.stringify(x)}`;if(b>=400&&b<600)throw new wt({message:I,status:b})}}catch(x){if(x.name==="ApiError")throw x}c+=m;let h=-1,g=0;for(;;){h=-1,g=0;for(const v of p){const b=c.indexOf(v);b!==-1&&(h===-1||b<h)&&(h=b,g=v.length)}if(h===-1)break;const x=c.substring(0,h);c=c.substring(h+g);const y=x.trim();if(y.startsWith(d)){const v=y.substring(d.length).trim();try{const b=new Response(v,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield H(new Ht(b))}catch(b){throw new Error(`exception parsing stream chunk ${v}. ${b}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},n=Jd+" "+this.clientOptions.userAgentExtra;return e[Od]=n,e[Jt]=n,e[Bd]="application/json",e}async getHeadersInternal(e,n){const s=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))s.append(i,a);e.timeout&&e.timeout>0&&s.append(qd,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s,n),s}getFileName(e){var n;let s="";return typeof e=="string"&&(s=e.replace(/[/\\]+$/,""),s=(n=s.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),s}async uploadFile(e,n){var s;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const a=this.clientOptions.uploader,c=await a.stat(e);i.sizeBytes=String(c.size);const d=(s=n?.mimeType)!==null&&s!==void 0?s:c.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=d;const p={file:i},u=this.getFileName(e),f=P("upload/v1beta/files",p._url),m=await this.fetchUploadUrl(f,i.sizeBytes,i.mimeType,u,p,n?.httpOptions);return a.upload(e,m,this)}async uploadFileToFileSearchStore(e,n,s){var i;const a=this.clientOptions.uploader,c=await a.stat(n),d=String(c.size),p=(i=s?.mimeType)!==null&&i!==void 0?i:c.type;if(p===void 0||p==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),m={};s!=null&&Ro(s,m);const h=await this.fetchUploadUrl(u,d,p,f,m,s?.httpOptions);return a.uploadToFileSearchStore(n,h,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,s,i,a,c){var d;let p={};c?p=c:p={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${s}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:p});if(!u||!u?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(d=u?.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function Ds(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(s);throw n>=400&&n<600?new wt({message:i,status:n}):new Error(i)}}function Yd(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const a=JSON.parse(t.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))n=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(a,c){const d=Object.assign({},a);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const u=c[p],f=d[p];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?d[p]=s(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),d[p]=u)}return d}const i=s(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xd="mcp_used/unknown";let Qd=!1;function Mo(t){for(const e of t)if(Zd(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Qd}function Po(t){var e;const n=(e=t[Jt])!==null&&e!==void 0?e:"";t[Jt]=(n+` ${Xd}`).trimStart()}function Zd(t){return t!==null&&typeof t=="object"&&t instanceof an}function eu(t){return de(this,arguments,function*(n,s=100){let i,a=0;for(;a<s;){const c=yield H(n.listTools({cursor:i}));for(const d of c.tools)yield yield H(d),a++;if(!c.nextCursor)break;i=c.nextCursor}})}class an{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new an(e,n)}async initialize(){var e,n,s,i;if(this.mcpTools.length>0)return;const a={},c=[];for(const f of this.mcpClients)try{for(var d=!0,p=(n=void 0,ue(eu(f))),u;u=await p.next(),e=u.done,!e;d=!0){i=u.value,d=!1;const m=i;c.push(m);const h=m.name;if(a[h])throw new Error(`Duplicate function name ${h} found in MCP tools. Please ensure function names are unique.`);a[h]=f}}catch(m){n={error:m}}finally{try{!d&&!e&&(s=p.return)&&await s.call(p)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),Mr(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[s.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const c=await i.callTool({name:s.name,arguments:s.args},void 0,a);n.push({functionResponse:{name:s.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function tu(t,e,n){const s=new Cr;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(s,i),e(s)}class nu{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s}async connect(e){var n,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),c=iu(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),p=`${i}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${d}`;let u=()=>{};const f=new Promise(N=>{u=N}),m=e.callbacks,h=function(){u({})},g=this.apiClient,x={onopen:h,onmessage:N=>{tu(g,m.onmessage,N)},onerror:(n=m?.onerror)!==null&&n!==void 0?n:function(N){},onclose:(s=m?.onclose)!==null&&s!==void 0?s:function(N){}},y=this.webSocketFactory.create(p,ou(c),x);y.connect(),await f;const I={setup:{model:J(this.apiClient,e.model)}};return y.send(JSON.stringify(I)),new su(y,this.apiClient)}}class su{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Al(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Il(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Fe.PLAY)}pause(){this.sendPlaybackControl(Fe.PAUSE)}stop(){this.sendPlaybackControl(Fe.STOP)}resetContext(){this.sendPlaybackControl(Fe.RESET_CONTEXT)}close(){this.conn.close()}}function ou(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function iu(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ru="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function au(t,e,n){const s=new Sr;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const a=JSON.parse(i);if(t.isVertexAI()){const c=Ml(a);Object.assign(s,c)}else Object.assign(s,a);e(s)}class lu{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s,this.music=new nu(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,s,i,a,c,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const p=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&Mo(e.config.tools)&&Po(m);const h=pu(m);if(this.apiClient.isVertexAI())f=`${p}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h,f);else{const E=this.apiClient.getApiKey();let S="BidiGenerateContent",R="key";E?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),S="BidiGenerateContentConstrained",R="access_token"),f=`${p}/ws/google.ai.generativelanguage.${u}.GenerativeService.${S}?${R}=${E}`}let g=()=>{};const x=new Promise(E=>{g=E}),y=e.callbacks,v=function(){var E;(E=y?.onopen)===null||E===void 0||E.call(y),g({})},b=this.apiClient,I={onopen:v,onmessage:E=>{au(b,y.onmessage,E)},onerror:(n=y?.onerror)!==null&&n!==void 0?n:function(E){},onclose:(s=y?.onclose)!==null&&s!==void 0?s:function(E){}},N=this.webSocketFactory.create(f,uu(h),I);N.connect(),await x;let A=J(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&A.startsWith("publishers/")){const E=this.apiClient.getProject(),S=this.apiClient.getLocation();A=`projects/${E}/locations/${S}/`+A}let _={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[pt.AUDIO]}:e.config.responseModalities=[pt.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const w=(d=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[],C=[];for(const E of w)if(this.isCallableTool(E)){const S=E;C.push(await S.tool())}else C.push(E);C.length>0&&(e.config.tools=C);const k={model:A,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=_l(this.apiClient,k):_=Tl(this.apiClient,k),delete _.config,N.send(JSON.stringify(_)),new du(N,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const cu={turnComplete:!0};class du{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let s=[];try{s=ie(n.turns),e.isVertexAI()||(s=s.map(i=>St(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:s,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let s=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?s=n.functionResponses:s=[n.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const a of s){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(ru)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},cu),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Rl(e)}:n={realtimeInput:kl(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function uu(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function pu(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Us=10;function Fs(t){var e,n,s;if(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const c of(n=t?.tools)!==null&&n!==void 0?n:[])if(He(c)){i=!0;break}if(!i)return!0;const a=(s=t?.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function He(t){return"callTool"in t&&typeof t.callTool=="function"}function fu(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>He(i)))!==null&&s!==void 0?s:!1}function Vs(t){var e;const n=[];return!((e=t?.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((s,i)=>{if(He(s))return;const a=s;a.functionDeclarations&&a.functionDeclarations.length>0&&n.push(i)}),n}function Gs(t){var e;return!(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mu extends ge{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var s,i,a,c,d;const p=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!fu(n)||Fs(n.config))return await this.generateContentInternal(p);const u=Vs(n);if(u.length>0){const y=u.map(v=>`tools[${v}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${y}.`)}let f,m;const h=ie(p.contents),g=(a=(i=(s=p.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:Us;let x=0;for(;x<g&&(f=await this.generateContentInternal(p),!(!f.functionCalls||f.functionCalls.length===0));){const y=f.candidates[0].content,v=[];for(const b of(d=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[])if(He(b)){const N=await b.callTool(f.functionCalls);v.push(...N)}x++,m={role:"user",parts:v},p.contents=ie(p.contents),p.contents.push(y),p.contents.push(m),Gs(p.config)&&(h.push(y),h.push(m))}return Gs(p.config)&&(f.automaticFunctionCallingHistory=h),f},this.generateContentStream=async n=>{var s,i,a,c,d;if(this.maybeMoveToResponseJsonSchem(n),Fs(n.config)){const m=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(m)}const p=Vs(n);if(p.length>0){const m=p.map(h=>`tools[${h}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(a=(i=(s=n?.config)===null||s===void 0?void 0:s.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,f=(d=(c=n?.config)===null||c===void 0?void 0:c.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(u&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(s=>{var i;let a;const c=[];if(s?.generatedImages)for(const p of s.generatedImages)p&&p?.safetyAttributes&&((i=p?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?a=p?.safetyAttributes:c.push(p);let d;return a?d={generatedImages:c,positivePromptSafetyAttributes:a,sdkHttpResponse:s.sdkHttpResponse}:d={generatedImages:c,sdkHttpResponse:s.sdkHttpResponse},d}),this.list=async n=>{var s;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n?.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((s=c.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new ke(he.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(c),c)},this.editImage=async n=>{const s={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(s.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async n=>{let s={numberOfImages:1,mode:"upscale"};n.config&&(s=Object.assign(Object.assign({},s),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:s};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var s,i,a,c,d,p;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=n.video)===null||s===void 0)&&s.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.uri&&(!((p=(d=n.source)===null||d===void 0?void 0:d.video)===null||p===void 0)&&p.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,s,i;const a=(n=e.config)===null||n===void 0?void 0:n.tools;if(!a)return e;const c=await Promise.all(a.map(async p=>He(p)?await p.tool():p)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(d.config.tools=c,e.config&&e.config.tools&&Mo(e.config.tools)){const p=(i=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},p);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Po(u),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return d}async initAfcToolsMap(e){var n,s,i;const a=new Map;for(const c of(s=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&s!==void 0?s:[])if(He(c)){const d=c,p=await d.tool();for(const u of(i=p.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(a.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);a.set(u.name,d)}}return a}async processAfcStream(e){var n,s,i;const a=(i=(s=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:Us;let c=!1,d=0;const p=await this.initAfcToolsMap(e);return function(u,f,m){return de(this,arguments,function*(){for(var h,g,x,y,v,b;d<a;){c&&(d++,c=!1);const _=yield H(u.processParamsMaybeAddMcpUsage(m)),w=yield H(u.generateContentStreamInternal(_)),C=[],k=[];try{for(var I=!0,N=(g=void 0,ue(w)),A;A=yield H(N.next()),h=A.done,!h;I=!0){y=A.value,I=!1;const E=y;if(yield yield H(E),E.candidates&&(!((v=E.candidates[0])===null||v===void 0)&&v.content)){k.push(E.candidates[0].content);for(const S of(b=E.candidates[0].content.parts)!==null&&b!==void 0?b:[])if(d<a&&S.functionCall){if(!S.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(S.functionCall.name)){const R=yield H(f.get(S.functionCall.name).callTool([S.functionCall]));C.push(...R)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${S.functionCall.name}`)}}}}catch(E){g={error:E}}finally{try{!I&&!h&&(x=N.return)&&(yield H(x.call(N)))}finally{if(g)throw g.error}}if(C.length>0){c=!0;const E=new ze;E.candidates=[{content:{role:"user",parts:C}}],yield yield H(E);const S=[];S.push(...k),S.push({role:"user",parts:C});const R=ie(m.contents).concat(S);m.contents=R}else break}})}(this,p,e)}async generateContentInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ps(this.apiClient,e);return d=P("{model}:generateContent",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=js(f),h=new ze;return Object.assign(h,m),h})}else{const u=Ms(this.apiClient,e);return d=P("{model}:generateContent",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Ls(f),h=new ze;return Object.assign(h,m),h})}}async generateContentStreamInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ps(this.apiClient,e);return d=P("{model}:streamGenerateContent?alt=sse",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),c.then(function(m){return de(this,arguments,function*(){var h,g,x,y;try{for(var v=!0,b=ue(m),I;I=yield H(b.next()),h=I.done,!h;v=!0){y=I.value,v=!1;const N=y,A=js(yield H(N.json()));A.sdkHttpResponse={headers:N.headers};const _=new ze;Object.assign(_,A),yield yield H(_)}}catch(N){g={error:N}}finally{try{!v&&!h&&(x=b.return)&&(yield H(x.call(b)))}finally{if(g)throw g.error}}})})}else{const u=Ms(this.apiClient,e);return d=P("{model}:streamGenerateContent?alt=sse",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),c.then(function(m){return de(this,arguments,function*(){var h,g,x,y;try{for(var v=!0,b=ue(m),I;I=yield H(b.next()),h=I.done,!h;v=!0){y=I.value,v=!1;const N=y,A=Ls(yield H(N.json()));A.sdkHttpResponse={headers:N.headers};const _=new ze;Object.assign(_,A),yield yield H(_)}}catch(N){g={error:N}}finally{try{!v&&!h&&(x=b.return)&&(yield H(x.call(b)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=lc(this.apiClient,e);return d=P("{model}:predict",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=dc(f),h=new hs;return Object.assign(h,m),h})}else{const u=ac(this.apiClient,e);return d=P("{model}:batchEmbedContents",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=cc(f),h=new hs;return Object.assign(h,m),h})}}async generateImagesInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Nc(this.apiClient,e);return d=P("{model}:predict",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Sc(f),h=new gs;return Object.assign(h,m),h})}else{const u=bc(this.apiClient,e);return d=P("{model}:predict",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=wc(f),h=new gs;return Object.assign(h,m),h})}}async editImageInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=sc(this.apiClient,e);return a=P("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>{const u=oc(p),f=new pr;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=Nd(this.apiClient,e);return a=P("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>{const u=wd(p),f=new fr;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=nd(this.apiClient,e);return a=P("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=sd(p),f=new mr;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=cd(this.apiClient,e);return a=P("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=dd(p),f=new hr;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Gc(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>$t(f))}else{const u=Vc(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>Ot(f))}}async listInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Kc(this.apiClient,e);return d=P("{models_url}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Xc(f),h=new xs;return Object.assign(h,m),h})}else{const u=zc(this.apiClient,e);return d=P("{models_url}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Yc(f),h=new xs;return Object.assign(h,m),h})}}async update(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=yd(this.apiClient,e);return d=P("{model}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>$t(f))}else{const u=vd(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>Ot(f))}}async delete(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Zl(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=tc(f),h=new vs;return Object.assign(h,m),h})}else{const u=Ql(this.apiClient,e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=ec(f),h=new vs;return Object.assign(h,m),h})}}async countTokens(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Kl(this.apiClient,e);return d=P("{model}:countTokens",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Xl(f),h=new ys;return Object.assign(h,m),h})}else{const u=zl(this.apiClient,e);return d=P("{model}:countTokens",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Yl(f),h=new ys;return Object.assign(h,m),h})}}async computeTokens(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=Hl(this.apiClient,e);return a=P("{model}:computeTokens",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>{const u=Bl(p),f=new gr;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Ac(this.apiClient,e);return d=P("{model}:predictLongRunning",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c.then(f=>{const m=_c(f),h=new ft;return Object.assign(h,m),h})}else{const u=Ic(this.apiClient,e);return d=P("{model}:predictLongRunning",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c.then(f=>{const m=Tc(f),h=new ft;return Object.assign(h,m),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hu extends ge{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=rr(e);return d=P("{operationName}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),c}else{const u=ir(e);return d=P("{operationName}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json()),c}}async fetchPredictVideosOperationInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=Qi(e);return a=P("{resourceName}:fetchPredictOperation",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gu(t){const e={},n=r(t,["data"]);if(n!=null&&l(e,["data"],n),r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function xu(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(a=>Tu(a))),l(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&l(e,["role"],s),e}function vu(t,e,n){const s={},i=r(e,["expireTime"]);n!==void 0&&i!=null&&l(n,["expireTime"],i);const a=r(e,["newSessionExpireTime"]);n!==void 0&&a!=null&&l(n,["newSessionExpireTime"],a);const c=r(e,["uses"]);n!==void 0&&c!=null&&l(n,["uses"],c);const d=r(e,["liveConnectConstraints"]);n!==void 0&&d!=null&&l(n,["bidiGenerateContentSetup"],Eu(t,d));const p=r(e,["lockAdditionalFields"]);return n!==void 0&&p!=null&&l(n,["fieldMask"],p),s}function yu(t,e){const n={},s=r(e,["config"]);return s!=null&&l(n,["config"],vu(t,s,n)),n}function bu(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Nu(t){const e={},n=r(t,["id"]);n!=null&&l(e,["id"],n);const s=r(t,["args"]);s!=null&&l(e,["args"],s);const i=r(t,["name"]);if(i!=null&&l(e,["name"],i),r(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(r(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function wu(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Su(t){const e={};if(r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(r(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=r(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function Cu(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig"],s);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const a=r(t,["temperature"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","temperature"],a);const c=r(t,["topP"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","topK"],d);const p=r(t,["maxOutputTokens"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","maxOutputTokens"],p);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","mediaResolution"],u);const f=r(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=r(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],rn(m));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","thinkingConfig"],h);const g=r(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=r(t,["systemInstruction"]);e!==void 0&&x!=null&&l(e,["setup","systemInstruction"],xu(Z(x)));const y=r(t,["tools"]);if(e!==void 0&&y!=null){let w=Oe(y);Array.isArray(w)&&(w=w.map(C=>Iu(qe(C)))),l(e,["setup","tools"],w)}const v=r(t,["sessionResumption"]);e!==void 0&&v!=null&&l(e,["setup","sessionResumption"],_u(v));const b=r(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const I=r(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&l(e,["setup","outputAudioTranscription"],I);const N=r(t,["realtimeInputConfig"]);e!==void 0&&N!=null&&l(e,["setup","realtimeInputConfig"],N);const A=r(t,["contextWindowCompression"]);e!==void 0&&A!=null&&l(e,["setup","contextWindowCompression"],A);const _=r(t,["proactivity"]);if(e!==void 0&&_!=null&&l(e,["setup","proactivity"],_),r(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Eu(t,e){const n={},s=r(e,["model"]);s!=null&&l(n,["setup","model"],J(t,s));const i=r(e,["config"]);return i!=null&&l(n,["config"],Cu(i,n)),n}function Tu(t){const e={},n=r(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const s=r(t,["codeExecutionResult"]);s!=null&&l(e,["codeExecutionResult"],s);const i=r(t,["executableCode"]);i!=null&&l(e,["executableCode"],i);const a=r(t,["fileData"]);a!=null&&l(e,["fileData"],bu(a));const c=r(t,["functionCall"]);c!=null&&l(e,["functionCall"],Nu(c));const d=r(t,["functionResponse"]);d!=null&&l(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&l(e,["inlineData"],gu(p));const u=r(t,["text"]);u!=null&&l(e,["text"],u);const f=r(t,["thought"]);f!=null&&l(e,["thought"],f);const m=r(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const h=r(t,["videoMetadata"]);return h!=null&&l(e,["videoMetadata"],h),e}function _u(t){const e={},n=r(t,["handle"]);if(n!=null&&l(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Iu(t){const e={};if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=r(t,["computerUse"]);n!=null&&l(e,["computerUse"],n);const s=r(t,["fileSearch"]);s!=null&&l(e,["fileSearch"],s);const i=r(t,["codeExecution"]);if(i!=null&&l(e,["codeExecution"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=r(t,["functionDeclarations"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}const c=r(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],wu(c));const d=r(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],Su(d));const p=r(t,["googleSearchRetrieval"]);p!=null&&l(e,["googleSearchRetrieval"],p);const u=r(t,["urlContext"]);return u!=null&&l(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Au(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=t[n];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const i=Object.keys(s).map(a=>`${n}.${a}`);e.push(...i)}else e.push(n)}return e.join(",")}function ku(t,e){let n=null;const s=t.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const a=s.setup;typeof a=="object"&&a!==null?(t.bidiGenerateContentSetup=a,n=a):delete t.bidiGenerateContentSetup}else s!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const a=Au(n);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)a?t.fieldMask=a:delete t.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];i.length>0&&(d=i.map(u=>c.includes(u)?`generationConfig.${u}`:u));const p=[];a&&p.push(a),d.length>0&&p.push(...d),p.length>0?t.fieldMask=p.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class Ru extends ge{constructor(e){super(),this.apiClient=e}async create(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=yu(this.apiClient,e);a=P("auth_tokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const p=ku(d,e.config);return i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mu(t,e){const n={},s=r(t,["force"]);return e!==void 0&&s!=null&&l(e,["_query","force"],s),n}function Pu(t){const e={},n=r(t,["name"]);n!=null&&l(e,["_url","name"],n);const s=r(t,["config"]);return s!=null&&Mu(s,e),e}function Lu(t){const e={},n=r(t,["name"]);return n!=null&&l(e,["_url","name"],n),e}function ju(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function Du(t){const e={},n=r(t,["parent"]);n!=null&&l(e,["_url","parent"],n);const s=r(t,["config"]);return s!=null&&ju(s,e),e}function Uu(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&l(e,["nextPageToken"],s);const i=r(t,["documents"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>c)),l(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fu extends ge{constructor(e){super(),this.apiClient=e,this.list=async n=>new ke(he.PAGED_ITEM_DOCUMENTS,s=>this.listInternal({parent:n.parent,config:s.config}),await this.listInternal(n),n)}async get(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Lu(e);return a=P("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>p)}}async delete(e){var n,s;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Pu(e);i=P("{name}",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Du(e);return a=P("{parent}/documents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=Uu(p),f=new xr;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vu extends ge{constructor(e,n=new Fu(e)){super(),this.apiClient=e,this.documents=n,this.list=async(s={})=>new ke(he.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(s),s)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Ad(e);return a=P("fileSearchStores",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>p)}}async get(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Md(e);return a=P("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>p)}}async delete(e){var n,s;let i="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Rd(e);i=P("{name}",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Fd(e);return a=P("fileSearchStores",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=Vd(p),f=new vr;return Object.assign(f,u),f})}}async uploadToFileSearchStoreInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Gd(e);return a=P("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=Hd(p),f=new yr;return Object.assign(f,u),f})}}async importFile(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=jd(e);return a=P("{file_search_store_name}:importFile",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),i.then(p=>{const u=Ld(p),f=new en;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Lo=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return Lo=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};const Gu=()=>Lo();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wt(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const zt=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class re extends Error{}class ne extends re{constructor(e,n,s,i){super(`${ne.makeMessage(e,n,s)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,s){const i=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,s,i){if(!e||!i)return new Tt({message:s,cause:zt(n)});const a=n;return e===400?new Do(e,a,s,i):e===401?new Uo(e,a,s,i):e===403?new Fo(e,a,s,i):e===404?new Vo(e,a,s,i):e===409?new Go(e,a,s,i):e===422?new Ho(e,a,s,i):e===429?new Bo(e,a,s,i):e>=500?new qo(e,a,s,i):new ne(e,a,s,i)}}class Kt extends ne{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Tt extends ne{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class jo extends Tt{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Do extends ne{}class Uo extends ne{}class Fo extends ne{}class Vo extends ne{}class Go extends ne{}class Ho extends ne{}class Bo extends ne{}class qo extends ne{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hu=/^[a-z][a-z0-9+.-]*:/i,Bu=t=>Hu.test(t);let Yt=t=>(Yt=Array.isArray,Yt(t));const qu=Yt;let Ou=qu;const Hs=Ou;function $u(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ju(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Wu=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new re(`${t} must be an integer`);if(e<0)throw new re(`${t} must be a positive integer`);return e},zu=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ku=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ue="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yu(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Xu=()=>{var t,e,n,s,i;const a=Yu();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ue,"X-Stainless-OS":qs(Deno.build.os),"X-Stainless-Arch":Bs(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ue,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ue,"X-Stainless-OS":qs((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":Bs((s=globalThis.process.arch)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const c=Qu();return c?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ue,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${c.browser}`,"X-Stainless-Runtime-Version":c.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ue,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Qu(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const i=s[1]||0,a=s[2]||0,c=s[3]||0;return{browser:e,version:`${i}.${a}.${c}`}}}return null}const Bs=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",qs=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let nt;const Zu=()=>nt??(nt=Xu());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ep(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Oo(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function tp(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Oo({start(){},async pull(n){const{done:s,value:i}=await e.next();s?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function $o(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function np(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const s=t.getReader(),i=s.cancel();s.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sp=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jo=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e?.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Lt(t,e,n){return Jo(),new File(t,e??"unknown_file",n)}function op(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ip=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Wo=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",rp=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Wo(t),ap=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function lp(t,e,n){if(Jo(),t=await t,rp(t))return t instanceof File?t:Lt([await t.arrayBuffer()],t.name);if(ap(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Lt(await Xt(i),e,n)}const s=await Xt(t);if(e||(e=op(t)),!n?.type){const i=s.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return Lt(s,e,n)}async function Xt(t){var e,n,s,i,a;let c=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)c.push(t);else if(Wo(t))c.push(t instanceof Blob?t:await t.arrayBuffer());else if(ip(t))try{for(var d=!0,p=ue(t),u;u=await p.next(),e=u.done,!e;d=!0){i=u.value,d=!1;const f=i;c.push(...await Xt(f))}}catch(f){n={error:f}}finally{try{!d&&!e&&(s=p.return)&&await s.call(p)}finally{if(n)throw n.error}}else{const f=(a=t?.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${cp(t)}`)}return c}function cp(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zo{constructor(e){this._client=e}}zo._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ko(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Os=Object.freeze(Object.create(null)),dp=(t=Ko)=>function(n,...s){if(n.length===1)return n[0];let i=!1;const a=[],c=n.reduce((f,m,h)=>{var g,x,y;/[?#]/.test(m)&&(i=!0);const v=s[h];let b=(i?encodeURIComponent:t)(""+v);return h!==s.length&&(v==null||typeof v=="object"&&v.toString===((y=Object.getPrototypeOf((x=Object.getPrototypeOf((g=v.hasOwnProperty)!==null&&g!==void 0?g:Os))!==null&&x!==void 0?x:Os))===null||y===void 0?void 0:y.toString))&&(b=v+"",a.push({start:f.length+m.length,length:b.length,error:`Value of type ${Object.prototype.toString.call(v).slice(8,-1)} is not a valid path parameter`})),f+m+(h===s.length?"":b)},""),d=c.split(/[?#]/,1)[0],p=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let u;for(;(u=p.exec(d))!==null;)a.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(a.sort((f,m)=>f.start-m.start),a.length>0){let f=0;const m=a.reduce((h,g)=>{const x=" ".repeat(g.start-f),y="^".repeat(g.length);return f=g.start+g.length,h+x+y},"");throw new re(`Path parameters result in path with invalid segments:
${a.map(h=>h.error).join(`
`)}
${c}
${m}`)}return c},st=dp(Ko);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yo extends zo{create(e,n){var s;const{api_version:i=this._client.apiVersion}=e,a=ht(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new re("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new re("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(st`/${i}/interactions`,Object.assign(Object.assign({body:a},n),{stream:(s=e.stream)!==null&&s!==void 0?s:!1}))}delete(e,n={},s){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(st`/${i}/interactions/${e}`,s)}cancel(e,n={},s){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(st`/${i}/interactions/${e}/cancel`,s)}get(e,n={},s){var i;const a=n??{},{api_version:c=this._client.apiVersion}=a,d=ht(a,["api_version"]);return this._client.get(st`/${c}/interactions/${e}`,Object.assign(Object.assign({query:d},s),{stream:(i=n?.stream)!==null&&i!==void 0?i:!1}))}}Yo._key=Object.freeze(["interactions"]);class Xo extends Yo{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function up(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let s=0;for(const i of t)n.set(i,s),s+=i.length;return n}let ot;function ln(t){let e;return(ot??(e=new globalThis.TextEncoder,ot=e.encode.bind(e)))(t)}let it;function $s(t){let e;return(it??(e=new globalThis.TextDecoder,it=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _t{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ln(e):e;this.buffer=up([this.buffer,n]);const s=[];let i;for(;(i=pp(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){s.push($s(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,c=$s(this.buffer.subarray(0,a));s.push(c),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return s}flush(){return this.buffer.length?this.decode(`
`):[]}}_t.NEWLINE_CHARS=new Set([`
`,"\r"]);_t.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function pp(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function fp(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gt={off:0,error:200,warn:300,info:400,debug:500},Js=(t,e,n)=>{if(t){if(Ju(gt,t))return t;te(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(gt))}`)}};function Ye(){}function rt(t,e,n){return!e||gt[t]>gt[n]?Ye:e[t].bind(e)}const mp={error:Ye,warn:Ye,info:Ye,debug:Ye};let Ws=new WeakMap;function te(t){var e;const n=t.logger,s=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return mp;const i=Ws.get(n);if(i&&i[0]===s)return i[1];const a={error:rt("error",n,s),warn:rt("warn",n,s),info:rt("info",n,s),debug:rt("debug",n,s)};return Ws.set(n,[s,a]),a}const _e=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ve{constructor(e,n,s){this.iterator=e,this.controller=n,this.client=s}static fromSSEResponse(e,n,s){let i=!1;const a=s?te(s):console;function c(){return de(this,arguments,function*(){var p,u,f,m;if(i)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var g=!0,x=ue(hp(e,n)),y;y=yield H(x.next()),p=y.done,!p;g=!0){m=y.value,g=!1;const v=m;if(!h)if(v.data.startsWith("[DONE]")){h=!0;continue}else try{yield yield H(JSON.parse(v.data))}catch(b){throw a.error("Could not parse message into JSON:",v.data),a.error("From chunk:",v.raw),b}}}catch(v){u={error:v}}finally{try{!g&&!p&&(f=x.return)&&(yield H(f.call(x)))}finally{if(u)throw u.error}}h=!0}catch(v){if(Wt(v))return yield H(void 0);throw v}finally{h||n.abort()}})}return new Ve(c,n,s)}static fromReadableStream(e,n,s){let i=!1;function a(){return de(this,arguments,function*(){var p,u,f,m;const h=new _t,g=$o(e);try{for(var x=!0,y=ue(g),v;v=yield H(y.next()),p=v.done,!p;x=!0){m=v.value,x=!1;const b=m;for(const I of h.decode(b))yield yield H(I)}}catch(b){u={error:b}}finally{try{!x&&!p&&(f=y.return)&&(yield H(f.call(y)))}finally{if(u)throw u.error}}for(const b of h.flush())yield yield H(b)})}function c(){return de(this,arguments,function*(){var p,u,f,m;if(i)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var g=!0,x=ue(a()),y;y=yield H(x.next()),p=y.done,!p;g=!0){m=y.value,g=!1;const v=m;h||v&&(yield yield H(JSON.parse(v)))}}catch(v){u={error:v}}finally{try{!g&&!p&&(f=x.return)&&(yield H(f.call(x)))}finally{if(u)throw u.error}}h=!0}catch(v){if(Wt(v))return yield H(void 0);throw v}finally{h||n.abort()}})}return new Ve(c,n,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),i=a=>({next:()=>{if(a.length===0){const c=s.next();e.push(c),n.push(c)}return a.shift()}});return[new Ve(()=>i(e),this.controller,this.client),new Ve(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Oo({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await n.next();if(a)return s.close();const c=ln(JSON.stringify(i)+`
`);s.enqueue(c)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)===null||s===void 0?void 0:s.call(n))}})}}function hp(t,e){return de(this,arguments,function*(){var s,i,a,c;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new re("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new re("Attempted to iterate over a response with no body");const d=new xp,p=new _t,u=$o(t.body);try{for(var f=!0,m=ue(gp(u)),h;h=yield H(m.next()),s=h.done,!s;f=!0){c=h.value,f=!1;const g=c;for(const x of p.decode(g)){const y=d.decode(x);y&&(yield yield H(y))}}}catch(g){i={error:g}}finally{try{!f&&!s&&(a=m.return)&&(yield H(a.call(m)))}finally{if(i)throw i.error}}for(const g of p.flush()){const x=d.decode(g);x&&(yield yield H(x))}})}function gp(t){return de(this,arguments,function*(){var n,s,i,a;let c=new Uint8Array;try{for(var d=!0,p=ue(t),u;u=yield H(p.next()),n=u.done,!n;d=!0){a=u.value,d=!1;const f=a;if(f==null)continue;const m=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?ln(f):f;let h=new Uint8Array(c.length+m.length);h.set(c),h.set(m,c.length),c=h;let g;for(;(g=fp(c))!==-1;)yield yield H(c.slice(0,g)),c=c.slice(g)}}catch(f){s={error:f}}finally{try{!d&&!n&&(i=p.return)&&(yield H(i.call(p)))}finally{if(s)throw s.error}}c.length>0&&(yield yield H(c))})}class xp{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,i]=vp(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function vp(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function yp(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:i,startTime:a}=e,c=await(async()=>{var d;if(e.options.stream)return te(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Ve.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const p=n.headers.get("content-type"),u=(d=p?.split(";")[0])===null||d===void 0?void 0:d.trim();return u?.includes("application/json")||u?.endsWith("+json")?await n.json():await n.text()})();return te(t).debug(`[${s}] response parsed`,_e({retryOfRequestLogID:i,url:n.url,status:n.status,body:c,durationMs:Date.now()-a})),c}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cn extends Promise{constructor(e,n,s=yp){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=s,this.client=e}_thenUnwrap(e){return new cn(this.client,this.responsePromise,async(n,s)=>e(await this.parseResponse(n,s),s))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qo=Symbol("brand.privateNullableHeaders");function*bp(t){if(!t)return;if(Qo in t){const{values:s,nulls:i}=t;yield*s.entries();for(const a of i)yield[a,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Hs(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const i=s[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=Hs(s[1])?s[1]:[s[1]];let c=!1;for(const d of a)d!==void 0&&(e&&!c&&(c=!0,yield[i,null]),yield[i,d])}}const Ke=t=>{const e=new Headers,n=new Set;for(const s of t){const i=new Set;for(const[a,c]of bp(s)){const d=a.toLowerCase();i.has(d)||(e.delete(a),i.add(d)),c===null?(e.delete(a),n.add(d)):(e.append(a,c),n.delete(d))}}return{[Qo]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jt=t=>{var e,n,s,i,a,c;if(typeof globalThis.process<"u")return(s=(n=(e=Ji)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&s!==void 0?s:void 0;if(typeof globalThis.Deno<"u")return(c=(a=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||a===void 0?void 0:a.call(i,t))===null||c===void 0?void 0:c.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zo;class It{constructor(e){var n,s,i,a,c,d,p,{baseURL:u=jt("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=jt("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:m="v1beta"}=e,h=ht(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:f,apiVersion:m},h),{baseURL:u||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(s=g.timeout)!==null&&s!==void 0?s:It.DEFAULT_TIMEOUT,this.logger=(i=g.logger)!==null&&i!==void 0?i:console;const x="warn";this.logLevel=x,this.logLevel=(c=(a=Js(g.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:Js(jt("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&c!==void 0?c:x,this.fetchOptions=g.fetchOptions,this.maxRetries=(d=g.maxRetries)!==null&&d!==void 0?d:2,this.fetch=(p=g.fetch)!==null&&p!==void 0?p:ep(),this.encoder=sp,this._options=g,this.apiKey=f,this.apiVersion=m,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Ke([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Ke([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Ke([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,s])=>typeof s<"u").map(([n,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(n)}=`;throw new re(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Ue}`}defaultIdempotencyKey(){return`stainless-node-retry-${Gu()}`}makeStatusError(e,n,s,i){return ne.generate(e,n,s,i)}buildURL(e,n,s){const i=!this.baseURLOverridden()&&s||this.baseURL,a=Bu(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return $u(c)||(n=Object.assign(Object.assign({},c),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(a.search=this.stringifyQuery(n)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new cn(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){var i,a,c;const d=await e,p=(i=d.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=p),await this.prepareOptions(d);const{req:u,url:f,timeout:m}=await this.buildRequest(d,{retryCount:p-n});await this.prepareRequest(u,{url:f,options:d});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=s===void 0?"":`, retryOf: ${s}`,x=Date.now();if(te(this).debug(`[${h}] sending request`,_e({retryOfRequestLogID:s,method:d.method,url:f,options:d,headers:u.headers})),!((a=d.signal)===null||a===void 0)&&a.aborted)throw new Kt;const y=new AbortController,v=await this.fetchWithTimeout(f,u,m,y).catch(zt),b=Date.now();if(v instanceof globalThis.Error){const N=`retrying, ${n} attempts remaining`;if(!((c=d.signal)===null||c===void 0)&&c.aborted)throw new Kt;const A=Wt(v)||/timed? ?out/i.test(String(v)+("cause"in v?String(v.cause):""));if(n)return te(this).info(`[${h}] connection ${A?"timed out":"failed"} - ${N}`),te(this).debug(`[${h}] connection ${A?"timed out":"failed"} (${N})`,_e({retryOfRequestLogID:s,url:f,durationMs:b-x,message:v.message})),this.retryRequest(d,n,s??h);throw te(this).info(`[${h}] connection ${A?"timed out":"failed"} - error; no more retries left`),te(this).debug(`[${h}] connection ${A?"timed out":"failed"} (error; no more retries left)`,_e({retryOfRequestLogID:s,url:f,durationMs:b-x,message:v.message})),A?new jo:new Tt({cause:v})}const I=`[${h}${g}] ${u.method} ${f} ${v.ok?"succeeded":"failed"} with status ${v.status} in ${b-x}ms`;if(!v.ok){const N=await this.shouldRetry(v);if(n&&N){const E=`retrying, ${n} attempts remaining`;return await np(v.body),te(this).info(`${I} - ${E}`),te(this).debug(`[${h}] response error (${E})`,_e({retryOfRequestLogID:s,url:v.url,status:v.status,headers:v.headers,durationMs:b-x})),this.retryRequest(d,n,s??h,v.headers)}const A=N?"error; no more retries left":"error; not retryable";te(this).info(`${I} - ${A}`);const _=await v.text().catch(E=>zt(E).message),w=zu(_),C=w?void 0:_;throw te(this).debug(`[${h}] response error (${A})`,_e({retryOfRequestLogID:s,url:v.url,status:v.status,headers:v.headers,message:C,durationMs:Date.now()-x})),this.makeStatusError(v.status,w,C,v.headers)}return te(this).info(I),te(this).debug(`[${h}] response start`,_e({retryOfRequestLogID:s,url:v.url,status:v.status,headers:v.headers,durationMs:b-x})),{response:v,options:d,controller:y,requestLogID:h,retryOfRequestLogID:s,startTime:x}}async fetchWithTimeout(e,n,s,i){const a=n||{},{signal:c,method:d}=a,p=ht(a,["signal","method"]);c&&c.addEventListener("abort",()=>i.abort());const u=setTimeout(()=>i.abort(),s),f=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,m=Object.assign(Object.assign(Object.assign({signal:i.signal},f?{duplex:"half"}:{}),{method:"GET"}),p);d&&(m.method=d.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(u)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,i){var a;let c;const d=i?.get("retry-after-ms");if(d){const u=parseFloat(d);Number.isNaN(u)||(c=u)}const p=i?.get("retry-after");if(p&&!c){const u=parseFloat(p);Number.isNaN(u)?c=Date.parse(p)-Date.now():c=u*1e3}if(!(c&&0<=c&&c<60*1e3)){const u=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;c=this.calculateDefaultRetryTimeoutMillis(n,u)}return await Ku(c),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const a=n-e,c=Math.min(.5*Math.pow(2,a),8),d=1-Math.random()*.25;return c*d*1e3}async buildRequest(e,{retryCount:n=0}={}){var s,i,a;const c=Object.assign({},e),{method:d,path:p,query:u,defaultBaseURL:f}=c,m=this.buildURL(p,u,f);"timeout"in c&&Wu("timeout",c.timeout),c.timeout=(s=c.timeout)!==null&&s!==void 0?s:this.timeout;const{bodyHeaders:h,body:g}=this.buildBody({options:c}),x=await this.buildHeaders({options:e,method:d,bodyHeaders:h,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:d,headers:x},c.signal&&{signal:c.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(a=c.fetchOptions)!==null&&a!==void 0?a:{}),url:m,timeout:c.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:i}){let a={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const c=await this.authHeaders(e);let d=Ke([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Zu()),this._options.defaultHeaders,s,e.headers,c]);return this.validateHeaders(d),d.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=Ke([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:tp(e)}:this.encoder({body:e,headers:s})}}It.DEFAULT_TIMEOUT=6e4;class X extends It{constructor(){super(...arguments),this.interactions=new Xo(this)}}Zo=X;X.GeminiNextGenAPIClient=Zo;X.GeminiNextGenAPIClientError=re;X.APIError=ne;X.APIConnectionError=Tt;X.APIConnectionTimeoutError=jo;X.APIUserAbortError=Kt;X.NotFoundError=Vo;X.ConflictError=Go;X.RateLimitError=Bo;X.BadRequestError=Do;X.AuthenticationError=Uo;X.InternalServerError=qo;X.PermissionDeniedError=Fo;X.UnprocessableEntityError=Ho;X.toFile=lp;X.Interactions=Xo;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Np(t,e){const n={},s=r(t,["name"]);return s!=null&&l(n,["_url","name"],s),n}function wp(t,e){const n={},s=r(t,["name"]);return s!=null&&l(n,["_url","name"],s),n}function Sp(t,e){const n={},s=r(t,["sdkHttpResponse"]);return s!=null&&l(n,["sdkHttpResponse"],s),n}function Cp(t,e){const n={},s=r(t,["sdkHttpResponse"]);return s!=null&&l(n,["sdkHttpResponse"],s),n}function Ep(t,e,n){const s={};if(r(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&l(e,["displayName"],i),r(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=r(t,["epochCount"]);e!==void 0&&a!=null&&l(e,["tuningTask","hyperparameters","epochCount"],a);const c=r(t,["learningRateMultiplier"]);if(c!=null&&l(s,["tuningTask","hyperparameters","learningRateMultiplier"],c),r(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(r(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=r(t,["batchSize"]);e!==void 0&&d!=null&&l(e,["tuningTask","hyperparameters","batchSize"],d);const p=r(t,["learningRate"]);if(e!==void 0&&p!=null&&l(e,["tuningTask","hyperparameters","learningRate"],p),r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(r(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return s}function Tp(t,e,n){const s={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=r(t,["validationDataset"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec"],zs(g))}else if(i==="PREFERENCE_TUNING"){const g=r(t,["validationDataset"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec"],zs(g))}const a=r(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&l(e,["tunedModelDisplayName"],a);const c=r(t,["description"]);e!==void 0&&c!=null&&l(e,["description"],c);let d=r(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=r(t,["epochCount"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(d==="PREFERENCE_TUNING"){const g=r(t,["epochCount"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let p=r(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const g=r(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(p==="PREFERENCE_TUNING"){const g=r(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let u=r(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=r(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(u==="PREFERENCE_TUNING"){const g=r(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let f=r(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const g=r(t,["adapterSize"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(f==="PREFERENCE_TUNING"){const g=r(t,["adapterSize"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(r(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=r(t,["labels"]);e!==void 0&&m!=null&&l(e,["labels"],m);const h=r(t,["beta"]);return e!==void 0&&h!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","beta"],h),s}function _p(t,e){const n={},s=r(t,["baseModel"]);s!=null&&l(n,["baseModel"],s);const i=r(t,["preTunedModel"]);i!=null&&l(n,["preTunedModel"],i);const a=r(t,["trainingDataset"]);a!=null&&Fp(a);const c=r(t,["config"]);return c!=null&&Ep(c,n),n}function Ip(t,e){const n={},s=r(t,["baseModel"]);s!=null&&l(n,["baseModel"],s);const i=r(t,["preTunedModel"]);i!=null&&l(n,["preTunedModel"],i);const a=r(t,["trainingDataset"]);a!=null&&Vp(a,n,e);const c=r(t,["config"]);return c!=null&&Tp(c,n,e),n}function Ap(t,e){const n={},s=r(t,["name"]);return s!=null&&l(n,["_url","name"],s),n}function kp(t,e){const n={},s=r(t,["name"]);return s!=null&&l(n,["_url","name"],s),n}function Rp(t,e,n){const s={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&l(e,["_query","pageSize"],i);const a=r(t,["pageToken"]);e!==void 0&&a!=null&&l(e,["_query","pageToken"],a);const c=r(t,["filter"]);return e!==void 0&&c!=null&&l(e,["_query","filter"],c),s}function Mp(t,e,n){const s={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&l(e,["_query","pageSize"],i);const a=r(t,["pageToken"]);e!==void 0&&a!=null&&l(e,["_query","pageToken"],a);const c=r(t,["filter"]);return e!==void 0&&c!=null&&l(e,["_query","filter"],c),s}function Pp(t,e){const n={},s=r(t,["config"]);return s!=null&&Rp(s,n),n}function Lp(t,e){const n={},s=r(t,["config"]);return s!=null&&Mp(s,n),n}function jp(t,e){const n={},s=r(t,["sdkHttpResponse"]);s!=null&&l(n,["sdkHttpResponse"],s);const i=r(t,["nextPageToken"]);i!=null&&l(n,["nextPageToken"],i);const a=r(t,["tunedModels"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>ei(d))),l(n,["tuningJobs"],c)}return n}function Dp(t,e){const n={},s=r(t,["sdkHttpResponse"]);s!=null&&l(n,["sdkHttpResponse"],s);const i=r(t,["nextPageToken"]);i!=null&&l(n,["nextPageToken"],i);const a=r(t,["tuningJobs"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>Qt(d))),l(n,["tuningJobs"],c)}return n}function Up(t,e){const n={},s=r(t,["name"]);s!=null&&l(n,["model"],s);const i=r(t,["name"]);return i!=null&&l(n,["endpoint"],i),n}function Fp(t,e){const n={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=r(t,["examples"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>a)),l(n,["examples","examples"],i)}return n}function Vp(t,e,n){const s={};let i=r(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const c=r(t,["gcsUri"]);e!==void 0&&c!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(i==="PREFERENCE_TUNING"){const c=r(t,["gcsUri"]);e!==void 0&&c!=null&&l(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let a=r(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const c=r(t,["vertexDatasetResource"]);e!==void 0&&c!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(a==="PREFERENCE_TUNING"){const c=r(t,["vertexDatasetResource"]);e!==void 0&&c!=null&&l(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(r(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function ei(t,e){const n={},s=r(t,["sdkHttpResponse"]);s!=null&&l(n,["sdkHttpResponse"],s);const i=r(t,["name"]);i!=null&&l(n,["name"],i);const a=r(t,["state"]);a!=null&&l(n,["state"],go(a));const c=r(t,["createTime"]);c!=null&&l(n,["createTime"],c);const d=r(t,["tuningTask","startTime"]);d!=null&&l(n,["startTime"],d);const p=r(t,["tuningTask","completeTime"]);p!=null&&l(n,["endTime"],p);const u=r(t,["updateTime"]);u!=null&&l(n,["updateTime"],u);const f=r(t,["description"]);f!=null&&l(n,["description"],f);const m=r(t,["baseModel"]);m!=null&&l(n,["baseModel"],m);const h=r(t,["_self"]);return h!=null&&l(n,["tunedModel"],Up(h)),n}function Qt(t,e){const n={},s=r(t,["sdkHttpResponse"]);s!=null&&l(n,["sdkHttpResponse"],s);const i=r(t,["name"]);i!=null&&l(n,["name"],i);const a=r(t,["state"]);a!=null&&l(n,["state"],go(a));const c=r(t,["createTime"]);c!=null&&l(n,["createTime"],c);const d=r(t,["startTime"]);d!=null&&l(n,["startTime"],d);const p=r(t,["endTime"]);p!=null&&l(n,["endTime"],p);const u=r(t,["updateTime"]);u!=null&&l(n,["updateTime"],u);const f=r(t,["error"]);f!=null&&l(n,["error"],f);const m=r(t,["description"]);m!=null&&l(n,["description"],m);const h=r(t,["baseModel"]);h!=null&&l(n,["baseModel"],h);const g=r(t,["tunedModel"]);g!=null&&l(n,["tunedModel"],g);const x=r(t,["preTunedModel"]);x!=null&&l(n,["preTunedModel"],x);const y=r(t,["supervisedTuningSpec"]);y!=null&&l(n,["supervisedTuningSpec"],y);const v=r(t,["preferenceOptimizationSpec"]);v!=null&&l(n,["preferenceOptimizationSpec"],v);const b=r(t,["tuningDataStats"]);b!=null&&l(n,["tuningDataStats"],b);const I=r(t,["encryptionSpec"]);I!=null&&l(n,["encryptionSpec"],I);const N=r(t,["partnerModelTuningSpec"]);N!=null&&l(n,["partnerModelTuningSpec"],N);const A=r(t,["customBaseModel"]);A!=null&&l(n,["customBaseModel"],A);const _=r(t,["experiment"]);_!=null&&l(n,["experiment"],_);const w=r(t,["labels"]);w!=null&&l(n,["labels"],w);const C=r(t,["outputUri"]);C!=null&&l(n,["outputUri"],C);const k=r(t,["pipelineJob"]);k!=null&&l(n,["pipelineJob"],k);const E=r(t,["serviceAccount"]);E!=null&&l(n,["serviceAccount"],E);const S=r(t,["tunedModelDisplayName"]);S!=null&&l(n,["tunedModelDisplayName"],S);const R=r(t,["veoTuningSpec"]);return R!=null&&l(n,["veoTuningSpec"],R),n}function Gp(t,e){const n={},s=r(t,["sdkHttpResponse"]);s!=null&&l(n,["sdkHttpResponse"],s);const i=r(t,["name"]);i!=null&&l(n,["name"],i);const a=r(t,["metadata"]);a!=null&&l(n,["metadata"],a);const c=r(t,["done"]);c!=null&&l(n,["done"],c);const d=r(t,["error"]);return d!=null&&l(n,["error"],d),n}function zs(t,e){const n={},s=r(t,["gcsUri"]);s!=null&&l(n,["validationDatasetUri"],s);const i=r(t,["vertexDatasetResource"]);return i!=null&&l(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hp extends ge{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ke(he.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var s;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((s=n.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},n),{preTunedModel:i});return a.baseModel=void 0,await this.tuneInternal(a)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),a=await this.tuneMldevInternal(i);let c="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?c=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(c=a.name.split("/operations/")[0]),{name:c,state:Gt.JOB_STATE_QUEUED}}}}async getInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=kp(e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>Qt(f))}else{const u=Ap(e);return d=P("{name}",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>ei(f))}}async listInternal(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=Lp(e);return d=P("tuningJobs",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Dp(f),h=new bs;return Object.assign(h,m),h})}else{const u=Pp(e);return d=P("tunedModels",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=jp(f),h=new bs;return Object.assign(h,m),h})}}async cancel(e){var n,s,i,a;let c,d="",p={};if(this.apiClient.isVertexAI()){const u=wp(e);return d=P("{name}:cancel",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Cp(f),h=new Ns;return Object.assign(h,m),h})}else{const u=Np(e);return d=P("{name}:cancel",u._url),p=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(f=>f.json().then(m=>{const h=m;return h.sdkHttpResponse={headers:f.headers},h})),c.then(f=>{const m=Sp(f),h=new Ns;return Object.assign(h,m),h})}}async tuneInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=Ip(e,e);return a=P("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>Qt(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,s;let i,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=_p(e);return a=P("tunedModels",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:p.headers},f})),i.then(p=>Gp(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bp{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const qp=1024*1024*8,Op=3,$p=1e3,Jp=2,xt="x-goog-upload-status";async function Wp(t,e,n){var s;const i=await ti(t,e,n),a=await i?.json();if(((s=i?.headers)===null||s===void 0?void 0:s[xt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function zp(t,e,n){var s;const i=await ti(t,e,n),a=await i?.json();if(((s=i?.headers)===null||s===void 0?void 0:s[xt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const c=co(a),d=new tn;return Object.assign(d,c),d}async function ti(t,e,n){var s,i;let a=0,c=0,d=new Ht(new Response),p="upload";for(a=t.size;c<a;){const u=Math.min(qp,a-c),f=t.slice(c,c+u);c+u>=a&&(p+=", finalize");let m=0,h=$p;for(;m<Op&&(d=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(c),"Content-Length":String(u)}}}),!(!((s=d?.headers)===null||s===void 0)&&s[xt]));)m++,await Yp(h),h=h*Jp;if(c+=u,((i=d?.headers)===null||i===void 0?void 0:i[xt])!=="active")break;if(a<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function Kp(t){return{size:t.size,type:t.type}}function Yp(t){return new Promise(e=>setTimeout(e,t))}class Xp{async upload(e,n,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Wp(e,n,s)}async uploadToFileSearchStore(e,n,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await zp(e,n,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Kp(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qp{create(e,n,s){return new Zp(e,n,s)}}class Zp{constructor(e,n,s){this.url=e,this.headers=n,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ks="x-goog-api-key";class ef{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Ks)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Ks,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tf="gl-node/";class nf{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new X({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const s=Yi(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new ef(this.apiKey);this.apiClient=new Kd({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:tf+"web",uploader:new Xp,downloader:new Bp}),this.models=new mu(this.apiClient),this.live=new lu(this.apiClient,i,new Qp),this.batches=new Ea(this.apiClient),this.chats=new rl(this.models,this.apiClient),this.caches=new sl(this.apiClient),this.files=new gl(this.apiClient),this.operations=new hu(this.apiClient),this.authTokens=new Ru(this.apiClient),this.tunings=new Hp(this.apiClient),this.fileSearchStores=new Vu(this.apiClient)}}var sf={};const of=async t=>{const e=new nf({apiKey:sf.API_KEY});try{const n=Be.filter(d=>t[d.id]===K.BAD),s=Be.filter(d=>t[d.id]===K.ATTENTION);let i=`You are a Senior Fleet Safety Manager. Review the following truck inspection report.
`;i+=`Truck No: ${t.truckNo}, Trailer: ${t.trailerNo}, Odometer: ${t.odometer}
`,i+=`
BAD / FAILED ITEMS (${n.length}):
`,n.length===0?i+=`None.
`:n.forEach(d=>{i+=`- ${d.label} (Status: Critical Failure)
`}),i+=`
ITEMS NEEDING ATTENTION (${s.length}):
`,s.length===0?i+=`None.
`:s.forEach(d=>{i+=`- ${d.label} (Status: Needs Attention)
`}),i+=`
REMARKS from Inspector: ${t.remarks||"No remarks provided."}
`,i+=`
Overall Rating given by inspector: ${t.rate}/5
`,i+=`
Task:
`,i+=`1. Summarize the condition of the vehicle in 2 sentences.
`,i+=`2. Provide a "Safety Risk Score" from 1 (Safe) to 10 (Critical).
`,i+=`3. List 3 immediate prioritized actions for the maintenance team.
`,i+=`
Format the output as professional, concise text.`;const a=[{text:i}];if(t.photoDamage){const d=t.photoDamage.split(",")[1];d&&(a.push({inlineData:{mimeType:"image/jpeg",data:d}}),a.push({text:"Also analyze the attached photo of the reported damage for severity."}))}return(await e.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:a}})).text||"Analysis complete but no text returned."}catch(n){return console.error("Gemini Analysis Failed:",n),"AI Safety Analysis currently unavailable. Please review the manual report."}},Ys=({message:t,type:e,onClose:n})=>{const i={success:{bg:"bg-emerald-950",border:"border-emerald-500/50",icon:o.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M5 13l4 4L19 7"})}),label:"SUCCESS"},error:{bg:"bg-rose-950",border:"border-rose-500/50",icon:o.jsx("svg",{className:"w-5 h-5 text-rose-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})}),label:"CRITICAL"},info:{bg:"bg-slate-900",border:"border-indigo-500/50",icon:o.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),label:"SYSTEM"},warning:{bg:"bg-amber-950",border:"border-amber-500/50",icon:o.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),label:"ALERT"}}[e];return o.jsx("div",{className:"fixed top-4 left-4 right-4 sm:left-auto sm:right-6 sm:max-w-md z-[1000] animate-fadeIn no-print",children:o.jsxs("div",{className:`${i.bg} ${i.border} border-l-4 rounded-xl shadow-2xl p-4 flex items-center gap-4 relative overflow-hidden group`,children:[o.jsx("div",{className:"shrink-0 bg-white/5 p-2 rounded-lg border border-white/10 shadow-inner",children:i.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-center gap-2 mb-0.5",children:o.jsx("span",{className:`text-[9px] font-bold uppercase tracking-widest ${e==="success"?"text-emerald-400":e==="error"?"text-rose-400":e==="info"?"text-indigo-400":"text-amber-400"}`,children:i.label})}),o.jsx("p",{className:"text-white text-xs font-medium leading-relaxed truncate opacity-90",children:t})]}),o.jsx("button",{onClick:n,className:"p-1.5 text-white/30 hover:text-white hover:bg-white/10 rounded-lg transition-all active:scale-90",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]})})},rf=({onClose:t,onPrint:e,children:n,title:s})=>{const[i,a]=T.useState(!1),c=()=>{a(!0);const d=document.getElementById("printable-report-content");if(!d){console.error("Report content not found"),a(!1);return}const u={margin:0,filename:`${s.replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,letterRendering:!0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}},f=window.html2pdf;f?f().set(u).from(d).save().then(()=>{a(!1)}).catch(m=>{console.error("PDF Generation Error",m),a(!1),alert("Failed to generate PDF. You can use the Print button as a fallback.")}):(e(),a(!1))};return o.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/90 backdrop-blur-md animate-fadeIn no-print",children:o.jsxs("div",{className:"bg-white w-full max-w-5xl h-[94vh] rounded-3xl shadow-2xl flex flex-col overflow-hidden border border-white/20",children:[o.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center bg-slate-50 border-slate-200",children:[o.jsx("div",{className:"flex items-center gap-6",children:o.jsxs("button",{onClick:t,className:"text-sm font-bold text-slate-500 hover:text-slate-800 transition-colors uppercase tracking-wider flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Close"]})}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:c,disabled:i,className:"px-5 py-2.5 text-xs font-bold text-white bg-slate-900 hover:bg-black rounded-xl shadow-lg flex items-center gap-2 transition-all active:scale-95 disabled:bg-slate-400",children:[i?o.jsxs("svg",{className:"animate-spin w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]}),o.jsxs("button",{onClick:e,className:"hidden sm:flex px-5 py-2.5 text-xs font-bold text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-all items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]})]})]}),o.jsx("div",{className:"flex-1 overflow-auto bg-slate-100 p-4 sm:p-10 flex justify-center relative",children:o.jsx("div",{className:"origin-top transform scale-[0.9] lg:scale-100 transition-transform duration-500",children:o.jsx("div",{id:"printable-report-content",className:"bg-white shadow-2xl min-h-[297mm] relative z-10 w-[210mm] print:shadow-none",children:n})})})]})})},af=({status:t,onClose:e,onViewReport:n,aiAnalysis:s})=>t==="idle"?null:o.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center overflow-y-auto py-10",children:[o.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md transition-all duration-300"}),o.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full mx-4 text-center transform transition-all duration-300 scale-100 animate-fadeIn border border-white/20 max-w-xl my-auto",children:[t==="submitting"&&o.jsxs("div",{className:"flex flex-col items-center gap-4 py-10",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 uppercase tracking-tight",children:"Uploading Inspection"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1 font-medium uppercase tracking-widest opacity-60",children:"Syncing with Fleet Database..."})]})]}),t==="success"&&o.jsxs("div",{className:"flex flex-col items-center gap-6 py-4 animate-fadeIn",children:[o.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center shadow-inner",children:o.jsx("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Submission Successful"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium uppercase tracking-widest",children:"Fleet repository updated"})]}),o.jsxs("div",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl p-5 text-left relative overflow-hidden",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx("div",{className:"w-6 h-6 bg-indigo-600 rounded-lg flex items-center justify-center text-white",children:o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),o.jsx("h4",{className:"text-[10px] font-black text-indigo-600 uppercase tracking-[0.2em]",children:"Safety AI Insights"})]}),s?o.jsx("div",{className:"animate-fadeIn",children:o.jsx("p",{className:"text-xs font-medium text-slate-700 leading-relaxed whitespace-pre-wrap",children:s})}):o.jsxs("div",{className:"flex flex-col items-center py-6 gap-3",children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-indigo-400",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest animate-pulse",children:"Analyzing Vehicle Condition..."})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 w-full",children:[o.jsxs("button",{onClick:n,className:"w-full py-4 bg-white border border-slate-200 text-slate-700 font-bold rounded-xl shadow-sm hover:bg-slate-50 transition-all flex items-center justify-center gap-2 text-[10px] uppercase tracking-widest",children:[o.jsxs("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Digital PDF"]}),o.jsx("button",{onClick:e,className:"w-full py-4 bg-slate-900 text-white font-black rounded-xl shadow-lg hover:bg-black transition-all flex items-center justify-center gap-2 text-[10px] uppercase tracking-widest active:scale-95",children:"Return Home"})]})]}),t==="offline_saved"&&o.jsxs("div",{className:"flex flex-col items-center gap-4 py-10",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center shadow-inner",children:o.jsx("svg",{className:"w-10 h-10 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Offline Saved"}),o.jsx("p",{className:"text-sm text-gray-500 mt-2 leading-relaxed font-medium",children:"Data stored on-device. Sync will resume automatically when internet returns."})]}),o.jsx("button",{onClick:e,className:"w-full mt-4 py-4 bg-slate-100 text-slate-600 font-bold rounded-xl hover:bg-slate-200 transition-all text-[10px] uppercase tracking-widest",children:"Got It"})]})]})]}),lf=({user:t,settings:e,appScriptUrl:n,onClose:s,showToast:i,onUpdateSuccess:a,onLogout:c})=>{const d=(t.name||"").split(" "),p=d[0]||"",u=d.slice(1).join(" ")||"",[f,m]=T.useState(""),[h,g]=T.useState(""),[x,y]=T.useState(!1),[v,b]=T.useState(t.preferences||{emailNotifications:!0,notifyGeneral:!0,notifyPetroleum:!0,notifyPetroleumV2:!0,notifyAcid:!0}),[I,N]=T.useState(!1),A=async()=>{if(!f){i("Please enter a new password.","warning");return}if(f!==h){i("Passwords do not match.","error");return}y(!0);try{const k=await(await fetch(n,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:t.username,password:f})})).json();k.status==="success"?(i("Security updated!","success"),m(""),g("")):i(k.message||"Failed to update.","error")}catch{i("Sync failed.","error")}finally{y(!1)}},_=async C=>{b(C),N(!0);try{(await(await fetch(n,{method:"POST",body:JSON.stringify({action:"update_user",originalUsername:t.username,preferences:C})})).json()).status==="success"&&(a({...t,preferences:C}),i("Preferences synced.","success"))}catch{i("Sync failed.","error")}finally{N(!1)}},w=C=>{const k={...v,[C]:!v[C]};_(k)};return o.jsxs("div",{className:"fixed inset-0 z-[100] bg-white flex flex-col animate-fadeIn overflow-y-auto",children:[o.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-100 px-4 py-3 flex items-center shrink-0 z-10 shadow-sm",children:[o.jsx("button",{onClick:s,className:"p-2 text-blue-500 hover:bg-blue-50 rounded-full transition-all",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),o.jsx("h1",{className:"flex-1 text-center font-bold text-slate-800 text-sm uppercase tracking-widest",children:"My Workspace"}),o.jsx("div",{className:"w-10"})]}),o.jsxs("div",{className:"max-w-2xl mx-auto w-full px-6 py-10 space-y-12 pb-24",children:[o.jsxs("section",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-800 border-b border-gray-100 pb-2 uppercase tracking-tight",children:"Identity Profile"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm py-1",children:[o.jsx("span",{className:"font-semibold text-slate-600",children:"Organization"}),o.jsx("span",{className:"text-slate-400 font-medium",children:e.companyName||"Transport Pro"})]}),o.jsxs("div",{className:"flex justify-between items-center text-sm py-1",children:[o.jsx("span",{className:"font-semibold text-slate-600",children:"First Name"}),o.jsx("span",{className:"text-slate-400 font-medium",children:p})]}),o.jsxs("div",{className:"flex justify-between items-center text-sm py-1",children:[o.jsx("span",{className:"font-semibold text-slate-600",children:"Last Name"}),o.jsx("span",{className:"text-slate-400 font-medium",children:u})]}),o.jsxs("div",{className:"flex justify-between items-center text-sm py-1",children:[o.jsx("span",{className:"font-semibold text-slate-600",children:"Login ID"}),o.jsx("span",{className:"text-slate-400 font-medium",children:t.username})]})]})]}),o.jsxs("section",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-800 border-b border-gray-100 pb-2 uppercase tracking-tight",children:"Security Access"}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{type:"password",placeholder:"Set New Password",className:"w-full p-3.5 border border-gray-200 rounded-xl text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-blue-100 outline-none transition-all font-semibold",value:f,onChange:C=>m(C.target.value)}),o.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full p-3.5 border border-gray-200 rounded-xl text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-blue-100 outline-none transition-all font-semibold",value:h,onChange:C=>g(C.target.value)}),o.jsx("button",{onClick:A,disabled:x,className:"w-full py-4 bg-slate-900 hover:bg-black text-white font-bold rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 text-xs uppercase tracking-widest",children:x?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Update Security"})]})]}),o.jsxs("section",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 pb-2",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-800 uppercase tracking-tight",children:"Alert Preferences"}),I&&o.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-500",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center justify-between p-4 rounded-2xl bg-slate-50 border border-slate-100 cursor-pointer group",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-bold text-slate-800",children:"Master Email Alert"}),o.jsx("p",{className:"text-[10px] text-slate-400 font-semibold uppercase tracking-wider",children:"Automated system triggers"})]}),o.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:v.emailNotifications,onChange:()=>w("emailNotifications")})]}),o.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-3 pt-2 transition-opacity duration-300 ${!v.emailNotifications&&"opacity-40 pointer-events-none"}`,children:[{key:"notifyGeneral",label:"General Fleet"},{key:"notifyPetroleum",label:"Petroleum V1"},{key:"notifyPetroleumV2",label:"Petroleum V2"},{key:"notifyAcid",label:"Acid Tankers"}].map(C=>o.jsxs("label",{className:"flex items-center justify-between px-4 py-3.5 rounded-xl border border-gray-100 bg-white hover:bg-gray-50 cursor-pointer transition-colors shadow-sm",children:[o.jsx("span",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-widest",children:C.label}),o.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-blue-600",checked:v[C.key],onChange:()=>w(C.key)})]},C.key))})]})]}),o.jsx("section",{className:"pt-8",children:o.jsxs("button",{onClick:c,className:"w-full py-4 bg-white border-2 border-red-500 text-red-500 hover:bg-red-50 font-bold rounded-xl transition-all flex items-center justify-center gap-3 uppercase tracking-[0.2em] active:scale-95 text-xs",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H5a3 3-0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})]})},cf=({id:t,notifications:e,onMarkAsRead:n,onDismiss:s,onClearAll:i,onAcknowledge:a,canAcknowledge:c})=>{const[d,p]=T.useState(!1),[u,f]=T.useState("all"),m=T.useRef(null);T.useEffect(()=>{function b(I){m.current&&!m.current.contains(I.target)&&p(!1)}return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[m]);const h=e.filter(b=>!b.read).length,g=e.filter(b=>!b.read&&b.type==="critical").length,x=T.useMemo(()=>{let b=[...e];return u==="unread"?b=b.filter(I=>!I.read):u==="critical"&&(b=b.filter(I=>I.type==="critical")),b},[e,u]),y=b=>{const I=new Date(b),A=Math.floor((new Date().getTime()-I.getTime())/1e3);return A<60?"Just now":A<3600?`${Math.floor(A/60)}m ago`:A<86400?`${Math.floor(A/3600)}h ago`:I.toLocaleDateString([],{month:"short",day:"numeric"})},v=b=>{const I="w-9 h-9 rounded-xl flex items-center justify-center shrink-0 border shadow-sm transition-all";switch(b){case"critical":return o.jsx("div",{className:`${I} bg-rose-50 text-rose-600 border-rose-100`,children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});case"success":return o.jsx("div",{className:`${I} bg-emerald-50 text-emerald-600 border-emerald-100`,children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})});default:return o.jsx("div",{className:`${I} bg-indigo-50 text-indigo-600 border-indigo-100`,children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}};return o.jsxs("div",{className:"relative",ref:m,children:[o.jsxs("button",{id:t,onClick:()=>p(!d),className:`relative p-2 rounded-xl transition-all duration-300 group
                    ${d?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-900 hover:bg-slate-50"}
                `,children:[o.jsx("svg",{className:"w-5 h-5 group-hover:rotate-12 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),h>0&&o.jsxs("span",{className:"absolute -top-1 -right-1 flex h-4 w-4",children:[o.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${g>0?"bg-rose-400":"bg-indigo-400"}`}),o.jsx("span",{className:`relative inline-flex rounded-full h-4 w-4 text-[8px] font-bold text-white items-center justify-center border-2 border-white shadow-sm ${g>0?"bg-rose-600":"bg-indigo-600"}`,children:h})]})]}),d&&o.jsxs("div",{className:"fixed inset-x-4 bottom-4 top-20 sm:top-auto sm:bottom-auto sm:absolute sm:right-0 sm:inset-x-auto sm:mt-4 w-auto sm:w-[400px] bg-white rounded-[2rem] sm:rounded-2xl shadow-2xl ring-1 ring-black/5 z-[100] flex flex-col overflow-hidden animate-slideUp origin-bottom sm:origin-top-right",children:[o.jsxs("div",{className:"p-6 border-b border-slate-50 flex justify-between items-center bg-white shrink-0",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-slate-900 tracking-tight",children:"Notifications"}),o.jsx("p",{className:"text-[10px] text-slate-400 font-medium uppercase tracking-widest mt-0.5",children:"Fleet Activity Monitor"})]}),o.jsx("button",{onClick:i,className:"px-4 py-2 bg-slate-50 hover:bg-rose-50 text-slate-500 hover:text-rose-600 rounded-xl transition-all text-[10px] font-bold uppercase tracking-widest border border-slate-100",children:"Clear All"})]}),o.jsx("div",{className:"flex bg-slate-50/50 p-1 border-b border-slate-50 shrink-0",children:["all","unread","critical"].map(b=>o.jsx("button",{onClick:()=>f(b),className:`flex-1 py-2 text-[10px] font-bold uppercase tracking-widest transition-all rounded-lg
                                    ${u===b?"bg-white text-indigo-600 shadow-sm":"text-slate-400 hover:text-slate-600"}
                                `,children:b},b))}),o.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide bg-white divide-y divide-slate-50 max-h-[50vh] sm:max-h-[400px]",children:x.length===0?o.jsxs("div",{className:"py-20 text-center flex flex-col items-center",children:[o.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center mb-4 border border-slate-100 text-slate-200",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M5 13l4 4L19 7",strokeWidth:"3"})})}),o.jsx("p",{className:"text-xs font-medium text-slate-400",children:"Your archive is clear"})]}):x.map(b=>o.jsxs("div",{className:`p-4 sm:p-5 transition-all relative group cursor-pointer hover:bg-slate-50/50
                                        ${b.read?"bg-white":"bg-indigo-50/10"}
                                    `,onClick:()=>n(b.id),children:[o.jsxs("div",{className:"flex gap-4",children:[v(b.type),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex justify-between items-start mb-0.5",children:[o.jsx("h4",{className:`text-xs font-bold truncate pr-6 ${b.type==="critical"?"text-rose-600":"text-slate-900"}`,children:b.title}),o.jsx("span",{className:"text-[9px] font-medium text-slate-400 whitespace-nowrap bg-slate-100 px-1.5 py-0.5 rounded",children:y(b.timestamp)})]}),o.jsx("p",{className:"text-[11px] font-medium text-slate-500 leading-relaxed line-clamp-2",children:b.message}),c&&b.type==="critical"&&a&&o.jsx("button",{onClick:I=>{I.stopPropagation(),a(b.id)},className:"mt-3 px-3 py-1.5 bg-slate-900 text-white text-[8px] font-black uppercase tracking-widest rounded-lg hover:bg-black transition-all shadow-sm",children:"Acknowledge Global"})]})]}),o.jsx("button",{onClick:I=>{I.stopPropagation(),s(b.id)},className:"absolute top-4 right-4 p-1.5 text-slate-200 hover:text-rose-500 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]},b.id))}),o.jsx("div",{className:"p-3 bg-slate-50 border-t border-slate-100 shrink-0 text-center",children:o.jsx("p",{className:"text-[9px] font-medium text-slate-400 uppercase tracking-[0.2em]",children:"Automated Intelligence Suite v4.0"})})]})]})},df=({isOpen:t,onClose:e,onStartNew:n,onResume:s,hasDraft:i,moduleName:a})=>t?o.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-900/70 backdrop-blur-sm animate-fadeIn",children:o.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden transform transition-all scale-100",children:[o.jsxs("div",{className:"bg-gradient-to-r from-emerald-900 to-emerald-800 p-6 text-white",children:[o.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx("svg",{className:"w-6 h-6 text-emerald-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Start ",a," Inspection"]}),o.jsx("p",{className:"text-emerald-100 text-sm mt-1",children:"Select how you would like to proceed."})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[i&&o.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4 mb-2",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center shrink-0 mt-1",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-amber-800 text-sm",children:"Unsaved Draft Found"}),o.jsx("p",{className:"text-xs text-amber-700 mt-0.5",children:"You have an inspection in progress. Would you like to continue where you left off?"})]})]}),o.jsx("button",{onClick:s,className:"w-full mt-3 py-3 bg-amber-500 hover:bg-amber-600 text-white font-bold rounded-lg shadow-md transition flex items-center justify-center gap-2",children:"Resume Draft"})]}),o.jsxs("button",{onClick:n,className:"w-full py-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition flex items-center justify-center gap-3 group",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-500/50 flex items-center justify-center group-hover:scale-110 transition-transform",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-sm font-black uppercase tracking-wide",children:"Start Inspection"}),i&&o.jsx("div",{className:"text-[10px] font-medium text-emerald-100 opacity-80",children:"This will discard the current draft"})]})]}),o.jsx("button",{onClick:e,className:"w-full py-3 bg-white border border-gray-200 text-gray-500 hover:bg-gray-50 hover:text-gray-700 font-bold rounded-xl transition",children:"Cancel"})]})]})}):null,uf=({subscription:t,user:e,onManage:n})=>{if(!e)return null;const s=e.role==="SuperAdmin";if(t===null)return o.jsxs("div",{className:"w-full px-4 py-3 flex items-center justify-center gap-3 bg-slate-800 text-white shadow-md relative z-[100] animate-fadeIn",children:[o.jsxs("svg",{className:"animate-spin h-4 w-4 text-slate-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-slate-400",children:"Verifying System License Validation..."})]});const i=t.status==="Expired"||!t.expiryDate||t.daysRemaining<=0,a=!i&&t.status==="Active"&&t.daysRemaining>0&&t.daysRemaining<=7;return!i&&!a?null:o.jsxs("div",{className:`w-full px-4 py-3 flex items-center justify-between shadow-md relative z-[100] animate-fadeIn
            ${i?"bg-red-600 text-white":"bg-amber-500 text-white"}
        `,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-white/20 rounded-full",children:i?o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-bold uppercase tracking-wide",children:i?"SYSTEM LICENSE EXPIRED":"LICENSE EXPIRING SOON"}),o.jsx("p",{className:"text-xs font-medium opacity-90",children:i?"Access to core features is restricted. Renew to restore modification access.":`${t?.daysRemaining} days remaining. Please renew soon.`})]})]}),s&&o.jsx("button",{onClick:n,className:"px-4 py-2 bg-white text-gray-900 rounded-lg text-xs font-bold uppercase tracking-wider hover:bg-gray-100 transition-colors shadow-sm",children:"Manage License"})]})},pf=({isOpen:t,onClose:e,onSubmit:n,validationLists:s})=>{if(!t)return null;const[i,a]=T.useState(""),[c,d]=T.useState(""),[p,u]=T.useState("General"),[f,m]=T.useState("Normal"),[h,g]=T.useState(""),[x,y]=T.useState(""),[v,b]=T.useState(!1),[I,N]=T.useState({}),A=async w=>{w.preventDefault();const C={};if(i||(C.truckNo="Required"),h.trim()||(C.reason="Required"),Object.keys(C).length>0){N(C);return}b(!0);try{await n({truckNo:i,trailerNo:c,type:p,priority:f,reason:h,assignedInspector:x}),e()}finally{b(!1)}},_=({label:w,value:C,onChange:k,options:E,placeholder:S="Select...",error:R,isOptional:U=!1})=>{const[M,G]=T.useState(!1),[z,F]=T.useState(""),V=T.useRef(null);T.useEffect(()=>{function B(se){V.current&&!V.current.contains(se.target)&&G(!1)}return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[V]);const W=E.filter(B=>String(B).toLowerCase().includes(z.toLowerCase()));return o.jsxs("div",{className:"relative",ref:V,children:[o.jsxs("label",{className:"block text-[10px] font-semibold text-slate-400 uppercase tracking-widest mb-1.5 ml-1",children:[w," ",U&&o.jsx("span",{className:"opacity-50 text-[8px]",children:"(Optional)"})]}),o.jsxs("div",{onClick:()=>{E.length>0&&G(!M)},className:`relative w-full p-4 bg-slate-50 border rounded-2xl outline-none text-sm font-medium text-slate-700 transition-all cursor-pointer flex items-center justify-between
                        ${R?"border-red-200 bg-red-50 text-red-900 shadow-sm":M?"border-indigo-400 ring-4 ring-indigo-50 bg-white":"border-slate-100 hover:border-slate-200 hover:bg-slate-100/30"}
                        ${E.length===0?"opacity-60 cursor-not-allowed":""}
                    `,children:[o.jsx("span",{className:`truncate mr-4 ${!C&&"text-slate-300"}`,children:C||(E.length===0?"No data":S)}),o.jsx("svg",{className:`w-3.5 h-3.5 text-slate-300 transition-transform ${M?"rotate-180 text-indigo-400":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M19 9l-7 7-7-7"})})]}),M&&E.length>0&&o.jsxs("div",{className:"absolute z-[110] w-full mt-2 bg-white border border-slate-100 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-56 animate-fadeIn",children:[o.jsx("div",{className:"p-3 border-b border-slate-50 bg-slate-50/50 sticky top-0 shrink-0",children:o.jsx("input",{type:"text",autoFocus:!0,className:"w-full px-4 py-2 text-sm border border-slate-200 rounded-xl focus:outline-none focus:border-indigo-400 placeholder-slate-300 font-medium",placeholder:"Search...",value:z,onChange:B=>F(B.target.value),onClick:B=>B.stopPropagation()})}),o.jsx("div",{className:"overflow-y-auto scrollbar-hide flex-1 py-1",children:W.length===0?o.jsx("div",{className:"p-6 text-center text-xs text-slate-400 font-medium uppercase tracking-widest",children:"No results"}):W.map((B,se)=>o.jsx("div",{onClick:()=>{k(B),G(!1)},className:`px-5 py-3 text-sm cursor-pointer transition-all ${C===B?"bg-indigo-50 text-indigo-600 font-semibold":"text-slate-600 hover:bg-slate-50"}`,children:B},se))})]}),R&&o.jsx("p",{className:"text-[10px] text-red-500 font-semibold mt-1 ml-1 uppercase",children:R})]})};return o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-fadeIn overflow-y-auto no-print",children:o.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2rem] shadow-2xl overflow-hidden border border-white/20 my-auto",children:[o.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-10",children:[o.jsx("div",{children:o.jsx("h3",{className:"text-xl font-semibold text-slate-800 tracking-tight uppercase",children:"Request Inspection"})}),o.jsx("button",{onClick:e,className:"text-slate-300 hover:text-slate-800 transition-colors p-2 hover:bg-slate-50 rounded-full",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"p-8",children:o.jsxs("form",{onSubmit:A,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[o.jsx(_,{label:"Truck Number",value:i,onChange:a,options:s.trucks,placeholder:"Select Truck...",error:I.truckNo}),o.jsx(_,{label:"Trailer Number",value:c,onChange:d,options:s.trailers,placeholder:"Select Trailer...",isOptional:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[o.jsx(_,{label:"Inspection Type",value:p,onChange:u,options:["General","Petroleum","Petroleum_V2","Acid"]}),o.jsx(_,{label:"Priority",value:f,onChange:m,options:["Normal","Urgent","Critical"]})]}),o.jsx(_,{label:"Assign Inspector",value:x,onChange:y,options:s.inspectors,placeholder:"Unassigned",isOptional:!0}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-semibold text-slate-400 uppercase tracking-widest mb-1.5 ml-1",children:"Details"}),o.jsx("textarea",{className:`w-full p-5 bg-slate-50 border rounded-2xl outline-none focus:ring-4 focus:ring-indigo-50 text-sm font-medium h-28 placeholder:text-slate-300 resize-none transition-all
                                    ${I.reason?"border-red-200 bg-red-50 text-red-900":"border-slate-100 focus:border-indigo-100"}
                                `,placeholder:"Enter any specific instructions...",value:h,onChange:w=>{g(w.target.value),N(C=>({...C,reason:""}))},required:!0}),I.reason&&o.jsx("p",{className:"text-[10px] text-red-500 font-semibold mt-1 ml-1 uppercase",children:I.reason})]}),o.jsx("button",{type:"submit",disabled:v,className:`w-full py-4.5 rounded-xl font-semibold text-white shadow-lg transition-all flex items-center justify-center gap-3 text-xs uppercase tracking-widest active:scale-95 border-t border-white/10
                                ${v?"bg-slate-400 cursor-wait":"bg-slate-900 hover:bg-black"}
                            `,children:v?"Processing...":"Send Request"})]})})]})})},ff=({user:t,appScriptUrl:e,onComplete:n,onLogout:s})=>{const[i,a]=T.useState(0),[c,d]=T.useState(!1),[p,u]=T.useState(t.name||""),[f,m]=T.useState(t.username||""),[h,g]=T.useState(""),[x,y]=T.useState(""),[v,b]=T.useState(""),[I,N]=T.useState({emailNotifications:!0,notifyGeneral:!0,notifyPetroleum:!0,notifyPetroleumV2:!0,notifyAcid:!0}),A=()=>{b(""),a(E=>E+1)},_=async E=>{if(E.preventDefault(),i===0){if(!p.trim()){b("Enter your official name.");return}if(!f.trim()||!f.includes("@")){b("Enter a valid email address.");return}}if(i===1){if(h.length<4){b("Password must be at least 4 characters.");return}if(h!==x){b("Passwords do not match.");return}}A()},w=()=>{n({...t,needsSetup:!1})},C=async()=>{d(!0),b("");try{const E={action:"update_user",originalUsername:t.username,username:f,name:p,password:h,preferences:{...I,hasCompletedTour:!1}},R=await(await fetch(e,{method:"POST",body:JSON.stringify(E)})).json();R.status==="success"?a(3):b(R.message||"Unable to sync profile. Try again.")}catch{b("Connection error. Please check your signal.")}finally{d(!1)}},k=[{l:"Identity"},{l:"Security"},{l:"Alerts"}];return o.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-100 flex items-center justify-center p-0 sm:p-4 animate-fadeIn overflow-hidden",children:o.jsxs("div",{className:"w-full h-full sm:h-auto sm:max-w-4xl bg-white sm:rounded-[2rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[o.jsxs("div",{className:"md:w-1/3 bg-slate-900 p-4 md:p-10 flex flex-row md:flex-col justify-between items-center md:items-start text-white shrink-0",children:[o.jsxs("div",{className:"flex items-center md:block gap-3",children:[o.jsx("div",{className:"w-8 h-8 md:w-12 md:h-12 bg-indigo-600 rounded-lg md:rounded-2xl flex items-center justify-center md:mb-8",children:o.jsx("svg",{className:"w-4 h-4 md:w-6 md:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M12 11c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),o.jsxs("div",{className:"md:block",children:[o.jsx("h1",{className:"text-sm md:text-2xl font-bold uppercase tracking-tight leading-none",children:"Onboarding"}),o.jsx("p",{className:"hidden md:block text-indigo-400 text-[10px] font-semibold uppercase tracking-widest mt-1 opacity-80",children:"Profile Setup"})]})]}),o.jsx("div",{className:"flex flex-row md:flex-col gap-2 md:gap-5",children:k.map((E,S)=>o.jsxs("div",{className:`flex items-center gap-1.5 md:gap-4 transition-all duration-500 ${i>=S?"opacity-100":"opacity-30"}`,children:[o.jsx("div",{className:`w-5 h-5 md:w-7 md:h-7 rounded-full flex items-center justify-center border ${i>S?"bg-emerald-500 border-emerald-500 text-white":i===S?"border-indigo-400 text-indigo-400":"border-slate-600 text-slate-400"} font-bold text-[9px] md:text-xs`,children:i>S?"✓":S+1}),o.jsx("span",{className:"hidden md:block font-medium text-[10px] uppercase tracking-[0.1em]",children:E.l})]},S))})]}),o.jsxs("div",{className:"flex-1 p-6 md:p-12 bg-white flex flex-col justify-center relative",children:[i===0&&o.jsxs("div",{className:"animate-fadeIn w-full max-w-sm mx-auto flex flex-col",children:[o.jsxs("div",{className:"mb-6 md:mb-10",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-800 tracking-tight",children:"Identity Profile"}),o.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Please verify your details for the fleet registry."})]}),o.jsxs("form",{onSubmit:_,className:"space-y-4 md:space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 mb-1.5 tracking-wide ml-1",children:"Full Name"}),o.jsx("input",{type:"text",autoFocus:!0,required:!0,className:"w-full p-3 md:p-4 bg-slate-50 border border-slate-200 rounded-xl outline-none font-medium text-slate-700 focus:ring-2 focus:ring-indigo-100 transition-all text-sm",value:p,onChange:E=>u(E.target.value),placeholder:"Enter your name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 mb-1.5 tracking-wide ml-1",children:"Email Address"}),o.jsx("input",{type:"email",required:!0,className:"w-full p-3 md:p-4 bg-slate-50 border border-slate-200 rounded-xl outline-none font-medium text-slate-700 focus:ring-2 focus:ring-indigo-100 transition-all text-sm",value:f,onChange:E=>m(E.target.value.toLowerCase()),placeholder:"email@company.com"})]}),v&&o.jsx("div",{className:"p-3 bg-rose-50 text-rose-600 text-xs font-medium rounded-lg border border-rose-100",children:v}),o.jsxs("div",{className:"pt-4 flex flex-col gap-2",children:[o.jsx("button",{type:"submit",className:"w-full py-4 bg-slate-900 hover:bg-black text-white font-semibold rounded-xl uppercase tracking-widest text-xs shadow-lg active:scale-[0.98] transition-all",children:"Update Profile"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:w,className:"flex-1 py-3 text-slate-400 hover:text-slate-600 font-semibold text-[10px] uppercase tracking-wider transition-colors",children:"Setup Later"}),s&&o.jsx("button",{type:"button",onClick:s,className:"flex-1 py-3 text-rose-500 hover:text-rose-600 font-semibold text-[10px] uppercase tracking-wider",children:"Sign Out"})]})]})]})]}),i===1&&o.jsxs("div",{className:"animate-fadeIn w-full max-w-sm mx-auto",children:[o.jsxs("div",{className:"mb-6 md:mb-10",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-800 tracking-tight",children:"Security Access"}),o.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Set your master password for future logins."})]}),o.jsxs("form",{onSubmit:_,className:"space-y-4 md:space-y-5",children:[o.jsx("input",{type:"password",autoFocus:!0,required:!0,className:"w-full p-3 md:p-4 bg-slate-50 border border-slate-200 rounded-xl outline-none font-medium text-slate-700 focus:ring-2 focus:ring-indigo-100 transition-all text-sm",value:h,onChange:E=>g(E.target.value),placeholder:"New Password"}),o.jsx("input",{type:"password",required:!0,className:"w-full p-3 md:p-4 bg-slate-50 border border-slate-200 rounded-xl outline-none font-medium text-slate-700 focus:ring-2 focus:ring-indigo-100 transition-all text-sm",value:x,onChange:E=>y(E.target.value),placeholder:"Confirm Password"}),v&&o.jsx("div",{className:"p-3 bg-rose-50 text-rose-600 text-xs font-medium rounded-lg border border-rose-100",children:v}),o.jsx("button",{type:"submit",className:"w-full py-4 bg-slate-900 hover:bg-black text-white font-semibold rounded-xl uppercase tracking-widest text-xs shadow-lg active:scale-[0.98] transition-all mt-4",children:"Finalize Security"})]})]}),i===2&&o.jsxs("div",{className:"animate-fadeIn w-full max-w-sm mx-auto flex flex-col justify-center",children:[o.jsxs("div",{className:"mb-6 md:mb-10",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-800 tracking-tight",children:"Alert Preferences"}),o.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Configure your automated notification streams."})]}),o.jsxs("div",{className:"space-y-3 mb-8",children:[o.jsxs("label",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors",children:[o.jsx("span",{className:"text-xs font-semibold text-slate-700 uppercase tracking-tight",children:"System Email Alerts"}),o.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-slate-300 text-indigo-600",checked:I.emailNotifications,onChange:()=>N(E=>({...E,emailNotifications:!E.emailNotifications}))})]}),o.jsx("div",{className:`grid grid-cols-2 gap-2 transition-opacity duration-300 ${!I.emailNotifications&&"opacity-30 pointer-events-none"}`,children:[{k:"notifyGeneral",l:"General"},{k:"notifyPetroleum",l:"Petro V1"},{k:"notifyPetroleumV2",l:"Petro V2"},{k:"notifyAcid",l:"Acid"}].map(E=>o.jsxs("label",{className:"flex items-center justify-between p-3 bg-white border border-slate-100 rounded-xl cursor-pointer hover:border-indigo-200 transition-all shadow-sm",children:[o.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase",children:E.l}),o.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-indigo-600",checked:I[E.k],onChange:()=>N(S=>({...S,[E.k]:!S[E.k]}))})]},E.k))})]}),v&&o.jsx("div",{className:"p-3 bg-rose-50 text-rose-600 text-xs font-medium rounded-lg mb-6 border border-rose-100",children:v}),o.jsx("button",{onClick:C,disabled:c,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-xl uppercase tracking-widest text-xs flex items-center justify-center gap-2 shadow-lg active:scale-[0.98] transition-all",children:c?o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Complete Registration"})]}),i===3&&o.jsxs("div",{className:"text-center animate-fadeIn w-full max-w-sm mx-auto py-8",children:[o.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-emerald-50 rounded-full flex items-center justify-center mx-auto mb-8 border border-emerald-100 text-emerald-600",children:o.jsx("svg",{className:"w-8 h-8 md:w-10 md:h-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}),o.jsx("h2",{className:"text-xl md:text-2xl font-bold text-slate-800 mb-2",children:"Verified Successfully"}),o.jsx("p",{className:"text-slate-500 text-sm mb-10 leading-relaxed",children:"Your workspace provisioning is complete. You now have full access to the inspection portal."}),o.jsx("button",{onClick:()=>n({...t,username:f,name:p,preferences:I,needsSetup:!1}),className:"w-full py-5 bg-slate-900 hover:bg-black text-white font-bold rounded-2xl uppercase tracking-[0.2em] text-xs shadow-xl active:scale-[0.98] transition-all",children:"Enter Dashboard"})]})]})]})})},De=[{targetId:"system-mgmt-section",title:"Central Control",description:"Manage your staff, fleet registry, and global system settings from this primary control hub.",position:"bottom"},{targetId:"inspection-forms-section",title:"Inspection Hub",description:"Choose from various specialized inspection modules. All reports are synced to Google Sheets in real-time.",position:"bottom"},{targetId:"notification-bell",title:"Live Alerts",description:"Real-time notifications for critical vehicle failures and automated safety broadcasts.",position:"bottom"},{targetId:"profile-trigger",title:"User Profile",description:"Update your password, manage email alert preferences, or sign out of your session here.",position:"bottom"}],mf=({onComplete:t})=>{const[e,n]=T.useState(0),[s,i]=T.useState({}),[a,c]=T.useState({});T.useEffect(()=>{const u=()=>{const m=De[e],h=document.getElementById(m.targetId);if(h){const g=h.getBoundingClientRect();i({position:"fixed",top:g.top-4,left:g.left-4,width:g.width+8,height:g.height+8,borderRadius:"12px",boxShadow:"0 0 0 9999px rgba(15, 23, 42, 0.85)",zIndex:150,pointerEvents:"none",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"});const x=Math.min(340,window.innerWidth*.85);let y=g.bottom+16,v=g.left+g.width/2-x/2;y+250>window.innerHeight&&(y=g.top-220),v+x>window.innerWidth-20&&(v=window.innerWidth-x-20),v<20&&(v=20),c({position:"fixed",top:Math.max(20,y),left:v,width:x,zIndex:151,transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"})}else i({display:"none"}),c({position:"fixed",top:"50%",left:"50%",width:Math.min(340,window.innerWidth*.85),transform:"translate(-50%, -50%)",zIndex:151})},f=setTimeout(u,150);return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u),clearTimeout(f)}},[e]);const d=()=>{e<De.length-1?n(u=>u+1):t()},p=De[e];return o.jsxs("div",{className:"fixed inset-0 z-[140] overflow-hidden pointer-events-none",children:[o.jsx("div",{style:s,className:"ring-2 ring-indigo-400 animate-pulse"}),o.jsxs("div",{className:"bg-white rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.3)] p-6 sm:p-8 animate-fadeIn border border-slate-100 pointer-events-auto flex flex-col",style:a,children:[o.jsxs("div",{className:"flex justify-between items-center mb-5 shrink-0",children:[o.jsxs("span",{className:"text-[10px] font-black text-white bg-indigo-600 px-3 py-1.5 rounded-full uppercase tracking-widest shadow-sm",children:["Tip ",e+1," / ",De.length]}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors p-1.5 hover:bg-slate-50 rounded-lg",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"flex-1 overflow-visible",children:[o.jsx("h3",{className:"text-lg sm:text-xl font-black text-slate-800 mb-3 uppercase tracking-tight leading-tight",children:p.title}),o.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium break-words",children:p.description})]}),o.jsxs("div",{className:"flex justify-between items-center pt-6 mt-6 border-t border-slate-50 shrink-0",children:[o.jsx("div",{className:"flex gap-2",children:De.map((u,f)=>o.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${f===e?"bg-indigo-600 w-6":"bg-slate-100 w-1.5"}`},f))}),o.jsxs("button",{onClick:d,className:"px-6 py-3 bg-slate-900 hover:bg-black text-white text-[10px] font-black rounded-xl shadow-lg transition-all active:scale-95 flex items-center gap-2 uppercase tracking-widest",children:[e===De.length-1?"Start Working":"Next Tip",o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M9 5l7 7-7 7"})})]})]})]})]})},hf=()=>{const[t,e]=T.useState(null),[n,s]=T.useState(!1),[i,a]=T.useState(!1);T.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)return;const u=localStorage.getItem("sc_install_dismissed");if(u){const h=new Date(parseInt(u)),x=Math.abs(new Date().getTime()-h.getTime());if(Math.ceil(x/(1e3*60*60*24))<7)return}const f=window.navigator.userAgent.toLowerCase(),m=/iphone|ipad|ipod/.test(f);if(a(m),m)setTimeout(()=>s(!0),3e3);else{const h=g=>{g.preventDefault(),e(g),s(!0)};return window.addEventListener("beforeinstallprompt",h),()=>{window.removeEventListener("beforeinstallprompt",h)}}},[]);const c=async()=>{if(!t)return;t.prompt();const{outcome:p}=await t.userChoice;p==="accepted"&&s(!1),e(null)},d=()=>{s(!1),localStorage.setItem("sc_install_dismissed",Date.now().toString())};return n?o.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-[9999] md:left-auto md:right-4 md:w-96 animate-fadeIn",children:o.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-md text-white p-4 rounded-2xl shadow-2xl border border-slate-700 flex flex-col gap-4",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"bg-white/10 p-2.5 rounded-xl shrink-0",children:o.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/716/716766.png",alt:"Logo",className:"w-8 h-8 object-contain"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-bold text-sm",children:"Install SafetyCheck Pro"}),o.jsx("p",{className:"text-xs text-slate-300 mt-1 leading-relaxed",children:"Add to your home screen for offline access, full-screen view, and faster performance."})]}),o.jsx("button",{onClick:d,className:"text-slate-400 hover:text-white p-1",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i?o.jsxs("div",{className:"bg-white/10 rounded-lg p-3 text-xs text-slate-300 flex items-center gap-3",children:[o.jsx("span",{className:"text-xl",children:"👉"}),o.jsxs("span",{children:["Tap the ",o.jsx("span",{className:"font-bold text-white",children:"Share"})," button below and select ",o.jsx("span",{className:"font-bold text-white",children:'"Add to Home Screen"'})," [+]"]})]}):o.jsxs("button",{onClick:c,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl text-sm transition-colors shadow-lg flex items-center justify-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Install App"]})]})}):null},gf=({label:t,icon:e,onClick:n})=>o.jsxs("button",{onClick:n,className:"flex flex-col items-center justify-center p-3 sm:p-6 bg-slate-50 border border-slate-100 rounded-[1.5rem] sm:rounded-[2rem] hover:bg-white hover:shadow-xl hover:border-indigo-100 transition-all group active:scale-95 text-center min-h-[100px] sm:min-h-[160px]",children:[o.jsx("div",{className:"mb-2 sm:mb-4 text-slate-400 group-hover:text-indigo-600 transition-colors scale-75 sm:scale-100",children:e}),o.jsx("span",{className:"text-[8px] sm:text-[10px] font-black text-slate-600 group-hover:text-slate-900 uppercase tracking-widest leading-tight px-1",children:t})]}),xf=({isOpen:t,onClose:e,onAction:n})=>{const s=[{id:"HR & PAYROLL",label:"HR & PAYROLL",icon:o.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:[o.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 010 7.75"})]})},{id:"FLEET MAINTENANCE SOFTWARE",label:"FLEET MAINTENANCE SOFTWARE",icon:o.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:[o.jsx("path",{d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]})},{id:"DRIVER MANAGEMENT SYSTEM",label:"DRIVER MANAGEMENT SYSTEM",icon:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},{id:"FLEET PLANNING SYSTEM",label:"FLEET PLANNING SYSTEM",icon:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})},{id:"INCIDENT MANAGEMENT SYSTEM",label:"INCIDENT MANAGEMENT SYSTEM",icon:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})},{id:"FINANCE TICKETING SYSTEM",label:"FINANCE TICKETING SYSTEM",icon:o.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:[o.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),o.jsx("path",{d:"M16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"})]})},{id:"AUTOMATED GATE PASS",label:"AUTOMATED GATE PASS",icon:o.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})},{id:"FUEL PRO RECONCILIATION",label:"FUEL PRO RECONCILIATION",icon:o.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:[o.jsx("path",{d:"M3 22V2h11l7 7v13H3z"}),o.jsx("path",{d:"M14 2v7h7"}),o.jsx("path",{d:"M7 13h10M7 17h10"})]})}];return o.jsxs("div",{className:"fixed inset-0 z-[200] animate-fadeIn flex items-end sm:items-center justify-center p-0 sm:p-4 no-print",children:[o.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md",onClick:e}),o.jsx("div",{className:"relative bg-white w-full max-w-4xl rounded-t-[2.5rem] sm:rounded-[3rem] shadow-2xl overflow-hidden animate-slideUp",children:o.jsxs("div",{className:"p-6 sm:p-12",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6 sm:mb-12",children:[o.jsx("div",{children:o.jsx("h2",{className:"text-xl sm:text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:"Enterprise Solutions"})}),o.jsx("button",{onClick:e,className:"p-2 sm:p-3 hover:bg-slate-100 rounded-2xl transition-all",children:o.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-6",children:s.map(i=>o.jsx(gf,{label:i.label,icon:i.icon,onClick:()=>n(`support:info:${i.id}`)},i.id))}),o.jsx("div",{className:"mt-6 sm:mt-12 text-center pb-4 sm:pb-0",children:o.jsx("p",{className:"text-[8px] sm:text-[10px] text-slate-300 font-bold uppercase tracking-[0.3em]",children:"Proprietary Modular Framework v4.0"})})]})})]})},vf=({onLogin:t,appScriptUrl:e,setAppScriptUrl:n,settings:s})=>{const[i,a]=T.useState(""),[c,d]=T.useState(""),[p,u]=T.useState(!1),[f,m]=T.useState(!1),[h,g]=T.useState(""),[x,y]=T.useState(!1),[v,b]=T.useState(""),[I,N]=T.useState(""),[A,_]=T.useState(!1),[w,C]=T.useState(!1),[k,E]=T.useState(e);T.useEffect(()=>{const M=localStorage.getItem("sc_remembered_creds");if(M)try{const{u:G,p:z}=JSON.parse(atob(M));a(G),d(z),u(!0)}catch{localStorage.removeItem("sc_remembered_creds")}},[]);const S=async M=>{if(M.preventDefault(),!e||!e.startsWith("https://script.google.com")){g("System connection required. Click the gear icon below."),C(!0);return}g(""),m(!0);try{const F=await(await fetch(e,{method:"POST",body:JSON.stringify(x?{action:"register_user",username:i,password:c,name:v,position:I,role:"SuperAdmin"}:{action:"login",username:i,password:c})})).json();if(F.status==="success"){const V=F.user;if(p&&c){const W=btoa(JSON.stringify({u:i,p:c}));localStorage.setItem("sc_remembered_creds",W)}else localStorage.removeItem("sc_remembered_creds");if(x)g("Admin created. Please sign in."),y(!1),b(""),N(""),d("");else{let W="Inspector";const B=V.role?String(V.role).trim().toLowerCase():"";B==="superadmin"?W="SuperAdmin":B==="admin"?W="Admin":B==="operations"?W="Operations":B==="maintenance"?W="Maintenance":B==="other"&&(W="Other"),t({...V,role:W,position:V.position||"",needsSetup:!V.name})}}else F.code==="NO_USERS"?(g("Initial setup: Create administrator."),y(!0)):g(F.message||"Sign in failed.")}catch{g("Cannot reach server. Check internet and URL.")}finally{m(!1)}},R=()=>{k.startsWith("https://script.google.com")?(n(k),localStorage.setItem("safetyCheck_scriptUrl",k),C(!1),g("")):alert("Invalid URL. Must be a Google Apps Script endpoint.")},U=e&&e.startsWith("https://script.google.com");return o.jsxs("div",{className:"h-screen w-full bg-slate-100 flex flex-col md:flex-row font-sans text-slate-700 overflow-hidden",children:[o.jsxs("div",{className:"w-full md:w-[35%] lg:w-[30%] bg-slate-900 p-6 md:p-12 flex flex-col justify-between shrink-0 border-b md:border-none shadow-xl z-10",children:[o.jsxs("div",{className:"flex md:block items-center justify-between",children:[o.jsx("div",{className:"bg-white p-2 rounded-xl inline-block",children:s.companyLogo&&!A?o.jsx("img",{src:s.companyLogo,alt:"Logo",className:"h-6 sm:h-10 w-auto object-contain",onError:()=>_(!0)}):o.jsx("div",{className:"flex items-center gap-1.5 px-2",children:o.jsx("span",{className:"font-bold text-slate-900 text-lg uppercase tracking-tight",children:"SafetyCheck"})})}),o.jsxs("div",{className:"md:mt-10 text-right md:text-left",children:[o.jsx("h1",{className:"text-lg sm:text-2xl font-semibold text-white leading-tight uppercase",children:s.companyName||"Fleet Portal"}),o.jsx("p",{className:"text-slate-400 font-medium uppercase tracking-widest text-[9px] mt-1",children:"Vehicle Inspection System"})]})]}),o.jsxs("div",{className:"mt-4 space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${f?"bg-blue-400 animate-pulse":U?"bg-emerald-500":"bg-rose-500"}`}),o.jsx("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-widest",children:f?"Processing":U?"System Ready":"Connection Error"})]}),o.jsx("div",{className:"hidden sm:block pt-4 border-t border-white/5",children:o.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:"© 2026 Fleet Safety"})})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col bg-white overflow-hidden relative justify-center px-6",children:[o.jsxs("div",{className:"w-full max-w-sm mx-auto",children:[o.jsxs("div",{className:"mb-8 text-center md:text-left",children:[o.jsx("h2",{className:"text-2xl font-semibold text-slate-800 tracking-tight",children:x?"Setup Admin":"Welcome Back"}),o.jsx("p",{className:"text-slate-500 text-sm mt-1",children:x?"Create your master account.":"Sign in to your inspection portal."})]}),h&&o.jsx("div",{className:`mb-6 p-4 rounded-xl text-xs font-medium border animate-fadeIn
              ${h.includes("created")?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-rose-50 text-rose-700 border-rose-100"}`,children:h}),o.jsxs("form",{onSubmit:S,className:"space-y-4",children:[x&&o.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 rounded-xl border border-slate-100",children:[o.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-lg text-sm font-medium outline-none",value:v,onChange:M=>b(M.target.value),placeholder:"Full Name"}),o.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-3 bg-white border border-slate-200 rounded-lg text-sm font-medium outline-none",value:I,onChange:M=>N(M.target.value),placeholder:"Job Title"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{type:"email",required:!0,className:"w-full px-4 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-slate-100 outline-none font-medium text-sm",value:i,onChange:M=>a(M.target.value),placeholder:"Email Address"}),o.jsx("input",{type:"password",required:!0,className:"w-full px-4 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-slate-100 outline-none font-medium text-sm",value:c,onChange:M=>d(M.target.value),placeholder:"Password"})]}),o.jsx("div",{className:"flex items-center justify-between px-1 pt-1",children:o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-slate-800",checked:p,onChange:M=>u(M.target.checked)}),o.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Keep me signed in"})]})}),o.jsx("div",{className:"pt-4",children:o.jsx("button",{type:"submit",disabled:f||!U,className:"w-full py-4 rounded-xl font-semibold text-white bg-slate-800 hover:bg-slate-900 transition-all text-sm disabled:bg-slate-200 disabled:text-slate-400 shadow-md",children:f?"Processing...":x?"Register Admin":"Sign In"})})]})]}),o.jsx("button",{onClick:()=>C(!w),className:"absolute bottom-6 right-6 p-3 text-slate-300 hover:text-slate-600 transition-colors",children:o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),w&&o.jsx("div",{className:"absolute inset-0 bg-white/95 backdrop-blur-sm z-20 flex flex-col items-center justify-center p-8 animate-fadeIn",children:o.jsxs("div",{className:"w-full max-w-sm space-y-6",children:[o.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Connection Endpoint"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Script URL"}),o.jsx("input",{type:"text",className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl text-xs font-mono outline-none",placeholder:"https://script.google.com/...",value:k,onChange:M=>E(M.target.value)})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-3 text-xs font-semibold text-slate-500 hover:bg-slate-50 rounded-xl",children:"Cancel"}),o.jsx("button",{onClick:R,className:"flex-1 py-3 bg-slate-800 text-white font-semibold rounded-xl text-xs",children:"Apply"})]})]})})]})]})},Dt=({label:t})=>o.jsxs("div",{className:"w-full flex items-center gap-4 mb-6 opacity-60",children:[o.jsx("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-widest whitespace-nowrap",children:t}),o.jsx("div",{className:"h-px flex-1 bg-slate-200"})]}),yf=({settings:t,setSettings:e,handleSaveSettings:n,isSavingSettings:s,user:i,showToast:a})=>{const[c,d]=T.useState(!1),p=T.useRef(null);T.useEffect(()=>{d(!1)},[t.companyLogo]);const u=i?.role==="SuperAdmin"||i?.role==="Admin",f=g=>{const x=g.target.files?.[0];if(!x)return;if(x.size>1*1024*1024){a("Logo must be under 1MB","error");return}const y=new FileReader;y.onload=v=>{const b=v.target?.result;e(I=>({...I,companyLogo:b})),a("Logo updated","success")},y.readAsDataURL(x)},m="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-700 outline-none focus:ring-2 focus:ring-indigo-100 focus:bg-white transition-all disabled:opacity-50",h="block text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1.5 ml-1";return o.jsxs("div",{className:"max-w-4xl mx-auto py-4 sm:py-8 space-y-8 animate-fadeIn px-2",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-slate-800 tracking-tight uppercase",children:"Application Settings"}),o.jsx("p",{className:"text-xs text-slate-400 font-medium mt-1",children:"Configure your workspace and organization details"})]}),!u&&o.jsx("div",{className:"px-3 py-1 bg-amber-50 border border-amber-100 rounded-lg",children:o.jsx("span",{className:"text-[10px] font-bold text-amber-600 uppercase",children:"Read-Only"})})]}),o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-2xl border border-slate-200 shadow-sm space-y-10",children:[o.jsxs("section",{children:[o.jsx(Dt,{label:"Organization"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:h,children:"Organization Name"}),o.jsx("input",{type:"text",disabled:!u,value:t.companyName,onChange:g=>e(x=>({...x,companyName:g.target.value})),className:m,placeholder:"Enter company name"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:h,children:"Admin Contact Email"}),o.jsx("input",{type:"email",disabled:!u,value:t.managerEmail,onChange:g=>e(x=>({...x,managerEmail:g.target.value})),className:m,placeholder:"admin@company.com"})]})]})]}),o.jsxs("section",{children:[o.jsx(Dt,{label:"System Links"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:h,children:"Web Portal URL"}),o.jsx("input",{type:"url",disabled:!u,value:t.webAppUrl||"",onChange:g=>e(x=>({...x,webAppUrl:g.target.value})),placeholder:"https://app.fleetpro.com",className:m})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:h,children:"Mobile App (APK) Link"}),o.jsx("input",{type:"url",disabled:!u,value:t.mobileApkLink||"",onChange:g=>e(x=>({...x,mobileApkLink:g.target.value})),placeholder:"Download link for mobile app",className:m})]})]})]}),o.jsxs("section",{children:[o.jsx(Dt,{label:"Branding"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("label",{className:h,children:"Company Logo"}),o.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:p,onChange:f,disabled:!u}),o.jsxs("button",{onClick:()=>p.current?.click(),disabled:!u,className:"w-full py-8 bg-slate-50 border border-dashed border-slate-300 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-slate-100 transition-all disabled:opacity-50",children:[o.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),o.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wide",children:"Upload Image"})]})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{className:h,children:"Preview"}),o.jsx("div",{className:"w-full h-32 bg-slate-50 rounded-xl border border-slate-200 flex items-center justify-center p-4",children:t.companyLogo&&!c?o.jsx("img",{src:t.companyLogo,alt:"Preview",className:"max-h-full object-contain grayscale opacity-50",onError:()=>d(!0)}):o.jsx("span",{className:"text-[10px] font-bold text-slate-300 uppercase",children:"No Logo"})})]})]})]}),u&&o.jsx("div",{className:"pt-6 border-t border-slate-100 flex justify-end",children:o.jsx("button",{onClick:n,disabled:s,className:"w-full sm:w-auto px-10 py-3.5 bg-slate-800 hover:bg-slate-900 text-white font-semibold rounded-xl shadow-md transition-all active:scale-[0.98] disabled:opacity-50 text-sm",children:s?"Saving Changes...":"Save Configuration"})})]})]})},bf=({isLocked:t,children:e,isSuperAdmin:n,onUnlock:s,lockReason:i="license",maintenanceMessage:a})=>o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`transition-all duration-500 ${t?"opacity-40 pointer-events-none select-none grayscale":""}`,children:e}),t&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl shadow-2xl p-6 max-w-sm w-full text-center transform scale-100 animate-fadeIn",children:[o.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4 shadow-inner ${i==="maintenance"?"bg-amber-100":"bg-red-100"}`,children:i==="maintenance"?o.jsx("svg",{className:"w-7 h-7 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):o.jsx("svg",{className:"w-7 h-7 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("h2",{className:"text-xl font-black text-slate-800 mb-1",children:"Action Restricted"}),o.jsx("div",{className:"text-[11px] text-slate-500 mb-4 leading-relaxed",children:i==="maintenance"?o.jsxs("p",{children:["System is in ",o.jsx("strong",{children:"View-Only"})," mode for scheduled maintenance.",o.jsx("br",{}),o.jsxs("span",{className:"text-slate-400 mt-1 block italic",children:['"',a||"Updating core services...",'"']})]}):o.jsxs("p",{children:["System is in ",o.jsx("strong",{children:"View-Only"})," mode because the license has expired. No new records or updates can be added."]})}),n&&i==="license"?o.jsx("button",{onClick:s,className:"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl transition-all shadow-lg shadow-red-200 flex items-center justify-center gap-2 text-xs uppercase tracking-widest",children:"Manage License"}):n&&i==="maintenance"?o.jsx("button",{onClick:s,className:"w-full py-3 bg-slate-900 hover:bg-black text-white font-bold rounded-xl transition-all shadow-lg flex items-center justify-center gap-2 text-xs uppercase tracking-widest",children:"Security Console"}):o.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-xl p-3",children:o.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest leading-normal",children:i==="maintenance"?"Please check back later once maintenance is complete.":"Please notify your supervisor to restore full administrative access."})})]})})]}),At=({title:t,description:e,icon:n,stats:s,startNewInspection:i,fetchHistory:a,isLoadingHistory:c,historyList:d,onViewReport:p,userRole:u,isLocked:f=!1,lockReason:m="license",maintenanceMessage:h})=>{const[g,x]=T.useState(""),y=T.useMemo(()=>{let I=d;if(g.trim()){const N=g.toLowerCase();I=I.filter(A=>A.truckNo&&A.truckNo.toLowerCase().includes(N)||A.driverName&&A.driverName.toLowerCase().includes(N)||A.inspectedBy&&A.inspectedBy.toLowerCase().includes(N))}else I=I.slice(0,15);return I},[d,g]),v=u==="SuperAdmin",b=(u==="Admin"||u==="Inspector"||u==="SuperAdmin")&&!f;return o.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 animate-fadeIn py-1",children:[o.jsx(bf,{isLocked:f,lockReason:m,maintenanceMessage:h,isSuperAdmin:v,children:o.jsxs("div",{className:"bg-white rounded-[2rem] p-6 sm:p-8 border border-slate-100 shadow-sm flex flex-col md:flex-row justify-between items-center gap-6 sm:gap-8",children:[o.jsxs("div",{className:"flex-1 w-full",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("span",{className:"p-2.5 rounded-2xl bg-slate-50 text-slate-600 shadow-inner",children:n}),o.jsx("h2",{className:"text-xl sm:text-2xl font-medium text-slate-800 tracking-tight uppercase",children:t})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-6",children:[b&&o.jsxs("button",{onClick:i,className:"px-7 py-3.5 bg-slate-900 hover:bg-black text-white text-[10px] font-black rounded-2xl transition-all flex items-center justify-center gap-3 uppercase tracking-[0.2em] shadow-lg active:scale-95 border-t border-white/10",children:[o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M12 4v16m8-8H4"})}),"Start Inspection"]}),o.jsxs("button",{onClick:()=>a(!0),disabled:c,className:"px-6 py-3.5 bg-white border border-slate-200 text-slate-500 text-[10px] font-bold rounded-2xl hover:bg-slate-50 transition-all flex items-center justify-center gap-2.5 uppercase tracking-widest active:scale-95 shadow-sm disabled:opacity-50",children:[o.jsx("svg",{className:`w-4 h-4 ${c?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync Hub"]})]})]}),o.jsxs("div",{className:"flex gap-3 sm:gap-5 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex-1 sm:flex-none bg-slate-50 rounded-[1.5rem] p-4 sm:p-5 text-center min-w-[90px] border border-slate-100 shadow-inner",children:[o.jsx("div",{className:"text-2xl sm:text-3xl font-medium text-slate-800 leading-none",children:s.total}),o.jsx("div",{className:"text-[8px] sm:text-[9px] text-slate-400 uppercase font-medium tracking-[0.2em] mt-2",children:"Logs"})]}),o.jsxs("div",{className:"flex-1 sm:flex-none bg-emerald-50 rounded-[1.5rem] p-4 sm:p-5 text-center min-w-[90px] border border-emerald-100 shadow-inner",children:[o.jsxs("div",{className:"text-2xl sm:text-3xl font-medium text-emerald-600 leading-none",children:[s.passRate,"%"]}),o.jsx("div",{className:"text-[8px] sm:text-[9px] text-slate-400 uppercase font-medium tracking-[0.2em] mt-2",children:"Pass"})]})]})]})}),o.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 overflow-hidden shadow-sm flex flex-col min-h-0",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-slate-50 flex flex-col sm:flex-row justify-between items-center bg-slate-50/30 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 self-start",children:[o.jsx("h3",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-[0.3em]",children:"Inspection History"}),f&&o.jsx("span",{className:"text-[8px] font-black text-rose-600 bg-rose-50 px-2 py-0.5 rounded border border-rose-100 uppercase",children:"View Only"})]}),o.jsxs("div",{className:"relative w-full sm:w-auto",children:[o.jsx("svg",{className:"w-3.5 h-3.5 absolute left-3 top-1/2 -translate-y-1/2 text-slate-300 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),o.jsx("input",{type:"text",placeholder:"Search logs...",value:g,onChange:I=>x(I.target.value),className:"w-full sm:w-60 pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-xl text-[11px] outline-none font-normal focus:ring-4 focus:ring-indigo-50/50 transition-all"})]})]}),o.jsx("div",{className:"flex-1 overflow-hidden",children:c?o.jsxs("div",{className:"py-24 text-center",children:[o.jsx("div",{className:"w-8 h-8 border-4 border-slate-100 border-t-slate-900 rounded-full animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-[9px] font-semibold text-slate-300 uppercase tracking-[0.3em]",children:"Downloading archive"})]}):y.length===0?o.jsx("div",{className:"py-24 text-center text-[10px] font-medium text-slate-300 uppercase tracking-[0.3em]",children:"Archive is empty"}):o.jsx("div",{className:"divide-y divide-slate-50",children:y.map((I,N)=>o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center px-6 py-4 hover:bg-slate-50/50 transition-colors gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[o.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-xl text-sm font-black text-white shadow-sm shrink-0
                                        ${Number(I.rate)>=4?"bg-emerald-500":Number(I.rate)===3?"bg-amber-500":"bg-rose-500"}
                                    `,children:I.rate}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"font-semibold text-slate-800 text-sm truncate uppercase tracking-tight",children:I.truckNo}),o.jsx("div",{className:"text-[10px] text-slate-400 font-medium truncate uppercase tracking-wider",children:I.trailerNo||"Solo Unit"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:items-center gap-4 sm:gap-10 shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-7 h-7 rounded-lg bg-slate-100 flex items-center justify-center text-[9px] font-bold text-slate-400 border border-slate-200 uppercase shrink-0",children:String(I.inspectedBy||"?").charAt(0)}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"text-[10px] font-bold text-slate-600 truncate",children:I.inspectedBy}),o.jsx("div",{className:"text-[8px] text-slate-400 uppercase tracking-widest",children:"Auditor"})]})]}),o.jsxs("div",{className:"text-right sm:text-left",children:[o.jsx("div",{className:"text-[10px] font-bold text-slate-600",children:new Date(I.timestamp).toLocaleDateString()}),o.jsx("div",{className:"text-[8px] text-slate-400 uppercase tracking-widest",children:new Date(I.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),o.jsx("div",{className:"sm:ml-4 border-t sm:border-t-0 border-slate-50 pt-3 sm:pt-0 shrink-0",children:o.jsxs("button",{onClick:()=>p(I),className:"w-full sm:w-auto inline-flex items-center justify-center gap-2 px-6 py-2.5 text-[10px] font-bold text-indigo-600 bg-indigo-50 hover:bg-indigo-600 hover:text-white rounded-xl transition-all uppercase tracking-widest border border-indigo-100 shadow-sm",children:[o.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:[o.jsx("path",{d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Report"]})})]},N))})})]})]})},Nf=t=>o.jsx(At,{...t,title:"General Inspection",description:"",icon:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),colorTheme:"slate",titlePrefix:"VEHICLE INSPECTION"}),wf=t=>o.jsx(At,{...t,title:"Petroleum V1 Inspection",description:"",icon:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),colorTheme:"orange",titlePrefix:"PETROLEUM INSPECTION"}),Sf=t=>o.jsx(At,{...t,title:"Petroleum V2 Inspection",description:"",icon:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),colorTheme:"rose",titlePrefix:"PETROLEUM V2 INSPECTION"}),Cf=t=>o.jsx(At,{...t,title:"Acid Inspection",description:"",icon:o.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M12 2l-5.5 9h11z"}),o.jsx("path",{d:"M10 13v6h4v-6z"})]}),colorTheme:"purple",titlePrefix:"ACID TANKER INSPECTION"}),Ie=({label:t,value:e,onChange:n,options:s=[],placeholder:i,isRegNo:a,isTitleCase:c,readOnly:d,error:p})=>{const[u,f]=T.useState(!1),[m,h]=T.useState(-1),g=T.useRef(null),x=T.useRef(null),y=s.filter(N=>N!=null&&String(N).toLowerCase().includes((e||"").toLowerCase()));T.useEffect(()=>{function N(A){g.current&&!g.current.contains(A.target)&&f(!1)}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[g]);const v=N=>{if(d)return;let A=N.target.value;if(a){A=A.toUpperCase();let _=A.replace(/[^A-Z0-9]/g,"");_=_.replace(/([A-Z])(\d)/g,"$1 $2"),_=_.replace(/(\d)([A-Z])/g,"$1 $2"),A=_}c&&!a&&(A=A.replace(/\b\w/g,_=>_.toUpperCase())),n(A),f(!0),h(-1)},b=N=>{d||(n(String(N)),f(!1),h(-1))},I=N=>{d||(N.key==="ArrowDown"?(N.preventDefault(),h(A=>Math.min(A+1,y.length-1))):N.key==="ArrowUp"?(N.preventDefault(),h(A=>Math.max(A-1,0))):N.key==="Enter"?(N.preventDefault(),m>=0&&y[m]?b(y[m]):b(e)):N.key==="Escape"&&f(!1))};return o.jsxs("div",{className:"relative",ref:g,children:[o.jsxs("label",{className:`block text-xs font-bold uppercase mb-1.5 tracking-wide flex justify-between ${p?"text-red-600":"text-gray-500"}`,children:[t,d&&o.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded flex items-center gap-1",children:[o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Verified"]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{ref:x,type:"text",value:e,onChange:v,onFocus:()=>!d&&f(!0),onKeyDown:I,placeholder:i,readOnly:d,className:`w-full p-3.5 border rounded-lg transition-all font-medium 
             ${d?"bg-gray-100 border-gray-200 text-gray-500 cursor-not-allowed focus:outline-none":p?"bg-red-50 border-red-300 focus:ring-2 focus:ring-red-200 text-red-900 placeholder-red-300":"bg-gray-50 border-gray-200 focus:ring-2 focus:ring-blue-500 focus:bg-white text-gray-800 placeholder-gray-400"}
          `}),o.jsx("div",{className:`absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none ${p?"text-red-400":"text-gray-400"}`,children:d?o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):p?o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),p&&o.jsx("p",{className:"text-[10px] text-red-500 font-bold mt-1 ml-1 animate-fadeIn",children:"This field is required"}),!d&&u&&(e.length>0||y.length>0)&&o.jsx("ul",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:y.length>0?y.map((N,A)=>o.jsxs("li",{onClick:()=>b(N),className:`px-4 py-2.5 text-sm cursor-pointer transition-colors border-b border-gray-50 last:border-none flex justify-between items-center
                  ${A===m?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"}
                `,children:[N,a&&o.jsx("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded border border-gray-200",children:"EXISTING"})]},A)):o.jsxs("li",{onMouseDown:N=>{N.preventDefault(),b(e)},className:"px-4 py-3 text-sm text-blue-600 bg-blue-50 cursor-pointer font-medium flex items-center gap-2 hover:bg-blue-100 transition-colors",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),'Add New Entry: "',e,'"']})})]})},Xs=({label:t})=>o.jsxs("div",{className:"w-full flex items-center gap-4 mb-4 sm:mb-6 opacity-70 shrink-0",children:[o.jsx("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-[0.3em] whitespace-nowrap",children:t}),o.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-slate-100 to-transparent"})]}),Ef=({currentUser:t,appScriptUrl:e,showToast:n,validationLists:s,settings:i})=>{const[a,c]=T.useState([]),[d,p]=T.useState(!1),[u,f]=T.useState("list"),[m,h]=T.useState(!1),[g,x]=T.useState(""),[y,v]=T.useState({name:"",username:"",password:"",role:"Inspector",position:""}),[b,I]=T.useState(!1),N=t.role==="SuperAdmin",A=t.role==="Admin"||N;if(T.useEffect(()=>{A&&_()},[A]),!A)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center font-sans min-h-[50vh]",children:[o.jsx("div",{className:"w-12 h-12 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("h3",{className:"text-lg font-medium text-slate-800 tracking-tight uppercase",children:"Access Restricted"}),o.jsx("p",{className:"text-slate-400 max-w-xs mt-1 text-[9px] font-medium uppercase tracking-widest leading-relaxed",children:"Admin clearance required."})]});const _=async(S=!1)=>{if(e){p(!0);try{const U=await(await fetch(e,{method:"POST",body:JSON.stringify({action:"get_users"})})).json();U.status==="success"&&Array.isArray(U.users)&&c(U.users)}catch{n("Failed to load users","error")}finally{p(!1)}}},w=async S=>{if(window.confirm(`Remove user "${S}"?`)){p(!0);try{const U=await(await fetch(e,{method:"POST",body:JSON.stringify({action:"delete_user",username:S})})).json();U.status==="success"?(n("User removed","success"),_()):n(U.message||"Delete failed","error")}catch{n("Connection error","error")}finally{p(!1)}}},C=async S=>{if(S.username===t.username){n("Cannot restrict own access.","warning");return}const R=!S.isActive;c(U=>U.map(M=>M.username===S.username?{...M,isActive:R}:M));try{(await(await fetch(e,{method:"POST",body:JSON.stringify({action:"update_user",username:S.username,isActive:R})})).json()).status!=="success"&&(c(G=>G.map(z=>z.username===S.username?{...z,isActive:!R}:z)),n("Sync failed.","error"))}catch{c(M=>M.map(G=>G.username===S.username?{...G,isActive:!R}:G)),n("Connection failed.","error")}},k=S=>{v({name:S.name||"",username:S.username,role:S.role,position:S.position||"",password:""}),x(S.username),h(!0),f("form")},E=async S=>{if(S.preventDefault(),!!y.username){I(!0);try{const R={action:m?"update_user":"register_user",...y,preferences:{...m?{}:{mustChangePassword:!0}}};m&&(R.originalUsername=g);const M=await(await fetch(e,{method:"POST",body:JSON.stringify(R)})).json();M.status==="success"?(n(m?"Updated":"Enrolled","success"),f("list"),_()):n(M.message||"Failed","error")}catch{n("Error","error")}finally{I(!1)}}};return u==="form"?o.jsx("div",{className:"max-w-2xl mx-auto py-4 flex flex-col items-center justify-center min-h-[calc(100vh-140px)] px-4 animate-fadeIn font-sans overflow-hidden",children:o.jsxs("div",{className:"w-full space-y-4",children:[o.jsxs("button",{onClick:()=>f("list"),className:"text-[10px] font-medium text-slate-400 hover:text-slate-800 flex items-center gap-2 uppercase tracking-widest",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Back"]}),o.jsxs("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-slate-100 p-6 md:p-10",children:[o.jsx(Xs,{label:m?"Modify Profile":"Staff Enrollment"}),o.jsxs("form",{onSubmit:E,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] font-semibold uppercase text-slate-400 mb-1.5 tracking-widest",children:"Email Address"}),o.jsx("input",{type:"email",required:!0,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl outline-none font-medium text-slate-700 text-sm",value:y.username,onChange:S=>v({...y,username:S.target.value}),placeholder:"staff@domain.com"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] font-semibold uppercase text-slate-400 mb-1.5 tracking-widest",children:"Role"}),o.jsxs("select",{className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium text-slate-700 outline-none h-[46px] appearance-none",value:y.role,onChange:S=>v({...y,role:S.target.value}),children:[o.jsx("option",{value:"Inspector",children:"Inspector"}),o.jsx("option",{value:"Operations",children:"Operations"}),o.jsx("option",{value:"Maintenance",children:"Maintenance"}),o.jsx("option",{value:"Admin",children:"Admin"}),N&&o.jsx("option",{value:"SuperAdmin",children:"SuperAdmin"})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(Ie,{label:"Designation",value:y.position,onChange:S=>v({...y,position:S}),options:s.positions,isTitleCase:!0}),m&&o.jsx(Ie,{label:"Display Name",value:y.name,onChange:S=>v({...y,name:S}),options:s.inspectors,isTitleCase:!0})]})]}),o.jsx("div",{className:"pt-2 flex justify-end",children:o.jsx("button",{type:"submit",disabled:b,className:"w-full md:w-auto px-10 py-3 bg-slate-900 hover:bg-black text-white font-medium rounded-xl transition-all text-[10px] uppercase tracking-widest active:scale-95",children:b?"Wait...":m?"Sync":"Enroll"})})]})]})]})}):o.jsx("div",{className:"max-w-6xl mx-auto py-2 flex flex-col min-h-[calc(100vh-140px)] px-2 sm:px-4 animate-fadeIn font-sans overflow-hidden",children:o.jsxs("div",{className:"w-full flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 px-2 mb-6 shrink-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-normal text-slate-800 uppercase tracking-tight leading-none",children:"Staff Directory"}),o.jsx("p",{className:"text-[9px] text-slate-400 font-medium uppercase tracking-[0.3em] mt-2",children:"Access Control"})]}),o.jsxs("button",{onClick:()=>{v({name:"",username:"",password:"",role:"Inspector",position:""}),h(!1),f("form")},className:"w-full sm:w-auto px-8 py-3 bg-slate-900 hover:bg-black text-white font-medium rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 text-[10px] uppercase tracking-widest active:scale-95",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M12 4v16m8-8H4"})}),"Add Personnel"]})]}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsx(Xs,{label:"Fleet Personnel"}),o.jsx("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-slate-100 overflow-hidden flex-1 flex flex-col min-h-0",children:o.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:[o.jsxs("table",{className:"w-full text-left text-sm border-collapse hidden md:table",children:[o.jsx("thead",{className:"bg-slate-50/50 text-[9px] font-semibold text-slate-400 uppercase tracking-widest border-b border-slate-50 sticky top-0 z-10 backdrop-blur-md",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-8 py-4",children:"Identity"}),o.jsx("th",{className:"px-8 py-4",children:"Privileges"}),o.jsx("th",{className:"px-8 py-4",children:"State"}),o.jsx("th",{className:"px-8 py-4 text-right",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-50",children:d?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"py-24 text-center",children:o.jsx("div",{className:"w-6 h-6 border-2 border-slate-200 border-t-indigo-500 rounded-full animate-spin mx-auto"})})}):a.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"py-24 text-center text-[10px] font-medium text-slate-300 uppercase tracking-widest",children:"No personnel logged"})}):a.map((S,R)=>o.jsxs("tr",{className:`hover:bg-slate-50/30 transition-colors group ${!S.isActive&&"opacity-60"}`,children:[o.jsx("td",{className:"px-8 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-50 border border-slate-100 flex items-center justify-center font-semibold text-slate-300 text-[10px] shrink-0",children:S.name?S.name.substring(0,2).toUpperCase():"??"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium text-slate-800 text-xs tracking-tight truncate uppercase",children:S.name||"Setup Pending"}),o.jsx("div",{className:"text-[10px] text-slate-400 font-normal truncate",children:S.role==="SuperAdmin"&&!N?"••••••":S.username})]})]})}),o.jsx("td",{className:"px-8 py-4",children:o.jsx("span",{className:`px-2 py-0.5 rounded-md text-[9px] font-semibold uppercase tracking-widest border ${S.role==="Admin"||S.role==="SuperAdmin"?"bg-indigo-50 text-indigo-600 border-indigo-100":"bg-slate-50 text-slate-500 border-slate-100"}`,children:S.role})}),o.jsx("td",{className:"px-8 py-4",children:o.jsx("button",{onClick:()=>C(S),disabled:S.role==="SuperAdmin"&&!N,className:`relative inline-flex h-3.5 w-8 items-center rounded-full transition-all ${S.isActive?"bg-emerald-500":"bg-slate-200"}`,children:o.jsx("span",{className:`inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform ${S.isActive?"translate-x-5":"translate-x-0.5"}`})})}),o.jsx("td",{className:"px-8 py-4 text-right",children:o.jsxs("div",{className:"flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>k(S),className:"p-1.5 text-blue-400 hover:text-blue-600 transition-colors",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",strokeWidth:"2.5"})})}),o.jsx("button",{onClick:()=>w(S.username),className:"p-1.5 text-rose-400 hover:text-rose-600 transition-colors",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",strokeWidth:"2.5"})})})]})})]},R))})]}),o.jsx("div",{className:"md:hidden divide-y divide-slate-50",children:d?o.jsx("div",{className:"py-24 text-center",children:o.jsx("div",{className:"w-6 h-6 border-2 border-slate-100 border-t-indigo-500 rounded-full animate-spin mx-auto"})}):a.length===0?o.jsx("div",{className:"py-24 text-center text-[10px] font-medium text-slate-300 uppercase tracking-widest",children:"No Personnel"}):a.map((S,R)=>o.jsxs("div",{className:`p-3.5 flex flex-col gap-2.5 transition-all ${!S.isActive&&"opacity-60"}`,children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2.5 min-w-0",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-50 border border-slate-100 flex items-center justify-center font-semibold text-slate-300 text-[10px] shrink-0",children:S.name?S.name.substring(0,2).toUpperCase():"??"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium text-slate-800 text-xs tracking-tight truncate uppercase leading-none",children:S.name||"Setup Pending"}),o.jsx("div",{className:"text-[9px] text-slate-400 font-normal truncate mt-1",children:S.role==="SuperAdmin"&&!N?"••••••":S.username})]})]}),o.jsxs("div",{className:"flex gap-1 shrink-0",children:[o.jsx("button",{onClick:()=>k(S),className:"p-1.5 text-blue-500 bg-blue-50 rounded-lg",children:o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),o.jsx("button",{onClick:()=>w(S.username),className:"p-1.5 text-rose-500 bg-rose-50 rounded-lg",children:o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-1",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:`px-2 py-0.5 rounded-md text-[8px] font-semibold uppercase tracking-widest border ${S.role==="Admin"||S.role==="SuperAdmin"?"bg-indigo-50 text-indigo-600 border-indigo-100":"bg-slate-50 text-slate-500 border-slate-100"}`,children:S.role}),S.position&&o.jsx("span",{className:"text-[8px] font-medium text-slate-400 uppercase tracking-tight self-center truncate max-w-[100px]",children:S.position})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`text-[8px] font-semibold uppercase tracking-widest ${S.isActive?"text-emerald-500":"text-slate-300"}`,children:S.isActive?"Live":"Off"}),o.jsx("button",{onClick:()=>C(S),disabled:S.role==="SuperAdmin"&&!N,className:`relative inline-flex h-3.5 w-8 items-center rounded-full transition-all ${S.isActive?"bg-emerald-500":"bg-slate-200"}`,children:o.jsx("span",{className:`inline-block h-2.5 w-2.5 transform rounded-full bg-white transition-transform ${S.isActive?"translate-x-5":"translate-x-0.5"}`})})]})]})]},R))})]})})]})]})})},Ne=({children:t})=>o.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 flex items-center justify-center text-slate-700 transition-all duration-300 group-hover:scale-110",children:Xe.isValidElement(t)?Xe.cloneElement(t,{className:"w-full h-full",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}):t}),at=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("path",{d:"M9 11l3 3L22 4"}),o.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"})]})}),Tf=()=>o.jsx(Ne,{children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:o.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})})}),_f=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M23 21v-2a4 4 0 00-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 010 7.75"})]})}),If=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}),Af=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("rect",{x:"3",y:"4",width:"18",height:"16",rx:"2"}),o.jsx("path",{d:"M7 8h10M7 12h10M7 16h6"})]})}),kf=()=>o.jsx(Ne,{children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:o.jsx("path",{d:"M18 20V10M12 20V4M6 20v-6"})})}),Rf=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),o.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 113 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),Mf=()=>o.jsx(Ne,{children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("path",{d:"M12 21a9 9 0 100-18 9 9 0 000 18z"}),o.jsx("path",{d:"M12 17v-4M12 9h.01",strokeWidth:"3"})]})}),ce=({id:t,label:e,icon:n,isForcedLock:s=!1,badgeCount:i=0,badgeColor:a="bg-slate-800",isInspectionModule:c=!1,isLocked:d,onNavigate:p,isAddon:u=!1})=>{const f=s||c&&d;return o.jsxs("button",{onClick:()=>!f&&p(t),className:`flex flex-col items-center p-4 sm:p-8 transition-all w-full group relative rounded-[2rem]
                ${f?"opacity-30 cursor-not-allowed grayscale":"hover:bg-white hover:shadow-2xl active:scale-95 border border-transparent hover:border-slate-50"}`,children:[o.jsxs("div",{className:"mb-4 flex items-center justify-center relative",children:[n,f&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-slate-900 text-white rounded-full p-1.5 shadow-xl ring-4 ring-slate-50",children:o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeWidth:"3",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),i>0&&!f&&o.jsx("div",{className:`absolute -top-1 -right-1 ${a} text-white text-[9px] font-black w-6 h-6 rounded-full flex items-center justify-center border-4 border-white shadow-lg`,children:i}),u&&!f&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-indigo-600 text-white text-[7px] font-black px-1.5 py-0.5 rounded shadow-sm border border-indigo-500 uppercase tracking-tighter",children:"Pro"})]}),o.jsx("span",{className:`text-[10px] font-black text-center leading-tight uppercase tracking-[0.2em] ${f?"text-slate-400":"text-slate-600 group-hover:text-slate-900"}`,children:e})]})},Ut=({label:t})=>o.jsxs("div",{className:"w-full flex items-center gap-6 mb-8 opacity-40",children:[o.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] whitespace-nowrap",children:t}),o.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-slate-200 to-transparent"})]}),Pf=({onNavigate:t,userRole:e,isLocked:n=!1,pendingAlertsCount:s=0})=>{const i=e==="Admin"||e==="SuperAdmin",a=e==="SuperAdmin";return o.jsx("div",{className:"max-w-5xl mx-auto py-10 sm:py-16 px-4 min-h-screen",children:o.jsxs("div",{className:"space-y-16",children:[o.jsxs("section",{id:"system-mgmt-section",className:"animate-fadeIn",children:[o.jsx(Ut,{label:"CONTROL CENTER"}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6",children:[o.jsx(ce,{id:"maintenance",label:"SECURITY",isLocked:n,isForcedLock:!a,onNavigate:t,icon:o.jsx(Tf,{})}),o.jsx(ce,{id:"users",label:"PERSONNEL",isLocked:n,isForcedLock:!i,onNavigate:t,icon:o.jsx(_f,{})}),o.jsx(ce,{id:"registry",label:"REGISTRY",isLocked:n,isForcedLock:!i,onNavigate:t,icon:o.jsx(Af,{})}),o.jsx(ce,{id:"settings",label:"SETTINGS",isLocked:n,isForcedLock:!i,onNavigate:t,icon:o.jsx(If,{})})]})]}),o.jsxs("section",{id:"inspection-forms-section",className:"animate-fadeIn",style:{animationDelay:"100ms"},children:[o.jsx(Ut,{label:"AUDIT MODULES"}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6",children:[o.jsx(ce,{id:"general",label:"GENERAL",isInspectionModule:!0,isLocked:n,onNavigate:t,icon:o.jsx(at,{})}),o.jsx(ce,{id:"petroleum",label:"PETRO V1",isInspectionModule:!0,isLocked:n,onNavigate:t,icon:o.jsx(at,{})}),o.jsx(ce,{id:"petroleum_v2",label:"PETRO V2",isInspectionModule:!0,isLocked:n,onNavigate:t,icon:o.jsx(at,{})}),o.jsx(ce,{id:"acid",label:"ACID CHECK",isInspectionModule:!0,isLocked:n,onNavigate:t,icon:o.jsx(at,{})})]})]}),o.jsxs("section",{className:"animate-fadeIn",style:{animationDelay:"200ms"},children:[o.jsx(Ut,{label:"OPERATIONS"}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-6",children:[o.jsx(ce,{id:"analytics",label:"ANALYTICS",isLocked:n,onNavigate:t,icon:o.jsx(kf,{}),badgeCount:s,badgeColor:"bg-rose-600"}),o.jsx(ce,{id:"track_requests",label:"PIPELINE",isLocked:n,onNavigate:t,icon:o.jsx(Rf,{})}),o.jsx(ce,{id:"support",label:"SUPPORT",isLocked:n,onNavigate:t,icon:o.jsx(Mf,{})}),o.jsxs("div",{className:"hidden sm:flex flex-col items-center justify-center p-8 opacity-20 select-none",children:[o.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-slate-300",children:"HUB ACTIVE"}),o.jsx("div",{className:"w-4 h-1 bg-indigo-500 mt-2 rounded-full animate-pulse"})]})]})]})]})})},lt=({label:t,onCapture:e,existingImage:n})=>{const s=T.useRef(null),[i,a]=T.useState(n),c=d=>{const p=d.target.files?.[0];if(p){const u=new FileReader;u.onloadend=()=>{const f=u.result;a(f),e(f)},u.readAsDataURL(p)}};return o.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[o.jsx("span",{className:"text-sm font-semibold text-gray-700",children:t}),o.jsx("div",{className:"relative w-full aspect-video bg-gray-200 rounded-md overflow-hidden flex items-center justify-center border-2 border-dashed border-gray-300",children:i?o.jsx("img",{src:i,alt:"Capture",className:"w-full h-full object-cover"}):o.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),o.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),o.jsx("span",{className:"text-xs mt-1",children:"No Image"})]})}),o.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:s,onChange:c,className:"hidden"}),o.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-full py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 transition flex items-center justify-center gap-2",children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),o.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),i?"Retake Photo":"Take Photo"]})]})},Qs=({label:t,onSave:e,existingSignature:n})=>{const s=T.useRef(null),i=T.useRef(null),[a,c]=T.useState(!1),d=T.useRef(!1);T.useEffect(()=>{const g=s.current,x=i.current;if(!g||!x)return;const y=()=>{const b=g.toDataURL(),I=x.getBoundingClientRect();g.width=I.width,g.height=160;const N=g.getContext("2d");if(d.current||n){const A=new Image;A.src=d.current?b:n||"",A.onload=()=>{N?.drawImage(A,0,0,g.width,g.height),d.current=!0}}};y();const v=new ResizeObserver(()=>{y()});return v.observe(x),()=>v.disconnect()},[n]);const p=g=>{const x=s.current;if(!x)return{x:0,y:0};const y=x.getBoundingClientRect();let v,b;return"touches"in g?(v=g.touches[0].clientX,b=g.touches[0].clientY):(v=g.clientX,b=g.clientY),{x:v-y.left,y:b-y.top}},u=g=>{"touches"in g&&g.preventDefault();const x=s.current;if(!x)return;const y=x.getContext("2d");if(!y)return;c(!0);const{x:v,y:b}=p(g);y.beginPath(),y.moveTo(v,b),y.lineWidth=2,y.lineCap="round",y.strokeStyle="#000"},f=g=>{if("touches"in g&&g.preventDefault(),!a)return;const x=s.current;if(!x)return;const y=x.getContext("2d");if(!y)return;const{x:v,y:b}=p(g);y.lineTo(v,b),y.stroke()},m=g=>{"touches"in g&&g.preventDefault(),a&&(c(!1),s.current&&e(s.current.toDataURL()))},h=()=>{const g=s.current;g&&(g.getContext("2d")?.clearRect(0,0,g.width,g.height),e(""),d.current=!1)};return o.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:t}),o.jsx("button",{type:"button",onClick:h,className:"text-[10px] text-rose-500 hover:text-rose-700 font-bold uppercase tracking-widest",children:"Clear"})]}),o.jsxs("div",{ref:i,className:"w-full border border-slate-200 rounded-2xl bg-white overflow-hidden relative shadow-sm h-[160px]",children:[o.jsx("canvas",{ref:s,className:"w-full h-full bg-white cursor-crosshair touch-none block",onMouseDown:u,onMouseMove:f,onMouseUp:m,onMouseLeave:m,onTouchStart:u,onTouchMove:f,onTouchEnd:m}),o.jsx("div",{className:"absolute bottom-3 right-4 text-[9px] font-black text-slate-200 pointer-events-none select-none uppercase tracking-[0.2em]",children:"Authentication Required"})]})]})},ct=({label:t,status:e,current:n,onClick:s,colorClass:i})=>{const a=e===n,c={green:a?"bg-emerald-600 text-white border-emerald-600 shadow-lg shadow-emerald-100":"bg-white text-emerald-700 border-emerald-100 hover:bg-emerald-50",red:a?"bg-rose-600 text-white border-rose-600 shadow-lg shadow-rose-100":"bg-white text-rose-700 border-rose-100 hover:bg-rose-50",yellow:a?"bg-amber-500 text-white border-amber-500 shadow-lg shadow-amber-100":"bg-white text-amber-600 border-amber-100 hover:bg-amber-50",gray:a?"bg-slate-700 text-white border-slate-700 shadow-lg shadow-slate-100":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"};return o.jsxs("button",{onClick:s,className:`relative py-3 px-1 rounded-xl border font-black text-[9px] transition-all flex flex-col items-center justify-center gap-1.5 flex-1 min-w-0 ${c[i]} ${a?"z-10 scale-[1.02]":"shadow-sm opacity-90 hover:opacity-100 hover:scale-[1.01]"}`,children:[o.jsxs("div",{className:"h-4 flex items-center justify-center pointer-events-none scale-90 sm:scale-100",children:[e===K.GOOD&&o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M5 13l4 4L19 7"})}),e===K.BAD&&o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})}),e===K.ATTENTION&&o.jsx("span",{className:"text-sm font-black italic",children:"!"}),e===K.NIL&&o.jsx("span",{className:"text-sm font-black opacity-40",children:"Ø"})]}),o.jsx("span",{className:"uppercase tracking-tighter sm:tracking-widest truncate w-full px-1 text-center pointer-events-none",children:t})]})},Zs=({label:t,value:e,onChange:n,type:s="text",placeholder:i,error:a})=>o.jsxs("div",{children:[o.jsx("label",{className:`block text-xs font-bold uppercase mb-1.5 tracking-wide ${a?"text-red-600":"text-gray-500"}`,children:t}),o.jsx("input",{type:s,value:e,onChange:c=>n(c.target.value),placeholder:i,className:`w-full p-3.5 border rounded-lg focus:ring-2 focus:outline-none transition-all font-medium placeholder-gray-400
        ${a?"bg-red-50 border-red-300 focus:ring-red-200 text-red-900":"bg-gray-50 border-gray-200 focus:ring-blue-500 focus:bg-white text-gray-800"}
      `}),a&&o.jsx("p",{className:"text-[10px] text-red-500 font-bold mt-1 ml-1 animate-fadeIn",children:"This field is required"})]}),Lf=({initialData:t,activeModule:e,validationLists:n,onSaveDraft:s,onSubmit:i,onExit:a,submissionStatus:c})=>{const[d,p]=T.useState(t),[u,f]=T.useState(0),[m,h]=T.useState({}),[g,x]=T.useState(!1),y=(w,C)=>{p(k=>({...k,[w]:C})),m[w]&&h(k=>{const E={...k};return delete E[w],E})},v=()=>{s(d),x(!0),setTimeout(()=>x(!1),2e3)},b=w=>{let C=[],k=[];return e==="general"?k=Be:e==="petroleum"?k=yt:e==="petroleum_v2"?k=bt:e==="acid"&&(k=Ae),e==="general"?(w===2&&(C=[O.PPE,O.DOCUMENTATION]),w===3&&(C=[O.VEHICLE_EXTERIOR,O.LIGHTS_ELECTRICAL]),w===4&&(C=[O.MECHANICAL,O.TRAILER])):e==="petroleum"?(w===2&&(C=[L.TRUCK_EQUIPMENT]),w===3&&(C=[L.TYRES,L.PPE_ID]),w===4&&(C=[L.DOCUMENTS,L.ONBOARD])):e==="petroleum_v2"?(w===2&&(C=[D.PRIME_MOVER]),w===3&&(C=[D.TRAILER_TANKS]),w===4&&(C=[D.DRIVER,D.SAFETY_SIGNS,D.DOCUMENTS])):e==="acid"&&(w===2&&(C=[q.PPE]),w===3&&(C=[q.VEHICLE]),w===4&&(C=[q.SPILL_KIT,q.DOCUMENTATION])),k.filter(E=>C.includes(E.category))},I=w=>{const C={};return w===0&&(d.truckNo||(C.truckNo=!0),d.trailerNo||(C.trailerNo=!0),d.driverName||(C.driverName=!0),d.location||(C.location=!0),d.odometer||(C.odometer=!0),e!=="general"&&!d.jobCard&&(C.jobCard=!0)),w>=2&&w<=4&&b(w).forEach(E=>{d[E.id]||(C[E.id]=!0)}),w===5&&((!d.remarks||d.remarks.trim()==="")&&(C.remarks=!0),(!d.rate||d.rate===0)&&(C.rate=!0),d.inspectorSignature||(C.inspectorSignature=!0),d.driverSignature||(C.driverSignature=!0)),Object.keys(C).length>0?(h(C),window.scrollTo({top:0,behavior:"smooth"}),!1):(h({}),!0)},N=()=>{I(u)&&(window.scrollTo({top:0,behavior:"smooth"}),f(w=>Math.min(w+1,tt.length-1)))},A=()=>{u===0?a():(window.scrollTo({top:0,behavior:"smooth"}),f(w=>Math.max(w-1,0)))},_=()=>{I(u)&&i(d)};return o.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-56px)] bg-slate-50/50",children:[o.jsx("div",{className:"bg-white border-b border-slate-100 sticky top-14 z-30 shadow-sm shrink-0",children:o.jsx("div",{className:"max-w-5xl mx-auto px-4 py-4 sm:py-5 overflow-hidden",children:o.jsx("div",{className:"flex justify-between items-center gap-1 sm:gap-4",children:tt.map((w,C)=>{const k=C===u,E=C<u;return o.jsxs(Xe.Fragment,{children:[o.jsxs("div",{className:"flex flex-col items-center gap-1.5 min-w-0 transition-all duration-500",children:[o.jsx("div",{className:`
                                            w-6 h-6 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center text-[8px] sm:text-xs font-black transition-all
                                            ${k?"bg-slate-900 text-white shadow-lg scale-110":E?"bg-emerald-500 text-white":"bg-slate-100 text-slate-300"}
                                        `,children:E?"✓":C+1}),o.jsx("span",{className:`text-[7px] font-black uppercase tracking-tighter sm:tracking-widest truncate w-full text-center hidden xs:block ${k?"text-slate-900":"text-slate-300"}`,children:w.title})]}),C<tt.length-1&&o.jsx("div",{className:`h-px flex-1 rounded-full ${E?"bg-emerald-500":"bg-slate-100"}`})]},w.id)})})})}),o.jsxs("div",{className:"flex-1 p-4 sm:p-8 w-full max-w-5xl mx-auto pb-32",children:[u===0&&o.jsx("div",{className:"space-y-4 animate-fadeIn",children:o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-[2rem] border border-slate-100 shadow-sm",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-black text-slate-800 mb-8 uppercase tracking-tight",children:"Inspection Details"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8",children:[o.jsx(Ie,{label:"Truck Registration *",value:d.truckNo,onChange:w=>y("truckNo",w),options:n.trucks,isRegNo:!0,error:m.truckNo}),o.jsx(Ie,{label:"Trailer ID *",value:d.trailerNo,onChange:w=>y("trailerNo",w),options:n.trailers,isRegNo:!0,error:m.trailerNo}),o.jsx(Zs,{label:"Job Card (if any)",value:d.jobCard||"",onChange:w=>y("jobCard",w),error:m.jobCard}),o.jsx(Ie,{label:"Inspector",value:d.inspectedBy,onChange:w=>y("inspectedBy",w),options:n.inspectors,readOnly:!0}),o.jsx(Ie,{label:"Driver Name *",value:d.driverName,onChange:w=>y("driverName",w),options:n.drivers,isTitleCase:!0,error:m.driverName}),o.jsx(Ie,{label:"Location *",value:d.location,onChange:w=>y("location",w),options:n.locations,isTitleCase:!0,error:m.location}),o.jsx(Zs,{label:"Odometer Reading (KM) *",type:"number",value:d.odometer,onChange:w=>y("odometer",w),error:m.odometer})]})]})}),u===1&&o.jsx("div",{className:"space-y-4 animate-fadeIn",children:o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-[2rem] border border-slate-100 shadow-sm",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-black text-slate-800 mb-8 uppercase tracking-tight",children:"Vehicle Photos"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsx(lt,{label:"Front View",existingImage:d.photoFront,onCapture:w=>y("photoFront",w)}),o.jsx(lt,{label:"Left Side",existingImage:d.photoLS,onCapture:w=>y("photoLS",w)}),o.jsx(lt,{label:"Right Side",existingImage:d.photoRS,onCapture:w=>y("photoRS",w)}),o.jsx(lt,{label:"Rear View",existingImage:d.photoBack,onCapture:w=>y("photoBack",w)})]})]})}),u>=2&&u<=4&&o.jsx("div",{className:"space-y-6 animate-fadeIn",children:Array.from(new Set(b(u).map(w=>w.category))).map(w=>o.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden",children:[o.jsx("div",{className:"bg-slate-50/50 px-6 py-4 border-b border-slate-100 flex justify-between items-center",children:o.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]",children:w})}),o.jsx("div",{className:"divide-y divide-slate-50",children:b(u).filter(C=>C.category===w).map(C=>o.jsxs("div",{className:`p-6 sm:p-8 transition-colors ${m[C.id]?"bg-rose-50/30":""}`,children:[o.jsx("p",{className:"font-bold text-xs sm:text-sm text-slate-700 uppercase tracking-tight mb-5 leading-snug",children:C.label}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 max-w-2xl",children:[o.jsx(ct,{label:"Good",status:K.GOOD,current:d[C.id],onClick:()=>y(C.id,K.GOOD),colorClass:"green"}),o.jsx(ct,{label:"Fault",status:K.BAD,current:d[C.id],onClick:()=>y(C.id,K.BAD),colorClass:"red"}),o.jsx(ct,{label:"Review",status:K.ATTENTION,current:d[C.id],onClick:()=>y(C.id,K.ATTENTION),colorClass:"yellow"}),o.jsx(ct,{label:"N/A",status:K.NIL,current:d[C.id],onClick:()=>y(C.id,K.NIL),colorClass:"gray"})]})]},C.id))})]},w))}),u===5&&o.jsx("div",{className:"space-y-4 animate-fadeIn",children:o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-[2rem] border border-slate-100 shadow-sm",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-black text-slate-800 mb-8 uppercase tracking-tight",children:"Review & Sign"}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 mb-3 tracking-widest",children:"Comments *"}),o.jsx("textarea",{className:"w-full p-6 bg-slate-50 border border-slate-100 rounded-2xl h-40 outline-none font-medium text-sm focus:ring-4 focus:ring-indigo-50/50 resize-none transition-all",value:d.remarks,onChange:w=>y("remarks",w.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 mb-4 tracking-widest",children:"Overall Condition Rating *"}),o.jsx("div",{className:"flex gap-2 sm:gap-4",children:[1,2,3,4,5].map(w=>o.jsx("button",{onClick:()=>y("rate",w),className:`flex-1 h-12 sm:h-14 rounded-xl font-black text-lg transition-all ${d.rate===w?"bg-slate-900 text-white shadow-lg scale-105":"bg-slate-50 text-slate-400 hover:bg-slate-100"}`,children:w},w))})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-6 border-t border-slate-50",children:[o.jsx(Qs,{label:"Inspector Signature",existingSignature:d.inspectorSignature,onSave:w=>y("inspectorSignature",w)}),o.jsx(Qs,{label:"Driver Signature",existingSignature:d.driverSignature,onSave:w=>y("driverSignature",w)})]})]})]})}),u===6&&o.jsxs("div",{className:"animate-fadeIn py-10 text-center",children:[o.jsx("div",{className:"w-20 h-20 bg-emerald-50 rounded-full flex items-center justify-center mx-auto mb-8 border border-emerald-100",children:o.jsx("svg",{className:"w-10 h-10 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("button",{onClick:_,disabled:c!=="idle",className:"w-full sm:w-auto px-12 py-5 bg-slate-900 hover:bg-black text-white rounded-2xl font-black text-sm shadow-2xl transition-all flex items-center justify-center gap-3 active:scale-95 border-t border-white/10 uppercase tracking-[0.2em]",children:c==="submitting"?"Uploading...":"Submit"})]})]}),o.jsx("footer",{className:"bg-white/90 backdrop-blur-md border-t border-slate-100 p-4 sm:p-6 fixed bottom-0 left-0 right-0 z-40 pb-[max(1rem,env(safe-area-inset-bottom))]",children:o.jsxs("div",{className:"max-w-5xl mx-auto flex gap-3 sm:gap-6",children:[o.jsx("button",{onClick:A,className:"flex-1 sm:flex-none px-6 sm:px-10 py-3.5 rounded-xl sm:rounded-2xl border border-slate-200 font-black text-slate-400 hover:text-slate-800 transition-all text-[10px] uppercase tracking-widest active:scale-95",children:u===0?"Cancel":"Previous"}),o.jsxs("div",{className:"flex gap-3 flex-[2] sm:flex-1 justify-end",children:[o.jsx("button",{onClick:v,className:"flex-1 sm:flex-none px-4 sm:px-8 py-3.5 rounded-xl sm:rounded-2xl bg-indigo-50 text-indigo-600 font-black hover:bg-indigo-100 transition-all flex items-center justify-center gap-2 text-[10px] uppercase tracking-widest active:scale-95",children:g?"Saved":"Save Draft"}),u<tt.length-1&&o.jsxs("button",{onClick:N,className:"flex-[1.5] sm:flex-none px-8 sm:px-12 py-3.5 rounded-xl sm:rounded-2xl bg-slate-900 text-white font-black hover:bg-black shadow-lg transition-all flex items-center justify-center gap-3 text-[10px] uppercase tracking-[0.2em] active:scale-95 border-t border-white/10",children:["Continue",o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"3",children:o.jsx("path",{d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]})})]})},jf=({tickets:t,isLoading:e,onRefresh:n,onSelect:s,filterStatus:i})=>{const a=T.useMemo(()=>i==="OPEN"?t.filter(c=>c.status==="Open"||c.status==="In Progress"):i==="CLOSED"?t.filter(c=>c.status==="Resolved"||c.status==="Closed"):t,[t,i]);return o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[300px]",children:[o.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100 flex justify-between items-center",children:[o.jsxs("span",{className:"font-semibold text-sm text-slate-700",children:["Recent Requests (",a.length,")"]}),o.jsx("button",{onClick:n,className:"text-[10px] text-indigo-600 font-bold uppercase tracking-wide bg-white px-3 py-1.5 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors",children:"Refresh"})]}),o.jsx("div",{className:"divide-y divide-slate-100",children:e?o.jsx("div",{className:"p-12 text-center text-slate-400 text-xs",children:"Checking for updates..."}):a.length===0?o.jsx("div",{className:"p-16 text-center text-slate-400 italic text-xs",children:"No active support requests."}):a.map(c=>o.jsxs("div",{onClick:()=>s(c),className:"p-4 sm:p-5 hover:bg-slate-50 cursor-pointer transition-colors group",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2 gap-2",children:[o.jsxs("span",{className:"font-semibold text-sm text-slate-800 group-hover:text-indigo-600 line-clamp-1",children:["#",c.ticketId,": ",c.subject]}),o.jsx("span",{className:`text-[9px] font-bold uppercase tracking-wider px-2 py-0.5 rounded border self-start ${c.status==="Resolved"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-indigo-50 text-indigo-600 border-indigo-100"}`,children:c.status})]}),o.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 mb-3 leading-relaxed",children:c.description}),o.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[o.jsx("span",{className:"text-[10px] text-slate-400 whitespace-nowrap",children:new Date(c.timestamp).toLocaleDateString()}),o.jsx("span",{className:"text-[10px] text-slate-300",children:"•"}),o.jsx("span",{className:"text-[10px] text-slate-400 truncate",children:c.user})]})]},c.ticketId))})]})},Df=({ticket:t,currentUser:e,isAdmin:n,onClose:s,onReply:i,isSendingReply:a,isLocked:c})=>{const[d,p]=T.useState(""),u=()=>{!d.trim()||c||(i(d),p(""))};return o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex flex-col h-[500px] sm:h-[600px] animate-fadeIn",children:[o.jsxs("div",{className:"p-4 bg-slate-50 border-b flex justify-between items-center",children:[o.jsxs("button",{onClick:s,className:"text-xs font-medium text-slate-600 hover:text-slate-900 flex items-center gap-1",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Back"]}),o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"font-semibold text-slate-800 text-sm truncate max-w-[120px] sm:max-w-[200px]",children:t.subject}),c&&o.jsx("span",{className:"text-[9px] font-medium text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-200 shrink-0",children:"View Only"})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50/20",children:[o.jsxs("div",{className:"p-4 rounded-xl bg-white border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-1",children:"Description"}),o.jsx("p",{className:"text-sm text-slate-700 leading-relaxed break-words",children:t.description})]}),t.comments?.map((f,m)=>{const h=f.role?.toLowerCase()||"",x=h==="admin"||h==="superadmin"?"Support":f.user;return o.jsxs("div",{className:`p-3 rounded-xl border ${f.user===e?.name?"bg-indigo-600 text-white ml-auto border-indigo-500":"bg-white text-slate-700 mr-auto border-slate-100"} max-w-[90%] sm:max-w-[85%]`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-1 gap-4",children:[o.jsx("p",{className:"text-[10px] font-semibold opacity-70 truncate",children:x}),o.jsx("p",{className:"text-[9px] opacity-50 whitespace-nowrap",children:new Date(f.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),o.jsx("p",{className:"text-sm break-words",children:f.message})]},m)})]}),!c&&o.jsxs("div",{className:"p-3 border-t bg-white flex gap-2 items-center",children:[o.jsx("input",{className:"flex-1 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-indigo-100 outline-none transition-all",placeholder:"Type a message...",value:d,onChange:f=>p(f.target.value)}),o.jsx("button",{onClick:u,disabled:a||!d.trim(),className:"px-5 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-xl text-sm transition-all disabled:bg-slate-300",children:a?"...":"Send"})]})]})},Uf=({appScriptUrl:t,currentUser:e,showToast:n,settings:s,prefillData:i,onPrefillConsumed:a})=>{const c=window.isSubscriptionLocked||!1,[d,p]=T.useState("create"),[u,f]=T.useState([]),[m,h]=T.useState(null),[g,x]=T.useState(!1),[y,v]=T.useState(!1),[b,I]=T.useState(!1),[N,A]=T.useState({subject:"",description:"",priority:"Medium"});T.useEffect(()=>{i&&(A({subject:i.subject,description:i.description,priority:"Medium"}),p("create"),a&&a())},[i]);const _=async()=>{if(!(!t||!e)){x(!0);try{const S=await(await fetch(t,{method:"POST",body:JSON.stringify({action:"get_tickets",email:e.username,role:e.role})})).json();S.status==="success"&&f(S.tickets)}finally{x(!1)}}};T.useEffect(()=>{_()},[]);const w=async E=>{if(E.preventDefault(),c){n("System is in view-only mode.","error");return}v(!0);try{const S={action:"submit_support_ticket",type:"Issue",...N,user:e?.name,email:e?.username,role:e?.role};(await(await fetch(t,{method:"POST",body:JSON.stringify(S)})).json()).status==="success"&&(n("Request submitted successfully.","success"),A({subject:"",description:"",priority:"Medium"}),p("list"),_())}catch{n("Failed to send request.","error")}finally{v(!1)}},C=async E=>{if(!(!m||c)){I(!0);try{const S={user:e?.name,role:e?.role,message:E,timestamp:new Date().toISOString()};await fetch(t,{method:"POST",body:JSON.stringify({action:"update_ticket",ticketId:m.ticketId,comment:S}),mode:"no-cors"});const R={...m,comments:[...m.comments,S]};h(R),f(U=>U.map(M=>M.ticketId===R.ticketId?R:M)),n("Reply sent.","success")}finally{I(!1)}}},k=async()=>{if(!s)return;const E=s.companyName||"Fleet Portal",S=s.webAppUrl||window.location.href,R=s.mobileApkLink;let U=`${E} Access Links:

💻 Web Portal: ${S}`;R&&(U+=`

📱 Android App: ${R}`);const M={title:E,text:U,url:S};try{navigator.share?await navigator.share(M):(await navigator.clipboard.writeText(U),n("Links copied to clipboard.","info"))}catch(G){console.error("Share failed:",G)}};return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fadeIn pb-20 px-2 sm:px-4",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-slate-800 tracking-tight uppercase",children:"Support Center"}),o.jsx("p",{className:"text-xs text-slate-400 font-medium mt-1",children:"Get assistance or report issues"})]}),c&&o.jsx("span",{className:"px-4 py-1.5 bg-amber-50 text-amber-700 border border-amber-200 rounded-lg text-[10px] font-bold uppercase tracking-wide",children:"View-Only"})]}),o.jsxs("div",{className:"flex gap-2 p-1 bg-slate-100 rounded-xl w-fit border border-slate-200",children:[o.jsx("button",{onClick:()=>!c&&p("create"),disabled:c,className:`px-5 py-2 rounded-lg text-xs font-semibold transition-all ${d==="create"?"bg-white text-indigo-600 shadow-sm":"text-slate-500"} ${c&&"opacity-30"}`,children:"New Ticket"}),o.jsx("button",{onClick:()=>p("list"),className:`px-5 py-2 rounded-lg text-xs font-semibold transition-all ${d==="list"?"bg-white text-indigo-600 shadow-sm":"text-slate-500"}`,children:"My History"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsx("div",{className:"lg:col-span-2",children:d==="create"?o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-2xl border border-slate-200 shadow-sm animate-fadeIn",children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-6",children:"Submit a Request"}),o.jsxs("form",{onSubmit:w,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide ml-1",children:"Subject"}),o.jsx("input",{className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl text-sm outline-none focus:ring-2 focus:ring-indigo-100 transition-all",placeholder:"e.g. Odometer sync issue",value:N.subject,onChange:E=>A({...N,subject:E.target.value}),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide ml-1",children:"Details"}),o.jsx("textarea",{className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl text-sm h-32 outline-none focus:ring-2 focus:ring-indigo-100 transition-all resize-none",placeholder:"Describe your problem...",value:N.description,onChange:E=>A({...N,description:E.target.value}),required:!0})]}),o.jsx("button",{type:"submit",disabled:y,className:"w-full py-4 bg-slate-800 hover:bg-slate-900 text-white font-semibold rounded-xl transition-all shadow active:scale-[0.98] text-sm flex items-center justify-center gap-2",children:y?"Sending...":"Submit Request"})]})]}):m?o.jsx(Df,{ticket:m,currentUser:e,isAdmin:e?.role==="Admin"||e?.role==="SuperAdmin",onClose:()=>h(null),onReply:C,isSendingReply:b,isLocked:c}):o.jsx(jf,{tickets:u,isLoading:g,onRefresh:_,onSelect:h,isAdmin:e?.role==="Admin"||e?.role==="SuperAdmin",filterStatus:"ALL"})}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[o.jsx("h3",{className:"text-sm font-semibold text-slate-800 uppercase tracking-tight mb-2",children:"Share Application"}),o.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-4",children:"Share access links for the web portal and mobile application with your team."}),o.jsxs("button",{onClick:k,className:"w-full py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-xl text-xs flex items-center justify-center gap-2 transition-all",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Copy Share Links"]})]}),o.jsxs("div",{className:"bg-slate-100 p-6 rounded-2xl border border-slate-200",children:[o.jsx("h4",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-3",children:"Service Hours"}),o.jsxs("div",{className:"space-y-2 text-xs text-slate-600 font-medium",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Mon - Fri"}),o.jsx("span",{children:"08:00 - 17:00"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Sat"}),o.jsx("span",{children:"09:00 - 13:00"})]})]})]})]})]})]})},Ft=({label:t})=>o.jsxs("div",{className:"w-full flex items-center gap-4 sm:gap-6 mb-4 sm:mb-6 opacity-80 shrink-0",children:[o.jsx("span",{className:"text-[10px] sm:text-[11px] font-black text-slate-300 uppercase tracking-[0.4em] whitespace-nowrap",children:t}),o.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-slate-100 to-transparent"})]}),Ff=({appScriptUrl:t,settings:e,onSettingsUpdate:n,showToast:s,subscription:i,onRefreshSubscription:a,history:c=[]})=>{const[d,p]=T.useState("info"),[u,f]=T.useState(""),[m,h]=T.useState(!1),[g,x]=T.useState(e.maintenanceMode||!1),[y,v]=T.useState(e.maintenanceMessage||"System under scheduled maintenance."),[b,I]=T.useState(!1),[N,A]=T.useState(i?.plan||"Enterprise"),[_,w]=T.useState(i?.expiryDate||""),[C,k]=T.useState(!1),[E,S]=T.useState(!1),R=async()=>{if(!u.trim()){s("Enter alert message.","error");return}h(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"broadcast",type:d,message:u}),mode:"no-cors"}),s("Broadcast dispatched.","success"),f("")}catch{s("Broadcast failed.","error")}finally{h(!1)}},U=async()=>{I(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"update_settings",...e,maintenanceMode:g,maintenanceMessage:y}),mode:"no-cors"}),n({maintenanceMode:g,maintenanceMessage:y}),s(g?"System Lock Active":"Access Restored","success")}catch{s("Sync failed.","error")}finally{I(!1)}},M=async()=>{k(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"update_subscription",plan:N,expiryDate:_,status:"Active"}),mode:"no-cors"}),s("License synced.","success"),a&&a()}catch{s("Sync failed.","error")}finally{k(!1)}},G=i?.daysRemaining??0,z=G<=0;return o.jsx("div",{className:"max-w-6xl mx-auto py-2 sm:py-6 flex flex-col items-center justify-center min-h-[calc(100vh-140px)] px-2 sm:px-4 animate-fadeIn font-sans overflow-hidden",children:o.jsxs("div",{className:"w-full max-w-5xl space-y-6 sm:space-y-10",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 px-2",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl sm:text-3xl font-normal text-slate-800 uppercase tracking-tight leading-none",children:"System Security"}),o.jsx("p",{className:"text-[9px] text-slate-400 font-normal uppercase tracking-[0.25em] mt-2",children:"Security Console & Management Hub"})]}),o.jsxs("div",{className:"hidden sm:flex items-center gap-3 px-5 py-2.5 bg-white border border-slate-100 rounded-2xl shadow-sm",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),o.jsx("span",{className:"text-[9px] font-normal text-slate-500 uppercase tracking-widest",children:"Admin Mode"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx(Ft,{label:"Global Alerts"}),o.jsxs("div",{className:"bg-white rounded-[1.5rem] sm:rounded-[2rem] shadow-sm border border-slate-100 p-5 sm:p-8 flex flex-col h-fit",children:[o.jsx("textarea",{className:"w-full p-4 bg-slate-50 border border-slate-100 rounded-xl h-24 sm:h-28 outline-none focus:ring-2 focus:ring-indigo-500/10 font-normal text-xs text-slate-600 transition-all resize-none mb-4",placeholder:"System-wide notification text...",value:u,onChange:F=>f(F.target.value)}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:d,onChange:F=>p(F.target.value),className:"px-3 py-2 bg-slate-50 border border-slate-100 rounded-xl text-[10px] font-normal uppercase tracking-widest text-slate-400 outline-none",children:[o.jsx("option",{value:"info",children:"Info"}),o.jsx("option",{value:"critical",children:"Critical"})]}),o.jsx("button",{onClick:R,disabled:m,className:"flex-1 py-3 bg-slate-900 hover:bg-black text-white font-normal rounded-xl shadow-lg transition-all text-[10px] uppercase tracking-[0.2em] active:scale-95 disabled:opacity-50",children:m?"Sending":"Dispatch Alert"})]})]})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx(Ft,{label:"System Access"}),o.jsxs("div",{className:"bg-white rounded-[1.5rem] sm:rounded-[2rem] shadow-sm border border-slate-100 p-5 sm:p-8 flex flex-col h-fit",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl mb-4 border border-slate-50",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs font-normal text-slate-800 uppercase tracking-tight",children:"Maintenance Mode"}),o.jsx("p",{className:"text-[8px] text-slate-400 font-normal uppercase tracking-widest mt-0.5",children:"Restrict system state"})]}),o.jsx("button",{onClick:()=>x(!g),className:`relative inline-flex h-5 w-10 items-center rounded-full transition-all duration-300 ${g?"bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.3)]":"bg-slate-200"}`,children:o.jsx("span",{className:`inline-block h-3.5 w-3.5 transform rounded-full bg-white transition-transform duration-300 ${g?"translate-x-6":"translate-x-0.5"}`})})]}),o.jsx("input",{type:"text",value:y,onChange:F=>v(F.target.value),placeholder:"Display message...",className:"w-full p-3 bg-slate-50 border border-slate-100 rounded-xl font-normal text-slate-700 outline-none text-xs mb-4"}),o.jsx("button",{onClick:U,disabled:b,className:"w-full py-3 bg-slate-900 hover:bg-black text-white font-normal rounded-xl shadow-lg transition-all text-[10px] uppercase tracking-[0.2em] active:scale-95",children:"Update Status"})]})]})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx(Ft,{label:"License Status"}),o.jsxs("div",{className:"bg-white rounded-[1.5rem] sm:rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-slate-50 bg-slate-50/50 flex justify-between items-center",children:[o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("span",{className:`text-[9px] font-normal uppercase tracking-widest px-3 py-1 rounded-full border ${z?"bg-rose-50 text-rose-600 border-rose-100":"bg-emerald-50 text-emerald-600 border-emerald-100"}`,children:[G," Days Left"]})}),o.jsxs("span",{className:"text-[9px] font-normal text-slate-400 uppercase tracking-widest",children:["Plan: ",i?.plan||"Enterprise"]})]}),o.jsxs("div",{className:"p-6 sm:p-8 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Plan Tier"}),o.jsxs("select",{value:N,onChange:F=>A(F.target.value),className:"w-full p-3 bg-slate-50 border border-slate-100 rounded-xl text-xs font-normal text-slate-700 outline-none",children:[o.jsx("option",{value:"Standard",children:"Standard Fleet"}),o.jsx("option",{value:"Enterprise",children:"Enterprise Pro"}),o.jsx("option",{value:"Unlimited",children:"Corporate Max"})]})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Renewal Expiry"}),o.jsx("input",{type:"date",value:_,onChange:F=>w(F.target.value),className:"w-full p-3 bg-slate-50 border border-slate-100 rounded-xl text-xs font-normal text-slate-700 outline-none"})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("button",{onClick:M,disabled:C,className:"w-full py-3 bg-slate-900 hover:bg-black text-white font-normal rounded-xl shadow-lg transition-all text-[10px] uppercase tracking-[0.2em] active:scale-95 disabled:opacity-50 h-[46px]",children:"Sync License"})})]}),o.jsxs("div",{className:"border-t border-slate-50 pt-4",children:[o.jsxs("button",{onClick:()=>S(!E),className:"flex items-center gap-2 text-[9px] font-normal text-slate-400 uppercase tracking-[0.2em] hover:text-indigo-600 transition-colors",children:[o.jsx("svg",{className:`w-3 h-3 transition-transform ${E?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M19 9l-7 7-7-7"})}),"Registry Audit Trail"]}),E&&o.jsx("div",{className:"mt-4 bg-slate-50/50 rounded-xl overflow-hidden border border-slate-100 max-h-32 overflow-y-auto scrollbar-hide animate-fadeIn",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-slate-50 text-[8px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Sync Date"}),o.jsx("th",{className:"px-4 py-2",children:"Tier"}),o.jsx("th",{className:"px-4 py-2 text-right",children:"Validity"})]})}),o.jsx("tbody",{className:"divide-y divide-slate-50",children:c.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:3,className:"px-4 py-4 text-[9px] text-slate-400 text-center italic",children:"No prior renewal records detected."})}):c.map((F,V)=>o.jsxs("tr",{className:"text-[9px] text-slate-600",children:[o.jsx("td",{className:"px-4 py-2 font-mono uppercase opacity-60",children:F.timestamp?.split("T")[0]||"N/A"}),o.jsx("td",{className:"px-4 py-2 font-normal uppercase tracking-tight",children:F.plan||"Standard"}),o.jsx("td",{className:"px-4 py-2 text-right font-medium text-slate-400",children:F.expiryDate||"N/A"})]},V))})]})})]})]})]})]}),o.jsx("div",{className:"text-center py-2 shrink-0",children:o.jsx("p",{className:"text-[9px] font-normal text-slate-300 uppercase tracking-[0.4em]",children:"Proprietary Modular Framework v2.0"})})]})})},Vf=({appScriptUrl:t,currentUser:e,showToast:n,onRequestNew:s})=>{const[i,a]=T.useState([]),[c,d]=T.useState(!1),p=window.isSubscriptionLocked||!1,u=3e5;T.useEffect(()=>{f();const x=setInterval(f,u);return()=>clearInterval(x)},[e?.username,t]);const f=async()=>{if(!(!t||!e)){i.length===0&&d(!0);try{const v=(await(await fetch(`${t}?t=${new Date().getTime()}`)).json()).Inspection_Requests;if(v&&Array.isArray(v)&&v.length>1){const I=v.slice(1).map(N=>({id:N[0],requester:N[1],truck:N[3],trailer:N[4],type:N[5],reason:N[6],priority:N[7],assignedTo:N[8],status:N[9]||"Pending",timestamp:N[10]})).filter(N=>{const A=e.role.toLowerCase();if(A==="admin"||A==="superadmin")return!0;const _=String(e.name||"").toLowerCase(),w=String(N.requester).toLowerCase()===_,C=String(N.assignedTo).toLowerCase()===_,k=String(N.assignedTo).toLowerCase()==="unassigned";return A==="inspector"&&(C||k)||w}).sort((N,A)=>new Date(A.timestamp).getTime()-new Date(N.timestamp).getTime());a(I)}else a([])}catch(x){console.error("Failed to fetch requests",x),i.length===0&&n("Failed to load requests.","error")}finally{d(!1)}}},m=i.filter(x=>x.status==="Pending").length,h=i.filter(x=>x.status==="Completed").length,g=i.length>0?Math.round(h/i.length*100):0;return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fadeIn px-2 sm:px-4 pb-12",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 px-2",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-slate-800 tracking-tight uppercase",children:"Inspection Requests"}),o.jsx("p",{className:"text-slate-400 font-medium mt-1 uppercase tracking-widest text-[9px]",children:"Live Pipeline"})]}),s&&o.jsxs("button",{onClick:s,disabled:p,className:`w-full sm:w-auto px-6 py-3 text-white font-semibold rounded-xl shadow-md transition-all active:scale-95 flex items-center justify-center gap-2.5 text-[10px] uppercase tracking-widest
                            ${p?"bg-slate-200 cursor-not-allowed text-slate-400 shadow-none":"bg-slate-900 hover:bg-black border-t border-white/10"}
                        `,children:[o.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M12 4v16m8-8H4"})}),"New Request"]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 sm:gap-6",children:[o.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Pending"}),o.jsx("h3",{className:"text-2xl font-semibold text-amber-500",children:m})]}),o.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Completed"}),o.jsx("h3",{className:"text-2xl font-semibold text-emerald-600",children:h})]}),o.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-100 shadow-sm col-span-2 md:col-span-1",children:[o.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Overall Progress"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("h3",{className:"text-2xl font-semibold text-slate-700",children:[g,"%"]}),o.jsx("div",{className:"flex-1 h-1.5 bg-slate-50 rounded-full overflow-hidden border border-slate-100",children:o.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-1000",style:{width:`${g}%`}})})]})]})]}),o.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden flex flex-col",children:[o.jsx("div",{className:"px-6 py-4 bg-slate-50/50 border-b border-slate-100",children:o.jsx("h3",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]",children:"Active Queue"})}),o.jsx("div",{className:"divide-y divide-slate-50",children:c?o.jsxs("div",{className:"py-20 text-center",children:[o.jsx("div",{className:"w-8 h-8 border-3 border-slate-100 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-[10px] font-semibold text-slate-300 uppercase tracking-widest",children:"Updating data..."})]}):i.length===0?o.jsx("div",{className:"py-20 text-center",children:o.jsx("p",{className:"text-[11px] font-medium text-slate-300 uppercase tracking-widest",children:"No active requests found"})}):i.map(x=>o.jsxs("div",{className:"p-5 sm:px-8 sm:py-6 hover:bg-slate-50/30 transition-colors flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-12",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[o.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 ${x.status==="Completed"?"bg-emerald-500":"bg-amber-400 animate-pulse"}`}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"text-sm font-semibold text-slate-800 uppercase tracking-tight truncate",children:x.truck}),o.jsx("div",{className:"text-[10px] text-slate-400 font-medium uppercase tracking-wider",children:x.trailer||"Stand-alone Unit"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:items-center gap-4 sm:gap-12 shrink-0",children:[o.jsxs("div",{className:"min-w-[110px]",children:[o.jsx("div",{className:"text-[11px] font-semibold text-slate-600 uppercase tracking-tight",children:x.type}),o.jsxs("div",{className:`text-[9px] font-bold uppercase tracking-widest ${x.priority==="Critical"||x.priority==="Urgent"?"text-rose-500":"text-slate-400"}`,children:[x.priority," Priority"]})]}),o.jsxs("div",{className:"min-w-[130px] text-right sm:text-left",children:[o.jsx("div",{className:"text-[11px] font-semibold text-slate-600 truncate max-w-[120px]",children:x.assignedTo&&x.assignedTo!=="Unassigned"?x.assignedTo:"Unassigned"}),o.jsx("div",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-widest",children:"Personnel"})]})]}),o.jsxs("div",{className:"flex items-center justify-between sm:justify-end gap-8 pt-3 sm:pt-0 border-t sm:border-t-0 border-slate-50",children:[o.jsxs("div",{className:"text-left sm:text-right shrink-0",children:[o.jsx("div",{className:"text-[11px] font-semibold text-slate-500",children:new Date(x.timestamp).toLocaleDateString()}),o.jsx("div",{className:"text-[9px] text-slate-300 font-bold uppercase tracking-widest",children:new Date(x.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),o.jsx("div",{className:`px-4 py-1.5 rounded-lg text-[9px] font-bold uppercase tracking-widest border shrink-0
                                    ${x.status==="Completed"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-slate-50 text-slate-500 border-slate-200"}
                                `,children:x.status==="Completed"?"Completed":"Pending"})]})]},x.id))})]})]})},Gf=({historyList:t,isLoading:e})=>{const[n,s]=T.useState(!1),[i,a]=T.useState(null),c=T.useMemo(()=>{if(!t.length)return null;const p=t.length,u=t.filter(_=>Number(_.rate)<=2).length,f=t.filter(_=>Number(_.rate)===3).length,m=t.filter(_=>Number(_.rate)>=4).length,h=m/p*100,g=h.toFixed(1),x={},y={},v={"Mechanical & Braking":0,"Tyres & Wheels":0,"Documentation & PPE":0,"Electrical & Lights":0,"Visibility & Body":0,"Fluid Leaks & Environmental":0};t.forEach(_=>{const w=Number(_.rate);if(w<=3&&(x[_.truckNo]=(x[_.truckNo]||0)+1),Object.entries(_).forEach(([C,k])=>{if(k==="Bad"||k==="Needs Attention"){const E=C.toLowerCase();E.includes("brake")||E.includes("mech")||E.includes("fifth")||E.includes("landing")?v["Mechanical & Braking"]++:E.includes("tyre")||E.includes("wheel")||E.includes("nut")?v["Tyres & Wheels"]++:E.includes("road")||E.includes("doc")||E.includes("suit")||E.includes("gear")||E.includes("ppe")||E.includes("manual")?v["Documentation & PPE"]++:E.includes("light")||E.includes("lamp")||E.includes("indica")||E.includes("horn")||E.includes("elec")||E.includes("ignit")?v["Electrical & Lights"]++:E.includes("wind")||E.includes("mirror")||E.includes("screen")||E.includes("cab")||E.includes("body")?v["Visibility & Body"]++:(E.includes("leak")||E.includes("spill")||E.includes("fluid")||E.includes("oil"))&&v["Fluid Leaks & Environmental"]++}}),_.driverName){const C=w===5?10:w===4?5:w===3?-5:-20;y[_.driverName]=(y[_.driverName]||0)+C}});const b=Object.values(v).reduce((_,w)=>_+w,0),I=Object.entries(v).map(([_,w])=>({label:_,count:w,pct:b>0?w/b*100:0})).sort((_,w)=>w.count-_.count),N=Object.entries(y).sort(([,_],[,w])=>w-_).slice(0,3),A=[{label:"Exemplary (5/5)",count:t.filter(_=>Number(_.rate)===5).length,color:"bg-emerald-600"},{label:"Good (4/5)",count:t.filter(_=>Number(_.rate)===4).length,color:"bg-emerald-400"},{label:"Serviceable (3/5)",count:f,color:"bg-amber-400"},{label:"Immediate Action (1-2/5)",count:u,color:"bg-rose-500"}];return{total:p,criticalCount:u,warningCount:f,goodCount:m,passRate:g,passRateNum:h,sortedRisks:I,leaderboard:N,conditionDistribution:A,totalFaults:b}},[t]),d=()=>{c&&(s(!0),setTimeout(()=>{const p=c.passRateNum,u=c.sortedRisks[0];let f="";p>=90?f="The fleet is operating at peak safety compliance.":p>=75?f="Overall fleet health is stable, though minor maintenance trends are emerging.":f="CRITICAL: The fleet safety rating has fallen below acceptable thresholds.";const m=u&&u.count>0?`The systemic analysis identifies '${u.label}' as the primary source of safety downgrades, accounting for ${u.pct.toFixed(0)}% of all recorded faults.`:"No significant systemic failure patterns detected.",h=`EXECUTIVE BRIEFING:
${f} Out of ${c.total} audits, ${c.goodCount} were satisfactory.

SYSTEMIC ANALYSIS:
${m}

STRATEGY:
1. Prioritize preventative maintenance on ${u?.label||"critical systems"}.
2. Reinforce compliance standards for underperforming domains.
3. Review driver pre-trip inspection diligence for high-frequency fault areas.`;a(h),s(!1)},600))};return e?o.jsxs("div",{className:"flex flex-col items-center justify-center py-24 gap-4",children:[o.jsx("div",{className:"w-12 h-12 border-4 border-slate-100 border-t-indigo-600 rounded-full animate-spin"}),o.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Compiling Fleet Intelligence..."})]}):c?o.jsxs("div",{className:"max-w-6xl mx-auto space-y-10 animate-fadeIn font-sans pb-24 px-4 md:px-0",children:[o.jsxs("div",{className:"flex justify-between items-end px-2",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tight leading-none",children:"Fleet Insights"}),o.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-[0.3em] mt-3",children:"Safety & Risk Intelligence"})]}),o.jsx("div",{className:"text-right hidden sm:block",children:o.jsx("span",{className:"text-[10px] font-black text-slate-300 uppercase tracking-widest",children:"Analytics Engine v3.0"})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Total Audits"}),o.jsx("h3",{className:"text-4xl font-black text-slate-900",children:c.total})]}),o.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[10px] font-black text-emerald-500 uppercase tracking-widest mb-4",children:"Pass Rate"}),o.jsxs("h3",{className:"text-4xl font-black text-emerald-600",children:[c.passRate,"%"]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-100 shadow-sm",children:[o.jsx("p",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest mb-4",children:"Warnings"}),o.jsx("h3",{className:"text-4xl font-black text-amber-600",children:c.warningCount})]}),o.jsxs("div",{className:"bg-rose-50 p-6 rounded-3xl border border-rose-100 shadow-sm",children:[o.jsx("p",{className:"text-[10px] font-black text-rose-500 uppercase tracking-widest mb-4",children:"Grounded"}),o.jsx("h3",{className:"text-4xl font-black text-rose-600",children:c.criticalCount})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-indigo-900 via-slate-900 to-black p-10 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-indigo-500/10 rounded-full -mr-32 -mt-32 blur-3xl"}),o.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-12",children:[o.jsxs("div",{className:"max-w-md text-center md:text-left",children:[o.jsx("h4",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.2em] mb-4",children:"Safety Excellence Leaderboard"}),o.jsx("p",{className:"text-slate-400 text-sm font-medium leading-relaxed",children:"Recognizing outstanding safety standards. Points are aggregated from deterministic vehicle health scores."})]}),o.jsxs("div",{className:"flex items-end gap-2 sm:gap-6 pt-10",children:[c.leaderboard[1]&&o.jsxs("div",{className:"flex flex-col items-center group",children:[o.jsx("div",{className:"w-12 h-12 bg-slate-400/20 rounded-full border border-slate-400/30 flex items-center justify-center font-black text-slate-300 mb-2 group-hover:scale-110 transition-transform",children:"2"}),o.jsxs("div",{className:"w-20 sm:w-28 h-20 sm:h-24 bg-gradient-to-t from-slate-400/20 to-slate-400/40 rounded-t-2xl border-x border-t border-slate-400/20 p-4 text-center",children:[o.jsx("p",{className:"text-[8px] font-black text-slate-400 uppercase truncate",children:c.leaderboard[1][0]}),o.jsxs("p",{className:"text-xs font-black text-white mt-1",children:[c.leaderboard[1][1]," pts"]})]})]}),c.leaderboard[0]&&o.jsxs("div",{className:"flex flex-col items-center group",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-500/20 rounded-full border border-amber-500/40 flex items-center justify-center font-black text-amber-400 mb-2 shadow-[0_0_20px_rgba(245,158,11,0.2)] group-hover:scale-110 transition-transform",children:"1"}),o.jsxs("div",{className:"w-24 sm:w-32 h-28 sm:h-36 bg-gradient-to-t from-amber-500/20 to-amber-500/40 rounded-t-2xl border-x border-t border-amber-500/30 p-4 text-center",children:[o.jsx("p",{className:"text-[10px] font-black text-amber-300 uppercase truncate",children:c.leaderboard[0][0]}),o.jsxs("p",{className:"text-lg font-black text-white mt-1",children:[c.leaderboard[0][1]," pts"]}),o.jsx("div",{className:"mt-3 flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-amber-400 animate-bounce",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})})]})]}),c.leaderboard[2]&&o.jsxs("div",{className:"flex flex-col items-center group",children:[o.jsx("div",{className:"w-12 h-12 bg-orange-800/20 rounded-full border border-orange-800/30 flex items-center justify-center font-black text-orange-400 mb-2 group-hover:scale-110 transition-transform",children:"3"}),o.jsxs("div",{className:"w-20 sm:w-28 h-16 sm:h-20 bg-gradient-to-t from-orange-800/20 to-orange-800/40 rounded-t-2xl border-x border-t border-orange-800/20 p-4 text-center",children:[o.jsx("p",{className:"text-[8px] font-black text-orange-300 uppercase truncate",children:c.leaderboard[2][0]}),o.jsxs("p",{className:"text-xs font-black text-white mt-1",children:[c.leaderboard[2][1]," pts"]})]})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-white p-6 sm:p-10 rounded-[2.5rem] border border-slate-100 shadow-sm",children:[o.jsxs("h4",{className:"text-sm font-black text-slate-800 uppercase tracking-widest mb-8 flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),"Asset Condition Profile"]}),o.jsx("div",{className:"space-y-6",children:c.conditionDistribution.map((p,u)=>{const f=(p.count/c.total*100).toFixed(0);return o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-[11px] font-bold text-slate-500 uppercase tracking-tighter",children:[o.jsx("span",{children:p.label}),o.jsxs("span",{className:"text-slate-900",children:[p.count," Units (",f,"%)"]})]}),o.jsx("div",{className:"h-3 bg-slate-50 rounded-lg overflow-hidden border border-slate-100",children:o.jsx("div",{className:`h-full ${p.color} transition-all duration-1000`,style:{width:`${f}%`}})})]},u)})})]}),o.jsxs("div",{className:"bg-slate-900 p-6 sm:p-10 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden flex flex-col",children:[o.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 rounded-full -mr-20 -mt-20 blur-3xl"}),o.jsxs("div",{className:"flex justify-between items-start mb-8 relative z-10",children:[o.jsx("h4",{className:"text-sm font-black text-indigo-400 uppercase tracking-widest",children:"Systemic Risk Profile"}),o.jsx("span",{className:"text-[8px] font-black bg-white/10 px-2 py-1 rounded text-slate-400 uppercase tracking-widest",children:"Fault Frequency"})]}),o.jsx("div",{className:"flex-1 space-y-6 relative z-10 overflow-y-auto pr-2 scrollbar-hide",children:c.totalFaults>0?c.sortedRisks.map((p,u)=>o.jsxs("div",{className:"space-y-2 group",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300 group-hover:text-white transition-colors",children:p.label}),o.jsxs("p",{className:"text-[10px] font-bold text-indigo-400",children:[p.count," Faults"]})]}),o.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden border border-white/5",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 to-indigo-400 transition-all duration-1000 ease-out",style:{width:`${p.pct}%`}})})]},u)):o.jsx("div",{className:"h-40 flex items-center justify-center",children:o.jsx("p",{className:"text-slate-500 italic text-sm text-center px-6",children:"No systemic safety failures identified in active registry."})})}),o.jsx("p",{className:"text-[8px] text-slate-500 font-bold uppercase tracking-[0.2em] mt-6 border-t border-white/5 pt-4",children:"Root-Cause Intelligence Hub v3.0 (Pattern Logic)"})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-8 sm:p-10 rounded-[2.5rem] border border-slate-100 shadow-sm flex flex-col md:flex-row items-center justify-between gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-black text-lg uppercase tracking-tight leading-none",children:"Management Briefing"}),o.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1",children:"Cross-Fleet Logic Aggregator"})]}),o.jsx("button",{onClick:d,disabled:n,className:"w-full md:w-auto px-8 py-3 bg-slate-900 text-white rounded-xl font-black text-[11px] uppercase tracking-widest hover:bg-black transition-all shadow-lg active:scale-95 disabled:bg-slate-200",children:n?"Analyzing Patterns...":"Generate Executive Brief"})]}),i&&o.jsx("div",{className:"bg-white p-10 rounded-[2.5rem] border border-slate-100 shadow-2xl animate-fadeIn",children:o.jsx("div",{className:"prose prose-slate max-w-none",children:o.jsx("p",{className:"text-slate-700 font-medium whitespace-pre-wrap leading-relaxed text-sm",children:i})})})]})]}):o.jsx("div",{className:"py-24 text-center",children:o.jsx("p",{className:"text-slate-400 font-medium text-sm italic",children:"Insufficient data to generate analytics report."})})},Hf=({historyList:t,isLoading:e,onClose:n})=>{const s=T.useMemo(()=>{if(!t.length)return null;const i={};t.forEach(f=>{(!i[f.truckNo]||new Date(f.timestamp)>new Date(i[f.truckNo].timestamp))&&(i[f.truckNo]=f)});const a=Object.values(i),c=a.filter(f=>Number(f.rate)<=2),d=a.filter(f=>Number(f.rate)===3),p=a.filter(f=>Number(f.rate)>=4),u=[...t].sort((f,m)=>new Date(m.timestamp).getTime()-new Date(f.timestamp).getTime()).slice(0,12);return{grounded:c,warning:d,active:p,recentLogs:u,totalAssets:a.length}},[t]);return e?o.jsxs("div",{className:"fixed inset-0 z-[200] bg-slate-950 flex flex-col items-center justify-center gap-6",children:[o.jsx("div",{className:"w-16 h-16 border-4 border-slate-900 border-t-emerald-500 rounded-full animate-spin"}),o.jsx("p",{className:"text-xs font-black text-slate-400 uppercase tracking-widest",children:"Waking Operations Monitor..."})]}):s?o.jsxs("div",{className:"fixed inset-0 z-[200] bg-slate-950 text-white overflow-hidden flex flex-col font-sans",children:[o.jsxs("div",{className:"h-20 border-b border-white/5 flex items-center justify-between px-10 shrink-0 bg-slate-900/50 backdrop-blur-md",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center font-black text-xl italic shadow-[0_0_20px_rgba(79,70,229,0.4)]",children:"S"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-black uppercase tracking-tighter leading-none",children:"Fleet Control Center"}),o.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-[0.3em] mt-1",children:"Live Telemetry Interface"})]})]}),o.jsxs("div",{className:"hidden lg:flex gap-10",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Fleet Deployment"}),o.jsx("p",{className:"text-2xl font-black tracking-tight",children:s.totalAssets})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-[9px] font-bold text-emerald-500 uppercase tracking-widest mb-1",children:"Operational"}),o.jsx("p",{className:"text-2xl font-black text-emerald-400 tracking-tight",children:s.active.length})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-[9px] font-bold text-rose-500 uppercase tracking-widest mb-1",children:"Grounded"}),o.jsx("p",{className:"text-2xl font-black text-rose-400 tracking-tight",children:s.grounded.length})]})]}),o.jsxs("button",{onClick:n,className:"px-6 py-2.5 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 group",children:[o.jsx("svg",{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M15 19l-7-7 7-7"})}),"Exit Monitor"]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-px bg-white/5 overflow-hidden",children:[o.jsxs("div",{className:"col-span-12 md:col-span-3 bg-slate-950 flex flex-col",children:[o.jsx("div",{className:"p-6 border-b border-white/5",children:o.jsxs("h3",{className:"text-xs font-black text-rose-500 uppercase tracking-[0.2em] flex items-center gap-2",children:[o.jsx("span",{className:"w-2 h-2 rounded-full bg-rose-500 animate-ping"}),"Safety Exceptions"]})}),o.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-4 space-y-3",children:s.grounded.length===0?o.jsx("div",{className:"h-full flex items-center justify-center text-slate-600 text-[10px] font-bold uppercase tracking-widest italic text-center px-4",children:"No critical exceptions detected in active fleet."}):s.grounded.map((i,a)=>o.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 rounded-2xl p-5 animate-pulse",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsx("span",{className:"text-lg font-black text-white tracking-tighter uppercase",children:i.truckNo}),o.jsx("span",{className:"text-[10px] font-bold text-rose-400 bg-rose-950 px-2 py-0.5 rounded border border-rose-800",children:"GROUNDED"})]}),o.jsxs("p",{className:"text-[10px] text-rose-200/60 font-medium leading-relaxed italic line-clamp-2",children:['"',i.remarks,'"']}),o.jsxs("div",{className:"mt-4 pt-4 border-t border-rose-500/10 flex justify-between items-end",children:[o.jsx("span",{className:"text-[8px] font-bold text-rose-300 uppercase",children:i.inspectedBy}),o.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:new Date(i.timestamp).toLocaleDateString()})]})]},a))})]}),o.jsxs("div",{className:"hidden md:flex md:col-span-5 bg-slate-900/20 flex-col border-x border-white/5",children:[o.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center",children:[o.jsx("h3",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em]",children:"Activity Stream"}),o.jsx("span",{className:"text-[8px] text-indigo-400 font-black animate-pulse uppercase",children:"Syncing Now"})]}),o.jsxs("div",{className:"flex-1 overflow-hidden p-6 relative",children:[o.jsx("div",{className:"space-y-4",children:s.recentLogs.map((i,a)=>o.jsxs("div",{className:"flex items-center gap-6 p-4 bg-white/5 rounded-2xl border border-white/5 hover:bg-white/10 transition-all duration-500 group",children:[o.jsx("div",{className:`w-3 h-3 rounded-full shrink-0 shadow-[0_0_10px_currentColor] ${Number(i.rate)>=4?"text-emerald-500":Number(i.rate)===3?"text-amber-500":"text-rose-500"} bg-current`}),o.jsxs("div",{className:"flex-1 flex items-center justify-between min-w-0",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-black uppercase tracking-tight group-hover:text-indigo-300 transition-colors",children:i.truckNo}),o.jsx("p",{className:"text-[9px] text-slate-500 font-bold uppercase tracking-widest",children:i.inspectedBy})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-xs font-black text-slate-300",children:[i.rate,"/5"]}),o.jsx("p",{className:"text-[8px] font-medium text-slate-600 uppercase mt-1",children:new Date(i.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})]},a))}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-slate-950 to-transparent"})]})]}),o.jsxs("div",{className:"hidden lg:flex lg:col-span-4 bg-slate-950 flex flex-col",children:[o.jsx("div",{className:"p-6 border-b border-white/5",children:o.jsx("h3",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em]",children:"Asset Inventory Status"})}),o.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-6",children:o.jsx("div",{className:"grid grid-cols-2 gap-3",children:[...s.active,...s.warning,...s.grounded].map((i,a)=>o.jsxs("div",{className:"p-3 rounded-xl bg-white/5 border border-white/5 flex items-center justify-between",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[11px] font-black uppercase truncate",children:i.truckNo}),o.jsx("p",{className:"text-[8px] text-slate-500 font-bold uppercase mt-0.5",children:i.location})]}),o.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Number(i.rate)>=4?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]":Number(i.rate)===3?"bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.4)]":"bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.4)]"}`})]},a))})}),o.jsx("div",{className:"p-6 border-t border-white/5 bg-slate-900/30 text-center",children:o.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"© SCBC Operations Desk 2026"})})]})]})]}):null},Bf=[{id:"1",title:"Tire Inspection SOP",category:"SOP",url:"#",description:"Standard protocol for multi-point tire wear and pressure auditing."},{id:"2",title:"Acid Handling Safety",category:"Safety",url:"#",description:"Emergency protocols for sulfuric and hydrochloric acid transport."},{id:"3",title:"Petroleum V2 Guidelines",category:"Manual",url:"#",description:"Detailed walkthrough of the updated Petroleum V2 checklist."},{id:"4",title:"Brake Testing Video",category:"Video",url:"#",description:"Instructional video on conducting static and dynamic brake tests."},{id:"5",title:"PPE Compliance 2026",category:"Safety",url:"#",description:"Latest requirements for protective gear in high-risk zones."},{id:"6",title:"Electronic Logging Manual",category:"Manual",url:"#",description:"Guide for using the electronic on-board recording system."}],qf=()=>{const[t,e]=T.useState(""),[n,s]=T.useState("All"),i=Bf.filter(a=>{const c=a.title.toLowerCase().includes(t.toLowerCase())||a.description.toLowerCase().includes(t.toLowerCase()),d=n==="All"||a.category===n;return c&&d});return o.jsxs("div",{className:"max-w-6xl mx-auto space-y-10 animate-fadeIn font-sans pb-24",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-6 px-2",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tight leading-none",children:"Resource Vault"}),o.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-[0.3em] mt-3",children:"SOPs, Manuals & Compliance Media"})]}),o.jsx("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 scrollbar-hide",children:["All","SOP","Manual","Safety","Video"].map(a=>o.jsx("button",{onClick:()=>s(a),className:`px-6 py-2 rounded-full text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap
                                ${n===a?"bg-indigo-600 text-white shadow-lg shadow-indigo-100":"bg-slate-100 text-slate-500 hover:bg-slate-200"}
                            `,children:a},a))})]}),o.jsxs("div",{className:"relative",children:[o.jsx("svg",{className:"w-5 h-5 absolute left-5 top-1/2 -translate-y-1/2 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),o.jsx("input",{type:"text",placeholder:"Search documentation library...",className:"w-full pl-14 pr-6 py-5 bg-white border border-slate-100 rounded-3xl shadow-sm outline-none focus:ring-4 focus:ring-indigo-50 transition-all font-medium text-slate-700",value:t,onChange:a=>e(a.target.value)})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:i.map(a=>o.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 p-8 shadow-sm hover:shadow-xl transition-all group flex flex-col justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-start mb-6",children:[o.jsx("div",{className:`px-4 py-1 rounded-full text-[9px] font-black uppercase tracking-[0.2em]
                                    ${a.category==="SOP"?"bg-emerald-50 text-emerald-600":a.category==="Video"?"bg-rose-50 text-rose-600":a.category==="Manual"?"bg-blue-50 text-blue-600":"bg-amber-50 text-amber-600"}
                                `,children:a.category}),o.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-50 flex items-center justify-center text-slate-300 group-hover:bg-indigo-50 group-hover:text-indigo-600 transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})]}),o.jsx("h3",{className:"text-lg font-black text-slate-800 uppercase tracking-tight mb-2 group-hover:text-indigo-600 transition-colors",children:a.title}),o.jsx("p",{className:"text-slate-500 text-xs font-medium leading-relaxed",children:a.description})]}),o.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"mt-8 flex items-center justify-between px-6 py-3 bg-slate-50 hover:bg-indigo-600 hover:text-white rounded-xl transition-all text-[10px] font-black uppercase tracking-widest text-slate-500",children:["Open Resource",o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]},a.id))}),i.length===0&&o.jsx("div",{className:"py-20 text-center",children:o.jsx("p",{className:"text-slate-400 font-medium text-sm italic",children:"No resources found matching your search."})})]})},Of=({appScriptUrl:t,validationLists:e,onRefresh:n,showToast:s,isLocked:i})=>{const[a,c]=T.useState(""),[d,p]=T.useState(""),[u,f]=T.useState(""),[m,h]=T.useState(""),[g,x]=T.useState(!1),[y,v]=T.useState(!1),[b,I]=T.useState(!1),N=T.useRef(null),A=T.useMemo(()=>e.trucks.filter(S=>S.toLowerCase().includes(u.toLowerCase())).slice(0,100),[e.trucks,u]),_=T.useMemo(()=>e.trailers.filter(S=>S.toLowerCase().includes(m.toLowerCase())).slice(0,100),[e.trailers,m]),w=async S=>{const R=(S==="truck"?a:d).trim().toUpperCase();if(!R||i)return;if((S==="truck"?e.trucks:e.trailers).some(M=>M.toUpperCase()===R)){s(`${S==="truck"?"Truck":"Trailer"} already exists.`,"warning");return}x(!0);try{await fetch(t,{method:"POST",body:JSON.stringify({action:"manage_fleet",type:S,value:R}),mode:"no-cors"}),s(`${S==="truck"?"Truck":"Trailer"} added.`,"success"),S==="truck"?c(""):p(""),setTimeout(n,1e3)}finally{x(!1)}},C=()=>{const S=`Truck,Trailer
`,R=`ZM 1234,T-001
ZM 5678,T-002`,U=new Blob([S+R],{type:"text/csv;charset=utf-8;"}),M=URL.createObjectURL(U),G=document.createElement("a");G.setAttribute("href",M),G.setAttribute("download","fleet_import_template.csv"),G.click(),URL.revokeObjectURL(M)},k=()=>{const S=`Truck,Trailer
`,R=Math.max(e.trucks.length,e.trailers.length);let U="";for(let F=0;F<R;F++){const V=e.trucks[F]||"",W=e.trailers[F]||"";U+=`${V},${W}
`}const M=new Blob([S+U],{type:"text/csv;charset=utf-8;"}),G=URL.createObjectURL(M),z=document.createElement("a");z.setAttribute("href",G),z.setAttribute("download",`fleet_export_${new Date().toISOString().split("T")[0]}.csv`),z.click(),URL.revokeObjectURL(G)},E=S=>{const R=S.target.files?.[0];if(!R||i)return;const U=new FileReader;U.onload=async M=>{const G=M.target?.result;if(G){v(!0);try{const z=G.split(/\r?\n/),F=[],V=[];for(let W=1;W<z.length;W++){const B=z[W].trim();if(!B)continue;const se=B.split(","),Q=se[0]?.trim().toUpperCase(),fe=se[1]?.trim().toUpperCase();Q&&!e.trucks.includes(Q)&&F.push(Q),fe&&!e.trailers.includes(fe)&&V.push(fe)}if(F.length===0&&V.length===0){s("No unique data found.","info");return}await fetch(t,{method:"POST",body:JSON.stringify({action:"bulk_manage_fleet",trucks:F,trailers:V}),mode:"no-cors"}),s("Bulk import synced.","success"),setTimeout(n,1500)}finally{v(!1),N.current&&(N.current.value="")}}},U.readAsText(R)};return o.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col h-[calc(100vh-140px)] py-2 sm:py-4 px-2 sm:px-4 animate-fadeIn font-sans overflow-hidden",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 px-2 mb-6 shrink-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-normal text-slate-800 uppercase tracking-tight leading-none",children:"Fleet Registry"}),o.jsx("p",{className:"text-[9px] text-slate-400 font-medium uppercase tracking-[0.3em] mt-2",children:"Assets & Equipment"})]}),o.jsxs("div",{className:"flex gap-1.5 w-full sm:w-auto",children:[o.jsxs("button",{onClick:k,className:"flex-1 sm:flex-none px-4 py-3 bg-white border border-slate-200 text-slate-500 rounded-xl font-medium text-[10px] uppercase tracking-widest transition-all hover:bg-slate-50 active:scale-95 flex items-center justify-center gap-2 shadow-sm",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:o.jsx("path",{d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]}),o.jsx("button",{onClick:()=>I(!0),className:"p-3 bg-white border border-slate-200 text-indigo-500 rounded-xl hover:bg-indigo-50 transition-all shadow-sm",title:"Bulk Import Guide",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("input",{type:"file",accept:".csv",className:"hidden",ref:N,onChange:E}),o.jsxs("button",{onClick:()=>N.current?.click(),disabled:i||y,className:"flex-[2] sm:flex-none px-6 py-3 bg-slate-900 text-white rounded-xl font-medium text-[10px] uppercase tracking-widest transition-all hover:bg-black active:scale-95 disabled:opacity-30 flex items-center justify-center gap-2 shadow-lg",children:[y?o.jsxs("svg",{className:"animate-spin h-3.5 w-3.5 text-white",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Bulk Sync"]})]})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 min-h-0",children:[o.jsxs("div",{className:"flex flex-col min-h-0 bg-white rounded-[1.5rem] border border-slate-100 shadow-sm overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b border-slate-50 bg-slate-50/30 shrink-0",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-widest",children:["Horses (",e.trucks.length,")"]})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Enter Reg...",className:"flex-1 px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-normal uppercase outline-none focus:ring-4 focus:ring-indigo-50/50 transition-all placeholder:text-slate-300 placeholder:normal-case",value:a,onChange:S=>c(S.target.value.toUpperCase())}),o.jsx("button",{onClick:()=>w("truck"),disabled:g||!a.trim()||i,className:"px-6 py-3 bg-slate-900 hover:bg-black text-white rounded-xl font-medium text-[10px] uppercase tracking-widest transition-all active:scale-95 disabled:opacity-30 shrink-0",children:"Add"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",strokeWidth:"2.5"})}),o.jsx("input",{type:"text",placeholder:"Filter horses...",className:"w-full pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-xl text-[11px] font-normal outline-none focus:border-indigo-200 transition-all",value:u,onChange:S=>f(S.target.value)})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:o.jsx("div",{className:"divide-y divide-slate-50",children:A.length===0?o.jsx("div",{className:"p-12 text-center text-[10px] font-medium text-slate-300 uppercase tracking-widest italic",children:"No matches"}):A.map((S,R)=>o.jsx("div",{className:"px-6 py-3 flex items-center justify-between hover:bg-slate-50/50 transition-colors group",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-100 group-hover:bg-indigo-400 transition-colors"}),o.jsx("span",{className:"text-sm font-normal text-slate-600 group-hover:text-slate-900 transition-colors",children:S})]})},R))})})]}),o.jsxs("div",{className:"flex flex-col min-h-0 bg-white rounded-[1.5rem] border border-slate-100 shadow-sm overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b border-slate-50 bg-slate-50/30 shrink-0",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-widest",children:["Trailers (",e.trailers.length,")"]})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Enter ID...",className:"flex-1 px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-normal uppercase outline-none focus:ring-4 focus:ring-emerald-50/50 transition-all placeholder:text-slate-300 placeholder:normal-case",value:d,onChange:S=>p(S.target.value.toUpperCase())}),o.jsx("button",{onClick:()=>w("trailer"),disabled:g||!d.trim()||i,className:"px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-medium text-[10px] uppercase tracking-widest transition-all active:scale-95 disabled:opacity-30 shrink-0",children:"Add"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",strokeWidth:"2.5"})}),o.jsx("input",{type:"text",placeholder:"Filter trailers...",className:"w-full pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-xl text-[11px] font-normal outline-none focus:border-emerald-200 transition-all",value:m,onChange:S=>h(S.target.value)})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:o.jsx("div",{className:"divide-y divide-slate-50",children:_.length===0?o.jsx("div",{className:"p-12 text-center text-[10px] font-medium text-slate-300 uppercase tracking-widest italic",children:"No matches"}):_.map((S,R)=>o.jsx("div",{className:"px-6 py-3 flex items-center justify-between hover:bg-slate-50/50 transition-colors group",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-100 group-hover:bg-emerald-400 transition-colors"}),o.jsx("span",{className:"text-sm font-normal text-slate-600 group-hover:text-slate-900 transition-colors",children:S})]})},R))})})]})]}),b&&o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-fadeIn",children:o.jsx("div",{className:"bg-white rounded-[2rem] shadow-2xl w-full max-w-md overflow-hidden animate-fadeIn",children:o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"flex justify-between items-start mb-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-normal text-slate-800 uppercase tracking-tight",children:"Bulk Import Guide"}),o.jsx("p",{className:"text-[9px] text-indigo-500 font-bold uppercase tracking-widest mt-1",children:"Setup Instructions"})]}),o.jsx("button",{onClick:()=>I(!1),className:"p-2 hover:bg-slate-50 rounded-full transition-colors text-slate-400",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"space-y-6 text-sm font-normal text-slate-600 leading-relaxed",children:[o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center shrink-0 font-bold text-xs",children:"1"}),o.jsxs("p",{children:["Ensure your file is in ",o.jsx("strong",{className:"text-slate-900 font-medium",children:"CSV (.csv)"})," format. Use commas to separate columns."]})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center shrink-0 font-bold text-xs",children:"2"}),o.jsxs("p",{children:["The first row must be the header: ",o.jsx("code",{className:"bg-slate-50 px-2 py-1 rounded text-indigo-600 font-mono text-xs",children:"Truck,Trailer"})]})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center shrink-0 font-bold text-xs",children:"3"}),o.jsx("p",{children:"Duplicates or small letters will be automatically converted and handled by the system."})]}),o.jsxs("div",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-100 flex items-center justify-between",children:[o.jsx("p",{className:"text-xs font-medium text-slate-400 uppercase tracking-tight",children:"Need a template?"}),o.jsx("button",{onClick:C,className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest hover:text-indigo-800 transition-colors",children:"Get Sample File"})]})]}),o.jsx("button",{onClick:()=>I(!1),className:"w-full mt-10 py-4 bg-slate-900 text-white font-medium rounded-xl text-[10px] uppercase tracking-[0.2em] active:scale-95 transition-all shadow-lg",children:"Got It"})]})})})]})},$f=({data:t,settings:e})=>o.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[o.jsxs("div",{className:"flex flex-col items-center mb-6",children:[o.jsx("div",{className:"flex flex-col items-center justify-center gap-2 mb-6 w-full",children:e.companyLogo?o.jsx("img",{src:e.companyLogo,alt:"Company Logo",className:"h-28 max-w-sm object-contain"}):o.jsx("div",{className:"text-center py-4",children:o.jsx("h1",{className:"text-3xl font-serif font-bold text-gray-900 tracking-wide",children:e.companyName||"Company Name"})})}),o.jsxs("div",{className:"w-full border-2 border-black mt-2",children:[o.jsxs("div",{className:"grid grid-cols-3 divide-x-2 divide-black border-b-2 border-black",children:[o.jsx("div",{className:"p-1.5 pl-2 font-medium text-sm",children:"Doc. No. MNT-F-015"}),o.jsx("div",{className:"p-1.5 pl-2 font-medium text-sm",children:"Revision No.: 01"}),o.jsxs("div",{className:"p-1.5 pl-2 font-medium text-sm",children:["Date/Time: ",new Date(t.timestamp).toLocaleString()]})]}),o.jsx("div",{className:"p-2 text-center font-black text-xl uppercase tracking-wide bg-gray-50",children:"GENERAL VEHICLE CHECKLIST"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-3 mb-6 p-4 border border-gray-300 text-xs",children:[o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Reg No:"}),o.jsx("span",{className:"font-mono font-bold text-base border-b border-gray-300",children:t.truckNo||"N/A"})]}),o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Trailer/Unit:"}),o.jsx("span",{className:"font-mono font-bold text-base border-b border-gray-300",children:t.trailerNo||"N/A"})]}),o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Driver Name:"}),o.jsx("span",{className:"font-medium border-b border-gray-300",children:t.driverName||"N/A"})]}),o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Inspected By:"}),o.jsx("span",{className:"font-medium border-b border-gray-300",children:t.inspectedBy||"N/A"})]}),o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Location:"}),o.jsx("span",{className:"font-medium border-b border-gray-300",children:t.location||"N/A"})]}),o.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-2 items-center",children:[o.jsx("span",{className:"font-bold uppercase text-gray-600",children:"Odometer:"}),o.jsxs("span",{className:"font-medium border-b border-gray-300",children:[t.odometer||"N/A"," km"]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"grid grid-cols-2 gap-x-8 gap-y-0 border-t border-gray-300",children:Be.map((n,s)=>{const i=t[n.id];let a="text-gray-900",c="";return i==="Bad"&&(a="text-red-700 font-bold",c="bg-red-50"),i==="Needs Attention"&&(a="text-amber-700 font-bold",c="bg-amber-50"),i==="Nil"&&(a="text-gray-400 italic"),o.jsxs("div",{className:`flex justify-between items-center border-b border-gray-300 py-1.5 px-2 text-xs ${c} ${s%2===0?"pr-4 border-r border-gray-300":"pl-4"}`,children:[o.jsx("span",{className:"text-gray-800 font-medium",children:n.label}),o.jsx("span",{className:`uppercase tracking-tighter ${a}`,children:i})]},n.id)})})}),o.jsxs("div",{className:"grid grid-cols-2 gap-12 mt-8 border-t-2 border-black pt-6 break-inside-avoid",children:[o.jsxs("div",{className:"text-center",children:[t.driverSignature?o.jsx("img",{src:t.driverSignature,className:"h-12 mx-auto mb-1",alt:"Driver Sig"}):o.jsx("div",{className:"h-12"}),o.jsx("p",{className:"border-t border-gray-400 pt-1 font-bold uppercase text-[10px] tracking-widest text-gray-600",children:"Driver Signature"})]}),o.jsxs("div",{className:"text-center",children:[t.inspectorSignature?o.jsx("img",{src:t.inspectorSignature,className:"h-12 mx-auto mb-1",alt:"Inspector Sig"}):o.jsx("div",{className:"h-12"}),o.jsx("p",{className:"border-t border-gray-400 pt-1 font-bold uppercase text-[10px] tracking-widest text-gray-600",children:"Inspector Signature"})]})]})]}),Jf=({data:t,settings:e})=>o.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[o.jsxs("div",{className:"border border-black mb-6",children:[o.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x divide-black border-b border-black",children:[o.jsx("div",{className:"p-2 flex items-center justify-center",children:e.companyLogo?o.jsx("img",{src:e.companyLogo,alt:"Logo",className:"w-20 object-contain"}):o.jsx("span",{className:"font-bold text-xs",children:e.companyName})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"border-b border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT – F – 002"}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-2",children:o.jsx("h1",{className:"text-xl font-bold uppercase tracking-wider text-center",children:"PETROLEUM TANKER CHECKLIST"})})]}),o.jsxs("div",{className:"text-xs divide-y divide-black",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Initial Issue Date"}),o.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision Date:"}),o.jsx("span",{className:"p-1 text-center",children:"01/02/2024"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision No."}),o.jsx("span",{className:"p-1 text-center",children:"05"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Next Revision:"}),o.jsx("span",{className:"p-1 text-center",children:"12/04/2026"})]})]})]}),o.jsx("div",{className:"bg-gray-50 p-4 text-xs font-mono border-b border-black",children:o.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"TRUCK #:"})," ",o.jsx("span",{className:"font-bold",children:t.truckNo})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"TRAILER #:"})," ",o.jsx("span",{className:"font-bold",children:t.trailerNo})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"JOB CARD #:"})," ",o.jsx("span",{className:"font-bold",children:t.jobCard})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"DATE/TIME:"})," ",o.jsx("span",{className:"font-bold",children:new Date(t.timestamp).toLocaleString()})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"ODOMETER:"})," ",o.jsx("span",{className:"font-bold",children:t.odometer})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"LOCATION:"})," ",o.jsx("span",{className:"font-bold",children:t.location})]})]})}),o.jsx("div",{className:"p-2 text-[10px] text-center font-medium border-black bg-gray-100 italic",children:"NA = Not Applicable, NI = Not Inspected, Tick to indicate status under Good Order or Needs Attention. If Tick Critical (Bad), The Truck Must Not Leave The Garage Until The Problem Has Been Fixed."})]}),o.jsxs("div",{className:"border border-black text-xs",children:[o.jsxs("div",{className:"grid grid-cols-[30px_1fr_60px_70px_60px_1fr] bg-gray-300 border-b border-black font-bold text-center items-center py-2",children:[o.jsx("span",{children:"No."}),o.jsx("span",{className:"text-left pl-2",children:"ITEM DESCRIPTION"}),o.jsx("span",{children:"Good Order"}),o.jsx("span",{children:"Needs Attn"}),o.jsx("span",{children:"Critical"}),o.jsx("span",{children:"COMMENTS"})]}),yt.map((n,s)=>{const i=t[n.id],a=i===K.GOOD,c=i===K.ATTENTION,d=i===K.BAD,p=n.label.split(". "),u=p[0]+".",f=p.slice(1).join(". ");return o.jsxs("div",{className:`grid grid-cols-[30px_1fr_60px_70px_60px_1fr] border-b border-gray-400 min-h-[30px] items-center ${s%2===0?"bg-white":"bg-gray-50"}`,children:[o.jsx("span",{className:"text-center font-medium",children:u}),o.jsx("span",{className:"pl-2 border-l border-gray-300 h-full flex items-center py-1",children:f}),o.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-green-600",children:a?"✓":""}),o.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-amber-600",children:c?"!":""}),o.jsx("span",{className:"border-l border-gray-300 h-full flex items-center justify-center font-bold text-red-600 bg-red-50",children:d?"X":""}),o.jsx("span",{className:"border-l border-gray-300 h-full flex items-center pl-2 italic text-gray-500 py-1",children:d?"CRITICAL FAULT":c?"Check required":""})]},n.id)})]}),o.jsxs("div",{className:"mt-6 border border-black p-2 min-h-[60px]",children:[o.jsx("span",{className:"font-bold underline",children:"Remarks:"})," ",t.remarks]}),o.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8 text-xs",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Inspected By:"})," ",o.jsx("span",{className:"font-bold",children:t.inspectedBy})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[o.jsx("span",{children:"Inspector Sign:"}),t.inspectorSignature&&o.jsx("img",{src:t.inspectorSignature,className:"h-8",alt:"Sig"})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Date:"})," ",o.jsx("span",{children:new Date(t.timestamp).toLocaleDateString()})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Driver Name:"})," ",o.jsx("span",{className:"font-bold",children:t.driverName})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[o.jsx("span",{children:"Driver Sign:"}),t.driverSignature&&o.jsx("img",{src:t.driverSignature,className:"h-8",alt:"Sig"})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Date:"})," ",o.jsx("span",{children:new Date(t.timestamp).toLocaleDateString()})]})]})]})]}),Wf=({data:t,settings:e})=>o.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[o.jsxs("div",{className:"border border-black mb-6",children:[o.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x divide-black border-b border-black",children:[o.jsx("div",{className:"p-2 flex items-center justify-center",children:e.companyLogo?o.jsx("img",{src:e.companyLogo,alt:"Logo",className:"w-20 object-contain"}):o.jsx("span",{className:"font-bold text-xs",children:e.companyName})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"border-b border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT – F – 002"}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-2",children:o.jsx("h1",{className:"text-xl font-bold uppercase tracking-wider text-center",children:"PETROLEUM TANKER CHECKLIST"})})]}),o.jsxs("div",{className:"text-xs divide-y divide-black",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Initial Issue Date"}),o.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision Date:"}),o.jsx("span",{className:"p-1 text-center",children:"15/03/2022"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Revision No."}),o.jsx("span",{className:"p-1 text-center",children:"05"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black",children:"Next Review Date:"}),o.jsx("span",{className:"p-1 text-center",children:"15/04/2025"})]})]})]}),o.jsx("div",{className:"bg-gray-50 p-4 text-xs font-mono border-b border-black",children:o.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"TRUCK #:"})," ",o.jsx("span",{className:"font-bold",children:t.truckNo})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"TRAILER #:"})," ",o.jsx("span",{className:"font-bold",children:t.trailerNo})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"JOB CARD #:"})," ",o.jsx("span",{className:"font-bold",children:t.jobCard})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"DATE/TIME:"})," ",o.jsx("span",{className:"font-bold",children:new Date(t.timestamp).toLocaleString()})]})]})}),o.jsxs("div",{className:"p-2 text-[10px] text-center font-bold border-black bg-gray-100",children:["C = Compliant, NC = Non-Compliant, NA = Not Applicable, NI = Not Inspected (Tick Accordingly)",o.jsx("br",{}),"Critical = Do Not Release, Non-Critical = Waiver Applicable"]})]}),o.jsxs("div",{className:"border border-black text-xs mb-8",children:[o.jsxs("div",{className:"grid grid-cols-[30px_1fr_30px_30px_30px_30px_1fr] bg-gray-300 border-b border-black font-bold text-center items-center py-2",children:[o.jsx("span",{children:"No."}),o.jsx("span",{className:"text-left pl-2",children:"ITEM DESCRIPTION"}),o.jsx("span",{children:"C"}),o.jsx("span",{children:"NC"}),o.jsx("span",{children:"NI"}),o.jsx("span",{children:"NA"}),o.jsx("span",{children:"COMMENTS"})]}),bt.map((n,s)=>{const i=t[n.id],a=i===K.GOOD,c=i===K.BAD,d=i===K.NIL,p=i===K.ATTENTION,u=n.label.split(". "),f=u[0],m=u.slice(1).join(". ");let h=null;return n.id==="petro2_1"&&(h="PRIME MOVER"),n.id==="petro2_16"&&(h="TRAILER/TANKS"),n.id==="petro2_33"&&(h="DRIVER"),n.id==="petro2_38"&&(h="SAFETY & WARNING SIGNS"),n.id==="petro2_45"&&(h="LICENCE & MANDATORY DOCUMENTS"),o.jsxs(Xe.Fragment,{children:[h&&o.jsx("div",{className:"grid grid-cols-[1fr] bg-gray-200 border-b border-black font-bold px-2 py-1 text-center border-t-2 border-t-black",children:h}),o.jsxs("div",{className:`grid grid-cols-[30px_1fr_30px_30px_30px_30px_1fr] border-b border-gray-400 min-h-[30px] items-stretch ${s%2===0?"bg-white":"bg-gray-50"}`,children:[o.jsx("span",{className:"text-center font-medium py-1 border-r border-gray-300 flex items-center justify-center",children:f}),o.jsx("span",{className:"pl-2 border-r border-gray-300 flex items-center py-1",children:m}),o.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:a?"✔":""}),o.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:c?"✔":""}),o.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:d?"✔":""}),o.jsx("span",{className:"border-r border-gray-300 flex items-center justify-center font-bold text-black",children:p?"✔":""}),o.jsx("span",{className:"flex items-center pl-2 italic text-gray-500 py-1",children:c?"NON-COMPLIANT":p?"N/A":""})]})]},n.id)})]}),o.jsxs("div",{className:"mt-6 border border-black p-2 min-h-[60px]",children:[o.jsx("span",{className:"font-bold underline",children:"Remarks:"})," ",t.remarks]}),o.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8 text-xs",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Inspected By:"})," ",o.jsx("span",{className:"font-bold",children:t.inspectedBy})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[o.jsx("span",{children:"Inspector Sign:"}),t.inspectorSignature&&o.jsx("img",{src:t.inspectorSignature,className:"h-8",alt:"Sig"})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Date:"})," ",o.jsx("span",{children:new Date(t.timestamp).toLocaleDateString()})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Driver Name:"})," ",o.jsx("span",{className:"font-bold",children:t.driverName})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1 items-end",children:[o.jsx("span",{children:"Driver Sign:"}),t.driverSignature&&o.jsx("img",{src:t.driverSignature,className:"h-8",alt:"Sig"})]}),o.jsxs("div",{className:"flex justify-between border-b border-gray-400 pb-1",children:[o.jsx("span",{children:"Date:"})," ",o.jsx("span",{children:new Date(t.timestamp).toLocaleDateString()})]})]})]})]}),zf=({data:t,settings:e})=>o.jsxs("div",{className:"max-w-[210mm] mx-auto text-sm leading-tight text-gray-900 font-sans p-8 bg-white min-h-[297mm]",children:[o.jsx("div",{className:"border-2 border-black mb-4",children:o.jsxs("div",{className:"grid grid-cols-[120px_1fr_150px] divide-x-2 divide-black border-b-2 border-black",children:[o.jsx("div",{className:"p-2 flex items-center justify-center",children:e.companyLogo?o.jsx("img",{src:e.companyLogo,alt:"Logo",className:"w-24 object-contain"}):o.jsx("span",{className:"font-bold text-xs",children:e.companyName})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("div",{className:"border-b-2 border-black px-2 py-1 text-xs font-medium",children:"Doc No: MNT – F – 013"}),o.jsx("div",{className:"flex-1 flex items-center justify-center p-2 bg-gray-50",children:o.jsx("h1",{className:"text-xl font-black uppercase tracking-wider text-center",children:"ACID TANKER CHECKLIST"})})]}),o.jsxs("div",{className:"text-xs divide-y divide-black",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Initial Issue Date"}),o.jsx("span",{className:"p-1 text-center",children:"03/02/2017"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Revision Date:"}),o.jsx("span",{className:"p-1 text-center",children:"15/03/2022"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Revision No."}),o.jsx("span",{className:"p-1 text-center",children:"05"})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_80px]",children:[o.jsx("span",{className:"p-1 pl-2 border-r border-black font-semibold",children:"Next Revision:"}),o.jsx("span",{className:"p-1 text-center",children:"15/03/2023"})]})]})]})}),o.jsxs("div",{className:"mb-4 text-xs font-mono",children:[o.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-2 mb-2",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{children:"Horse #:"})," ",o.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:t.truckNo})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{children:"Trailer #:"})," ",o.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:t.trailerNo})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{children:"Job Card #:"})," ",o.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[100px]",children:t.jobCard})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-2",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{children:"Location:"})," ",o.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[150px]",children:t.location})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{children:"Inspection Date/Time:"})," ",o.jsx("span",{className:"font-bold border-b border-gray-400 min-w-[150px]",children:new Date(t.timestamp).toLocaleString()})]})]})]}),o.jsxs("div",{className:"border-2 border-black text-xs",children:[o.jsxs("div",{className:"grid grid-cols-[40px_1fr_120px] bg-white border-b-2 border-black font-bold items-center",children:[o.jsx("span",{className:"text-center py-2 border-r border-black",children:"S/N"}),o.jsx("span",{className:"text-left pl-2 py-2 border-r border-black",children:"ITEM"}),o.jsx("span",{className:"pl-2 py-2",children:"COMMENT"})]}),["PPE","VEHICLE","SPILL_KIT","DOCUMENTATION"].map(n=>{let s="",i=[];return n==="PPE"?(s="A. Personal Protective Equipment (PPE)",i=Ae.filter(a=>a.category.includes("Personal"))):n==="VEHICLE"?(s="B. Vehicle (Horse & Trailer)",i=Ae.filter(a=>a.category.includes("Vehicle"))):n==="SPILL_KIT"?(s="C. Spill Kit",i=Ae.filter(a=>a.category.includes("Spill"))):n==="DOCUMENTATION"&&(s="D. Documentation",i=Ae.filter(a=>a.category.includes("Documentation"))),o.jsxs(Xe.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-[1fr] border-b border-black bg-gray-100 font-bold px-2 py-1",children:s}),i.map((a,c)=>{const d=t[a.id],p=a.label.split(". "),u=p[0],f=p.slice(1).join(". ");let m="";return d===K.GOOD?m="text-green-700 font-bold":d===K.BAD?m="text-red-700 font-bold bg-red-50":d===K.ATTENTION&&(m="text-amber-700 font-bold bg-amber-50"),o.jsxs("div",{className:"grid grid-cols-[40px_1fr_120px] border-b border-black items-stretch",children:[o.jsx("span",{className:"text-center py-1 border-r border-black flex items-center justify-center font-semibold",children:u}),o.jsx("span",{className:"pl-2 py-1 border-r border-black flex items-center",children:f}),o.jsx("span",{className:`pl-2 py-1 flex items-center ${m}`,children:d||"-"})]},a.id)})]},n)})]}),o.jsxs("div",{className:"mt-4 text-xs space-y-4",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"font-semibold",children:"Remarks:"}),o.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:t.remarks})]}),o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsx("span",{className:"font-semibold w-24",children:"Inspector:"}),o.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:t.inspectedBy})]}),o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsx("span",{className:"font-semibold w-24",children:"Inspector Sig:"}),o.jsx("div",{className:"border-b border-black flex-1 border-dashed h-12",children:t.inspectorSignature&&o.jsx("img",{src:t.inspectorSignature,className:"h-full object-contain"})})]}),o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsx("span",{className:"font-semibold w-24",children:"Driver:"}),o.jsx("span",{className:"border-b border-black flex-1 border-dashed",children:t.driverName})]}),o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsx("span",{className:"font-semibold w-24",children:"Driver Sig:"}),o.jsx("div",{className:"border-b border-black flex-1 border-dashed h-12",children:t.driverSignature&&o.jsx("img",{src:t.driverSignature,className:"h-full object-contain"})})]})]}),o.jsxs("div",{className:"mt-6 text-xs",children:[o.jsx("p",{className:"font-bold mb-2",children:"Pictures of Damage/Broken/Disfigured etc.:"}),o.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50 mb-4",children:t.photoDamage?o.jsx("img",{src:t.photoDamage,className:"h-full object-contain"}):o.jsx("span",{className:"text-gray-400",children:"No damage photo"})}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-bold mb-1",children:"Front Picture:"}),o.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:t.photoFront?o.jsx("img",{src:t.photoFront,className:"h-full object-contain"}):o.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold mb-1",children:"LS Picture:"}),o.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:t.photoLS?o.jsx("img",{src:t.photoLS,className:"h-full object-contain"}):o.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold mb-1",children:"BS Picture:"}),o.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:t.photoBack?o.jsx("img",{src:t.photoBack,className:"h-full object-contain"}):o.jsx("span",{className:"text-gray-400",children:"No photo"})})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold mb-1",children:"RS Picture:"}),o.jsx("div",{className:"h-32 border border-black flex items-center justify-center bg-gray-50",children:t.photoRS?o.jsx("img",{src:t.photoRS,className:"h-full object-contain"}):o.jsx("span",{className:"text-gray-400",children:"No photo"})})]})]})]})]}),Kf=()=>{const[t,e]=useState(!1),[n,s]=useState(!1),i=async()=>{try{console.log("🔍 Checking for updates..."),e(!0)}catch(c){console.error("Update check failed:",c)}},a=async()=>{try{s(!0),console.log("📦 Syncing update..."),await to(),console.log("✅ Update synced"),console.log("🔄 Reloading app..."),await Ni()}catch(c){console.error("Update application failed:",c),s(!1)}};return useEffect(()=>{i();const c=setInterval(i,5*60*1e3);return()=>clearInterval(c)},[]),t?o.jsx("div",{className:"fixed top-0 left-0 right-0 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-3 z-50 shadow-lg animate-slideDown",children:o.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o.jsxs("div",{children:[o.jsx("span",{className:"font-bold",children:"Update available!"}),o.jsx("span",{className:"text-sm ml-2 opacity-90",children:"• New features & improvements"})]})]}),o.jsx("button",{onClick:a,disabled:n,className:"bg-white text-blue-600 px-4 py-1.5 rounded-lg font-bold hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md",children:n?o.jsxs("span",{className:"flex items-center",children:[o.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Now"})]})}):null},Yf=()=>{const{currentUser:t,setCurrentUser:e,handleLogin:n,handleLogout:s,sessionExpired:i,setSessionExpired:a}=Di(),{settings:c,setSettings:d,appScriptUrl:p,setAppScriptUrl:u,isSavingSettings:f,handleSaveSettings:m,fetchSystemSettings:h}=Ui(),{subscription:g,history:x,refreshSubscription:y}=$i(p,t),[v,b]=useState("overview"),[I,N]=useState("dashboard"),[A,_]=useState(!1),[w,C]=useState(!1),[k,E]=useState(null),[S,R]=useState(!1),[U,M]=useState(!1),[G,z]=useState(!1),[F,V]=useState(null),[W,B]=useState(null),[se,Q]=useState(null),[fe,ve]=useState(!1),[ae,Re]=useState(null),[Je,ni]=useState(!1),{historyList:we,isLoadingHistory:Se,validationLists:We,stats:Qe,fetchHistory:Ce}=qi(p,v,t);useEffect(()=>{(async()=>{try{console.log("🚀 Initializing Live Updates..."),await to()}catch($){console.error("❌ Live Updates initialization error:",$)}})()},[]),useEffect(()=>{t&&!t.needsSetup&&(b("overview"),N("dashboard"))},[t?.username,t?.needsSetup]);const Me=useMemo(()=>{const j=t?.role==="SuperAdmin",$=g?g.status==="Expired"||g.daysRemaining<=0:!1,oe=c.maintenanceMode===!0;return j?{isLocked:!1,reason:null}:oe?{isLocked:!0,reason:"maintenance"}:$?{isLocked:!0,reason:"license"}:{isLocked:!1,reason:null}},[g,c.maintenanceMode,t?.role]),ee=Me.isLocked;useEffect(()=>{window.isSubscriptionLocked=ee},[ee]);const Y=(j,$)=>{E({message:j,type:$}),setTimeout(()=>E(null),4e3)};useEffect(()=>{i==="idle"?Y("Session expired due to inactivity.","warning"):i==="max_duration"&&Y("Session limit reached. Log in again.","info"),i&&a(null)},[i]);const{submissionStatus:dn,setSubmissionStatus:Ee,addToQueue:un}=Oi(p,Y,()=>Ce(!0)),Ze=async j=>{if(j.startsWith("support:info:")){const $=j.replace("support:info:","");Q({subject:`Inquiry: ${$}`,description:`Automated Request: User is interested in learning more about integrating the "${$}" module into the current fleet workflow.`}),b("support"),N("dashboard"),C(!1);return}if(j.startsWith("request:start_inspection")){if(ee){Y("System is in View-Only mode.","error");return}const $=j.split("|"),oe=$[1]?.toLowerCase(),Le=$[2],je=$[3],Mt=$[4],Pt=$[5];let me="general";oe==="petroleum"?me="petroleum":oe==="petroleum_v2"?me="petroleum_v2":oe==="acid"&&(me="acid"),b(me),Rt(me,{truckNo:Le,trailerNo:je,remarks:`Requested by ${Mt}: ${Pt}`,requestId:$[0].split("-")[1]});return}j!=="support"&&Q(null),b(j),N("dashboard")},et=j=>{if(ee){Y("System is currently in view-only mode.","error");return}const $=`sc_draft_${j}`;localStorage.getItem($)?(Re(j),ni(!0),ve(!0)):Rt()},{notifications:pn,handleMarkNotificationRead:si,handleDismissNotification:oi,handleClearAllNotifications:ii,handleGlobalAcknowledge:ri}=Hi(p,t,Y),[ai,fn]=useState(!1),[Pe,li]=useState(null),[ci,mn]=useState(gn),kt=t?.role==="Admin"||t?.role==="SuperAdmin",di=t?.role==="SuperAdmin",Rt=(j,$)=>{if(ee){Y("Access Restricted: View-Only mode active.","error");return}V(null),B(null),mn({...gn,timestamp:new Date().toISOString(),inspectedBy:t?.name||"",...$}),N("form")},ui=()=>{if(!ae)return;const j=`sc_draft_${ae}`,$=localStorage.getItem(j);$&&(mn(JSON.parse($)),b(ae),N("form")),ve(!1)},pi=()=>{ae&&(localStorage.removeItem(`sc_draft_${ae}`),b(ae),Rt(),ve(!1))},fi=j=>{localStorage.setItem(`sc_draft_${v}`,JSON.stringify(j)),N("dashboard")},mi=()=>N("dashboard"),hi=async j=>{if(ee){Y("System is in View-Only mode. Submission blocked.","error");return}if(!p){Y("Application URL not configured","error");return}Ee("submitting"),V(j),B(null);let $="General",oe=io,Le="General Vehicle Inspection",je=Be;v==="petroleum"?($="Petroleum",oe=ro,Le="Petroleum Tanker Inspection",je=yt):v==="petroleum_v2"?($="Petroleum_V2",oe=ao,Le="Petroleum Tanker Inspection V2",je=bt):v==="acid"&&($="Acid",oe=lo,Le="Acid Tanker Inspection",je=Ae);const Mt=oe.map(le=>j[le]!==void 0?j[le]:""),Pt={title:Le,timestamp:j.timestamp,truckNo:j.truckNo,trailerNo:j.trailerNo,jobCard:j.jobCard,location:j.location,odometer:j.odometer,inspectedBy:j.inspectedBy,driverName:j.driverName,remarks:j.remarks,rate:j.rate,signatures:{inspector:j.inspectorSignature,driver:j.driverSignature},photos:{front:j.photoFront,ls:j.photoLS,rs:j.photoRS,back:j.photoBack,damage:j.photoDamage},items:je.map(le=>({label:le.label,category:le.category,status:j[le.id]||"N/A"})),companyName:c.companyName,companyLogo:c.companyLogo},me={action:"create",sheet:$,headers:oe,row:Mt,requestId:j.requestId||null,reportData:Pt};if(!navigator.onLine){un(me),localStorage.removeItem(`sc_draft_${v}`),Ee("offline_saved"),setTimeout(()=>{Ee("idle"),N("dashboard")},3500);return}try{await fetch(p,{method:"POST",body:JSON.stringify(me),mode:"no-cors"}),Ee("success"),localStorage.removeItem(`sc_draft_${v}`);try{const le=await of(j);B(le)}catch{B("AI analysis currently unavailable.")}Ce(!0)}catch(le){console.error("Submission error",le),un(me),localStorage.removeItem(`sc_draft_${v}`),Ee("offline_saved"),setTimeout(()=>{Ee("idle"),N("dashboard")},3500)}},gi=async j=>{if(ee){Y("Requests are disabled in View-Only mode.","error");return}if(p)try{await fetch(p,{method:"POST",body:JSON.stringify({action:"request_inspection",requester:t?.name,role:t?.role,...j}),mode:"no-cors"}),Y("Inspection request submitted successfully","success")}catch{Y("Failed to submit request","error")}},Te=j=>{li(j),fn(!0)},xi=j=>{const $={...j,needsSetup:!1};e($),localStorage.setItem("safetyCheck_user",JSON.stringify($)),b("overview"),N("dashboard"),Y("Profile verified successfully.","success"),M(!0)},vi=async()=>{z(!0);try{await h(p,!0),Y("Status updated.","info")}finally{z(!1)}},yi=v==="overview";return t?t&&t.needsSetup?o.jsx(ff,{user:t,appScriptUrl:p,onComplete:xi,onLogout:s}):o.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans text-slate-800 relative",children:[o.jsx(Kf,{}),o.jsx(af,{status:dn,onClose:()=>{Ee("idle"),N("dashboard")},onViewReport:()=>F&&Te(F),aiAnalysis:W}),k&&o.jsx(Ys,{message:k.message,type:k.type,onClose:()=>E(null)}),U&&o.jsx(mf,{onComplete:()=>M(!1)}),A&&o.jsx(lf,{user:t,settings:c,appScriptUrl:p,onClose:()=>_(!1),showToast:Y,onUpdateSuccess:j=>e(j),onLogout:()=>{_(!1),s()}}),w&&o.jsx(xf,{isOpen:w,onClose:()=>C(!1),onAction:Ze}),o.jsx(pf,{isOpen:S,onClose:()=>R(!1),onSubmit:gi,validationLists:We,currentUserRole:t.role}),o.jsx(df,{isOpen:fe,onClose:()=>ve(!1),onStartNew:pi,onResume:ui,hasDraft:Je,moduleName:ae||""}),o.jsxs("div",{className:"relative z-10 min-h-screen flex flex-col",children:[o.jsxs("div",{className:"no-print",children:[c.maintenanceMode&&o.jsxs("div",{className:"bg-amber-600 px-4 py-2.5 flex items-center justify-center gap-4 text-white shadow relative z-[101]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-amber-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),o.jsx("p",{className:"text-xs font-black",children:c.maintenanceMessage||"SYSTEM MAINTENANCE IN PROGRESS"})]}),o.jsx("button",{onClick:vi,disabled:G,className:"px-3 py-1 bg-white/10 hover:bg-white/20 border border-white/30 rounded text-[10px] font-black transition-all uppercase tracking-widest",children:G?"SYNCING...":"CHECK STATUS"})]}),o.jsx(uf,{subscription:g,user:t,onManage:()=>b("maintenance")})]}),o.jsxs("header",{className:"bg-white border-b border-slate-200 sticky top-0 z-40 px-4 py-2 flex items-center justify-between h-14 no-print",children:[o.jsx("div",{className:"flex items-center gap-2",children:!yi&&o.jsxs("button",{onClick:()=>{b("overview"),N("dashboard")},className:"p-2 text-slate-600 hover:bg-slate-50 rounded-lg transition-all flex items-center group",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),o.jsx("span",{className:"text-[10px] font-black ml-1 hidden sm:inline uppercase tracking-widest",children:"Dashboard"})]})}),o.jsxs("button",{onClick:()=>{b("overview"),N("dashboard")},className:"flex flex-col items-center hover:opacity-80 transition-opacity absolute left-1/2 -translate-x-1/2",children:[o.jsx("h1",{className:"text-sm sm:text-base font-black text-slate-900 tracking-tighter leading-none uppercase",children:c.companyName||"SAFETYCHECK PRO"}),o.jsx("span",{className:"text-[7px] font-black text-indigo-600 tracking-[0.4em] mt-1 hidden sm:block",children:"CORE SYSTEM v3.2"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(cf,{id:"notification-bell",notifications:pn,onMarkAsRead:j=>si(j,Ze),onDismiss:oi,onClearAll:ii,onAcknowledge:ri,canAcknowledge:kt}),o.jsx("button",{id:"profile-trigger",onClick:()=>_(!0),className:"p-2 text-slate-400 hover:text-slate-600 transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})]}),ee&&o.jsxs("div",{className:"bg-amber-50 border-b border-amber-200 px-4 py-1.5 flex items-center justify-center gap-2 no-print",children:[o.jsx("svg",{className:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),o.jsx("span",{className:"text-[9px] font-black text-amber-800 uppercase tracking-[0.2em]",children:Me.reason==="maintenance"?"LOCKED: CORE MAINTENANCE":"RESTRICTED: VIEW-ONLY MODE"})]}),o.jsx("main",{className:"flex-1 p-4 md:p-6 w-full max-w-7xl mx-auto no-print",children:I==="form"?o.jsx(Lf,{initialData:ci,activeModule:v,validationLists:We,settings:c,onSaveDraft:fi,onExit:mi,onSubmit:hi,submissionStatus:dn,onViewReport:Te}):o.jsxs("div",{className:"animate-fadeIn",children:[v==="overview"&&o.jsx(Pf,{appScriptUrl:p,onNavigate:Ze,userRole:t.role,historyList:we,isLoading:Se,onViewReport:Te,isMaintenanceActive:c.maintenanceMode,pendingAlertsCount:pn.filter(j=>!j.read&&j.type==="critical").length,isLocked:ee}),v==="analytics"&&o.jsx(Gf,{historyList:we,isLoading:Se}),v==="fleet_wall"&&o.jsx(Hf,{historyList:we,isLoading:Se,onClose:()=>Ze("overview")}),v==="library"&&o.jsx(qf,{}),v==="settings"&&kt&&o.jsx(yf,{settings:c,setSettings:d,appScriptUrl:p,setAppScriptUrl:u,handleSaveSettings:m,isSavingSettings:f,showToast:Y,user:t}),v==="maintenance"&&di&&o.jsx(Ff,{user:t,appScriptUrl:p,settings:c,onSettingsUpdate:j=>d($=>({...$,...j})),showToast:Y,onRefreshSubscription:y,subscription:g,history:x}),v==="general"&&o.jsx(Nf,{userRole:t.role,stats:Qe,startNewInspection:()=>et("general"),fetchHistory:Ce,isLoadingHistory:Se,historyList:we,onViewReport:Te,onPrint:()=>{},isLocked:ee,lockReason:Me.reason,maintenanceMessage:c.maintenanceMessage}),v==="petroleum"&&o.jsx(wf,{userRole:t.role,stats:Qe,startNewInspection:()=>et("petroleum"),fetchHistory:Ce,isLoadingHistory:Se,historyList:we,onViewReport:Te,onPrint:()=>{},isLocked:ee,lockReason:Me.reason,maintenanceMessage:c.maintenanceMessage}),v==="petroleum_v2"&&o.jsx(Sf,{userRole:t.role,stats:Qe,startNewInspection:()=>et("petroleum_v2"),fetchHistory:Ce,isLoadingHistory:Se,historyList:we,onViewReport:Te,onPrint:()=>{},isLocked:ee,lockReason:Me.reason,maintenanceMessage:c.maintenanceMessage}),v==="acid"&&o.jsx(Cf,{userRole:t.role,stats:Qe,startNewInspection:()=>et("acid"),fetchHistory:Ce,isLoadingHistory:Se,historyList:we,onViewReport:Te,onPrint:()=>{},isLocked:ee,lockReason:Me.reason,maintenanceMessage:c.maintenanceMessage}),v==="users"&&kt&&o.jsx(Ef,{currentUser:t,appScriptUrl:p,showToast:Y,validationLists:We,settings:c}),v==="support"&&o.jsx(Uf,{appScriptUrl:p,currentUser:t,showToast:Y,settings:c,validationLists:We,prefillData:se,onPrefillConsumed:()=>Q(null)}),v==="track_requests"&&o.jsx(Vf,{appScriptUrl:p,currentUser:t,showToast:Y,onRequestNew:()=>R(!0)}),v==="registry"&&o.jsx(Of,{appScriptUrl:p,validationLists:We,onRefresh:()=>Ce(!0),showToast:Y,isLocked:ee})]})}),!ee&&I==="dashboard"&&o.jsx("div",{className:"fixed bottom-8 left-8 z-[100] no-print",children:o.jsxs("button",{onClick:()=>C(!0),className:"w-16 h-16 bg-slate-900 text-white rounded-2xl shadow-2xl flex items-center justify-center hover:bg-black hover:scale-110 transition-all group border-t border-white/10 relative",children:[o.jsx("div",{className:"absolute inset-0 rounded-2xl border-2 border-indigo-500 animate-pulse opacity-50"}),o.jsxs("svg",{className:"w-8 h-8 group-hover:rotate-12 transition-transform",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),o.jsx("path",{d:"M16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"})]}),o.jsx("div",{className:"absolute -top-1 -right-1 bg-indigo-600 text-white text-[8px] font-black px-1.5 py-0.5 rounded shadow-sm border border-indigo-500 uppercase tracking-widest",children:"PRO"})]})}),o.jsx("footer",{className:"mt-auto py-6 border-t border-slate-100 text-center no-print",children:o.jsx("span",{className:"text-[9px] font-black text-slate-300 uppercase tracking-[0.4em]",children:"© Scbc 2026"})})]}),ai&&Pe&&o.jsx(rf,{onClose:()=>fn(!1),onPrint:()=>window.print(),title:`Report_${Pe.id||"History"}`,children:v==="petroleum"?o.jsx(Jf,{data:Pe,settings:c}):v==="petroleum_v2"?o.jsx(Wf,{data:Pe,settings:c}):v==="acid"?o.jsx(zf,{data:Pe,settings:c}):o.jsx($f,{data:Pe,settings:c})})]}):o.jsxs(o.Fragment,{children:[o.jsx(hf,{}),k&&o.jsx(Ys,{message:k.message,type:k.type,onClose:()=>E(null)}),o.jsx(vf,{onLogin:n,appScriptUrl:p,setAppScriptUrl:u,settings:c})]})},eo=document.getElementById("root");eo&&oo(eo).render(o.jsx(Yf,{}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(t=>{console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(t=>{console.log("ServiceWorker registration failed: ",t)})});
